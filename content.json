{"meta":{"title":"Geo-I Minner","subtitle":"Remote Sensing ，Geographic Information Minner","description":"遥感、地理信息挖掘、城市科学","author":"wishmo@yeah.net","url":"http://localhost:4000"},"pages":[{"title":"","date":"2018-07-31T13:48:49.179Z","updated":"2018-07-31T13:48:49.179Z","comments":true,"path":"404.html","permalink":"http://localhost:4000/404.html","excerpt":"","text":""},{"title":"categories","date":"2017-06-03T10:27:52.000Z","updated":"2018-07-31T13:48:49.184Z","comments":true,"path":"categories/index.html","permalink":"http://localhost:4000/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2017-06-03T10:33:35.000Z","updated":"2018-07-31T13:48:49.186Z","comments":true,"path":"tags/index.html","permalink":"http://localhost:4000/tags/index.html","excerpt":"","text":""},{"title":"关于我","date":"2018-06-08T00:34:02.000Z","updated":"2018-07-31T13:48:49.184Z","comments":true,"path":"about/index.html","permalink":"http://localhost:4000/about/index.html","excerpt":"","text":"关于我遥感、地理信息挖掘、城市科学A Geo-Intelligence Minner QQ：303358320Email: wishmo@yeah.net"}],"posts":[{"title":"了解MBA","slug":"mba-1","date":"2018-07-31T08:17:03.000Z","updated":"2018-07-31T13:48:49.181Z","comments":true,"path":"2018/07/31/mba-1/","link":"","permalink":"http://localhost:4000/2018/07/31/mba-1/","excerpt":"人 以人为本，因人而兴。 首重沟通向内外干系人传递恰当的信息。形式与内容统一，为沟通的目的服务。 认知新奇事物是人类赖以生存的技能，因为人类内在渴望塑造自我。所以我们的耳朵永远听得见新奇有趣的事物。","text":"人 以人为本，因人而兴。 首重沟通向内外干系人传递恰当的信息。形式与内容统一，为沟通的目的服务。 认知新奇事物是人类赖以生存的技能，因为人类内在渴望塑造自我。所以我们的耳朵永远听得见新奇有趣的事物。经过恰当组织的思想，一经传播可改变世界。沟通可锻炼讲演者、阐释道理、鼓舞人心、说服他人采取行动。 沟通传播思想，使人知、使人信、使人激、使人动、使人乐。让人感兴趣-听得懂-信得过-记得住。1页只讲1个概念或数据，只用40词，花30秒说清楚。总共只讲18分钟。 需要新奇热情、运用肢体语言、深入灵魂的练习自如表达、简明恰当的幽默和故事，用有灵魂的数据，阐释道理、鼓舞人心。 其次人资管理协调人与人的关系、调动人的积极性，先保障，然后激励人全面发展。 其次组织研究人的动机、行为、人与人的关系，建立灵活适合的组织结构和积极包容的企业文化，同时满足个人和组织需求，Win-Win。 财 上善若水，流水利万物而不腐。 首先财务合理的资本构成、正确的投资和财务决策、良好有效的运转。 其次营销有的放矢。产品多快好省、定位、渠道、宣传、促销、用户服务广深高速和智能商业模式。连线成网智能，用技术高效连接产品与用户。 其次经济数学模型、统计分析。 料生产，工艺流程成本技术，环节管理。 机PDCA，机制流程。 评价、计划、预测、检查程序，通过量算剔除错误。也要注意加分因素。 细节铸就专业，持续渐进明细改善。 环政府与国际政治、经济、历史、法律、金融、商业政策的分析与战略制定。 战略高层的战略制定及实施。研究不变的因素，引领方向。目标长远、灵活、简单，做正确的事。 模拟因势利导。具体问题具体分析。 领袖顶天立地，望远明辨勤学笃行。","categories":[{"name":"读书","slug":"读书","permalink":"http://localhost:4000/categories/读书/"}],"tags":[{"name":"管理学","slug":"管理学","permalink":"http://localhost:4000/tags/管理学/"},{"name":"读书","slug":"读书","permalink":"http://localhost:4000/tags/读书/"}]},{"title":"杂烩","slug":"杂烩","date":"2018-06-08T01:42:15.000Z","updated":"2018-07-31T13:48:49.183Z","comments":true,"path":"2018/06/08/杂烩/","link":"","permalink":"http://localhost:4000/2018/06/08/杂烩/","excerpt":"路漏斗模型，病毒传播专业源自细节，时间计算得越细，做事就越完美","text":"路漏斗模型，病毒传播专业源自细节，时间计算得越细，做事就越完美 思 感知表象，观察注意，发问、理解概念，编码，联想转换记忆 复述 复习 归纳：逢七进一，提炼总结。 演绎：建立知识体系；联系、用法、原因 单目标 资源 路径 小步试错 回顾 分享 浏览、发问、阅读、复述、复习 看、听、问、查、测、定、改方法； 整合思维 相对真理、冲突有益、力求双赢、相机行动 直觉、逆向、假说、发散、形象…… 结构思维 QC7，SWOT矩阵，三角、五力、六帽…… 二元陈述句web搜索筛选答案 相关≠因果。 专家、有钱人、众人所说的，已知的并不一定确保是问题的根本原因。 学 单目标 资源 路径 小步试错 回顾 分享 练习，预测应用 分享，成为导师 5分钟，处理零散的事情；积少成多，记忆； 破局方法：MVP小步快跑、独立小队练刻意练习 明确专注，可测量的目标； 完善的训练方法和步骤，明晰的测控标准； 关键链 正反馈环，滚雪球 二八分布，复利奇迹 步幅×步频=不可思议 长期有意刻苦的练习，小步、专注、快速反馈纠正；坚持坚持 创建改进心理表征，用以解释、组织、比较信息和计划决策，以纠正错误、达成练习目标； 最好知道谁是优秀的导师，找到优秀的导师； 优秀的导师 必须已经达到一定的水平； 有一些可以传授给别人的有益的练习方法。 自己设计练习方法 更短的练习，更好的注意力 将技能分解将技能分解成一些组成部分，以便反复地练习，并且有效地分析、确定你的不足之处，然后想出各种办法来解决它们。 跨越停滞阶段 新的方式挑战自己； 攻克特定的弱点； 保持动机 强化继续前行的理由； 弱化停下脚步的理由； 精心设置目标将漫长的旅程分解成一系列可控的目标，并且每次只关注它们中的一个。甚至可以在每次达到一个目标时，给自己小小的奖励。 用 P 聚焦目标，挖掘本质核心议题 锻炼自己见微知著的预见能力 《唐诗三百首》对应情绪，用数字编码背诵 简洁 灵活 提前筹划，应对突发 5W2H SMART D 25分钟，专心处理1个目标清晰的事情； 1天，开始形成1个习惯； 21天、30天，巩固你的习惯； 953100 每天思考9件事，处理5件，重点处理3件事。每件事写100字的小结； C 1年，只有5%的人会坚持完成年初计划。 10年，逐步实现退休计划； A 决策 有本质问题 有多个方案 有评选机制 有跟踪反馈讲 30秒，向领导和同事陈述你的观点，并使人印象深刻； 18分钟，作1个完整的Presentation，传播你的思想； 传播思想 认知新奇事物是人类赖以生存的技能，因为人类内在渴望塑造自我。所以我们的耳朵永远听得见新奇有趣的事物。经过恰当组织的思想，一经传播可改变世界。沟通可锻炼讲演者、阐释道理、鼓舞人心、说服他人采取行动。 故事和幽默故事是有灵魂的数据，可以阐释道理、鼓舞人心； 简明可信1页只讲1个概念或数据，只用40词，花30秒说清楚。总共只讲18分钟； 练习运用肢体语言，重复练习，直至深入灵魂，自如表达；","categories":[{"name":"杂念","slug":"杂念","permalink":"http://localhost:4000/categories/杂念/"}],"tags":[]},{"title":"《刻意练习》读记","slug":"《刻意练习》读记","date":"2018-06-08T01:38:40.000Z","updated":"2018-07-31T13:48:49.183Z","comments":true,"path":"2018/06/08/《刻意练习》读记/","link":"","permalink":"http://localhost:4000/2018/06/08/《刻意练习》读记/","excerpt":"概述 用PDCA将化学反应式的“不可能”过程，精心分解细化为一系列目标和步骤，用于刻意练习，暗合波浪式前进的哲学规律； QC7工具像组合拳，可帮助达成目标； 可行性 大脑有巨大的优化潜力，心理表征可通过刻意练习创建、完善、改进，帮助在生活和工作上练就杰出技能，成为杰出人物； 刻意练习有下列特征： 明确专注，可测量的目标； 完善的训练方法和步骤，明晰的测控标准； 大脑和身体一样，对于处在舒适区之外却离得并不太远的“甜蜜点”上的挑战，改变最为迅速。 长期有意刻苦的练习，小步、专注、快速反馈纠正； 创建改进心理表征，用以解释、组织、比较信息和计划决策，以纠正错误、达成练习目标；","text":"概述 用PDCA将化学反应式的“不可能”过程，精心分解细化为一系列目标和步骤，用于刻意练习，暗合波浪式前进的哲学规律； QC7工具像组合拳，可帮助达成目标； 可行性 大脑有巨大的优化潜力，心理表征可通过刻意练习创建、完善、改进，帮助在生活和工作上练就杰出技能，成为杰出人物； 刻意练习有下列特征： 明确专注，可测量的目标； 完善的训练方法和步骤，明晰的测控标准； 大脑和身体一样，对于处在舒适区之外却离得并不太远的“甜蜜点”上的挑战，改变最为迅速。 长期有意刻苦的练习，小步、专注、快速反馈纠正； 创建改进心理表征，用以解释、组织、比较信息和计划决策，以纠正错误、达成练习目标； 最好知道谁是优秀的导师，找到优秀的导师； 优秀的导师 必须已经达到一定的水平； 有一些可以传授给别人的有益的练习方法。 自己设计练习方法 更短的练习，更好的注意力 将技能分解将技能分解成一些组成部分，以便反复地练习，并且有效地分析、确定你的不足之处，然后想出各种办法来解决它们。 跨越停滞阶段 新的方式挑战自己； 攻克特定的弱点； 保持动机 强化继续前行的理由； 弱化停下脚步的理由； 精心设置目标将漫长的旅程分解成一系列可控的目标，并且每次只关注它们中的一个。甚至可以在每次达到一个目标时，给自己小小的奖励。","categories":[{"name":"读书","slug":"读书","permalink":"http://localhost:4000/categories/读书/"}],"tags":[{"name":"读书","slug":"读书","permalink":"http://localhost:4000/tags/读书/"},{"name":"技能","slug":"技能","permalink":"http://localhost:4000/tags/技能/"}]},{"title":"《麦肯锡思维》读记","slug":"麦肯锡读记","date":"2018-06-08T01:33:35.000Z","updated":"2018-07-31T13:48:49.183Z","comments":true,"path":"2018/06/08/麦肯锡读记/","link":"","permalink":"http://localhost:4000/2018/06/08/麦肯锡读记/","excerpt":"正确 效能 战略，核心议题 效率 细节，执行力 长远灵活的目标 八二 重要的少数 长远 回报 最满足 次序表，守时","text":"正确 效能 战略，核心议题 效率 细节，执行力 长远灵活的目标 八二 重要的少数 长远 回报 最满足 次序表，守时 事实为基 弥补直觉，避免主观 增强可信 指向假设 关键 问题核心、正确方向 多多搜集事实依据、逻辑树分析 头脑风暴 MECE逻辑树 找到重点、排除干扰 全方位、多角度考虑问题，多多搜集事实依据 严谨推理，用图表分析问题，征服复杂问题 议题树、假设树、是否树 先易后难，化整为零 尽快用心做更多容易的事 化整为零循序渐进 找到重点、提高水平、授权、外包、取消 专一 专注、穿透，打一个垒 不可能所有工作一个人干完 摆脱事务、摆脱人、摆脱过去 筛选删扰 按次序筛选 设置无干扰区，数字化干扰、头脑内的战争 徘徊的布里丹驴，饿死两堆草之间 雾中反思 想想目标、远景 认识自己 头脑风暴 团队决策 特定问题提出 宽松的氛围 鼓励狂热夸张的观点 观点数量最大化 集思广益建立新观点 不否决不忽略简单问题 做好后勤 用笔写下来 电梯图表总结 坚持长期图表总结 快速清晰表达、易理解 知感行 限时走访 做好提纲，3优先问题 领导安排、双人走访、倾听复述、不要紧抓不放，临别提问 与客户同工作 客户参与、客户至上 争取多方面的支持 严谨的实施 团队 集体的智慧 全局观 团队大于个人 听取别人的意见 破冰游戏 内部管理要畅通 信息简洁完整结构 向导 复用别人智慧、跟随赶超 找到最佳经验 找准导师 学习无处不在的导师 多读书、多观察、多交流，成败总结，谦虚，笃行 募新 员工培训体系 方法比知识更重要，改进方法，多角度，5W2H 居安思危，ABZ计划 热情 琐事清单 细节 清单","categories":[{"name":"读书","slug":"读书","permalink":"http://localhost:4000/categories/读书/"}],"tags":[{"name":"管理学","slug":"管理学","permalink":"http://localhost:4000/tags/管理学/"},{"name":"读书","slug":"读书","permalink":"http://localhost:4000/tags/读书/"}]},{"title":"人岗速配","slug":"manager","date":"2017-06-15T12:24:36.000Z","updated":"2018-07-31T13:48:49.180Z","comments":true,"path":"2017/06/15/manager/","link":"","permalink":"http://localhost:4000/2017/06/15/manager/","excerpt":"人岗速配： 选人 选重要岗位 快速安排岗位 解事 目标维度。这里的目标，特别指中期目标，也就是这个职位未来1到2年的最主要目标 工作维度，这里的工作，指的是开展工作的方式和面临的环境。对内管理为主，还是对外交往为主。 团队维度，比如说目前的团队是什么状况，专业基础如何，团队士气如何等等。 文化维度，公司的做事风格和价值观，会影响岗位的具体要求。广揽招揽若干个符合条件的人选。应当考虑三到五个合格的候选人。定期进行人才盘点，持续对内部优秀人才进行跟踪评估；在企业外部不断充实人才库等等。","text":"人岗速配： 选人 选重要岗位 快速安排岗位 解事 目标维度。这里的目标，特别指中期目标，也就是这个职位未来1到2年的最主要目标 工作维度，这里的工作，指的是开展工作的方式和面临的环境。对内管理为主，还是对外交往为主。 团队维度，比如说目前的团队是什么状况，专业基础如何，团队士气如何等等。 文化维度，公司的做事风格和价值观，会影响岗位的具体要求。广揽招揽若干个符合条件的人选。应当考虑三到五个合格的候选人。定期进行人才盘点，持续对内部优秀人才进行跟踪评估；在企业外部不断充实人才库等等。 慎选谨慎地选择合适的人。 关注历史，也就是候选人在以前岗位上的表现。是外部原因，还是自身素质导致的。 用人所长。不可能找一个全能型选手，应该尝试着包容候选人的弱点。 辅导辅导，也就是对新上任的管理者进行辅导，帮助他们更快适应新的岗位。比如华为就有新干部上任的“90天转身计划”，这个计划包括三方面内容。 认知，新干部要知道在新的管理岗位上要承担哪些关键角色，做出哪些关键行为，发展哪些能力。 转身教练，在90天计划里，每个新干部都会有一位教练，教练会帮他规划转身期里跟上司的五次关键谈话，还帮他找出在新岗位上的目标。 任前管理。在90天计划结束后，新干部要带着成果，参加转正答辩，只有通过答辩才能走马上任。 这些制度可以让每个新上任的管理者获得帮助，也能让CEO及时了解新干部的状态，有针对性地来辅导。","categories":[{"name":"Management","slug":"Management","permalink":"http://localhost:4000/categories/Management/"}],"tags":[{"name":"人岗","slug":"人岗","permalink":"http://localhost:4000/tags/人岗/"}]},{"title":"WebGIS","slug":"webgis","date":"2017-06-04T12:28:03.000Z","updated":"2018-07-31T13:48:49.182Z","comments":true,"path":"2017/06/04/webgis/","link":"","permalink":"http://localhost:4000/2017/06/04/webgis/","excerpt":"缘起在SuperMap学习工作中收获颇多： 产品体系和企业愿景； 团队敏捷开发和行业耕耘； 国家科技支撑项目、4R管控培训和锦江之星白金卡。 记录WebGIS研发的点滴，整理行囊，轻装前行。","text":"缘起在SuperMap学习工作中收获颇多： 产品体系和企业愿景； 团队敏捷开发和行业耕耘； 国家科技支撑项目、4R管控培训和锦江之星白金卡。 记录WebGIS研发的点滴，整理行囊，轻装前行。 SuperPy Tif影像拼接影像像素位深检查 采用开源库GDAL的gdalinfo.exe读取GeoTiff文件的信息，如类型、投影，范围等。 采用DOS脚本遍历所有GeoTiff文件，输出各个GeoTiff文件的信息到日志。 统计GeoTiff文件个数，Type=Byte的文件的个数。数目一致表明全部GeoTiff像素类型一致。123for /f %i in ('dir /b /s d:\\tifdata\\*.tif ') do @( e:\\gdal1.4.2\\bin\\gdalinfo.exe %i &gt;&gt; e:\\tifstats.log ) 影像拼接处理采用SuperMapPy脚本处理影像拼接。先安装Python2.7.3和Deskpro环境。流程如图 脚本如下：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181# coding: GB2312 #===================================================#影像成批导入SuperMap UDB格式工具.#基本流程:#1、扫描目录，或者根据经纬度按照块的高宽生成文件列表。#2、扫描存在的文件，获取最大的坐标范围。#3、扫描存在的文件，获取像素格式。#4、遍历文件列表，对于存在的文件追加到打开的数据库UDB中。#5、创建金字塔索引，以加快显示速度。（可选的过程）#=================================================== import sysimport stringimport reimport osimport time def getType(ext): if ext.lower() == 'tif': return 'fileTIF' elif ext.lower() == 'img': return 'fileIMG' #匹配正则表达式，符合条件的append到datafiles，用于追加 def walkPath(type, path): datafiles = [] reMatch = '[\\d\\D]*.tif$' if type=='img': reMath = '[\\d\\D]*.img$' for root, dirs, files in os.walk(path): for file in files: if (re.match(reMatch,file)): datafiles.append(os.path.join(root, file)) print len(datafiles) return datafiles def calcDatasetInfo(type, datafiles): L=[] left=[] top=[] right=[] bottom=[] ratiox=[] ratioy=[] #获取每个影像文件的左右地理范围，保存到数组 for file in datafiles: L= smu.GetImageGeoRef(type,file) print L l=float(L[0][0]) t=float(L[0][1]) r=float(L[0][2]) b=float(L[0][3]) w=int(L[1][0]) h=int(L[1][1]) x=(r-l)/w y=(t-b)/h left.append(l) right.append(r) top.append(t) bottom.append(b) ratiox.append(x) ratioy.append(y) #获取左右上下边界 dLeft=min(left) dRight=max(right) dTop=max(top) dBottom=min(bottom) #获取分辨率，影像最小分辨率作为数据集分辨率 dRatioX = min(ratiox) dRatioY = min(ratioy) #计算影像数据集宽度和高度 nWidth = int((dRight-dLeft)/dRatioX) nHeight = int((dTop-dBottom)/dRatioY) #重新计算，保证分辨率正确 dRight=dLeft+dRatioX*nWidth dBottom=dTop-dRatioY*nHeight L = [nWidth, nHeight, dLeft, dTop, dRight, dBottom] return L def toDB(server, user, pwd, engType, fileType, path): files=[] files=walkPath(fileType, path) print len(files) if len(files)&gt;0: L=[] L = calcDatasetInfo(fileType, files) pixType = smu.GetImagePixelFormatName(fileType, files[0]) odsAlias='test' if len(L)==6: nWidth=L[0] nHeight=L[1] dLeft=L[2] dTop=L[3] dRight=L[4] dBottom=L[5] dtName='test' isOpen=smu.OpenDataSource(server,user,pwd, engType, odsAlias) smu.DeleteDataset(odsAlias, dtName) bCreate = smu.CreateDatasetRaster(odsAlias,dtName, 'Image', 'encDCT', pixType,nWidth,nHeight, dLeft, dTop,dRight,dBottom,256) writeLog(\"log.log\",\"calcDatasetInfo 成功\") for file in files: writeLog(\"log.log\",file+\"开始处理\") smu.AppendRasterFile(odsAlias,dtName,fileType, file) writeLog(\"log.log\",file+\"处理完毕\\n\\n\") bBuild=smu.BuildPyramid(odsAlias,dtName)#创建影像金字塔 if bBuild == 1: print \"创建金字塔成功\" else: print \"创建影像金字塔失败！\" smu.CloseDataSource(odsAlias) #=====================================def writeLog(logPath, tmpstr): time_str = time.strftime(\"%Y-%m-%d %H:%M:%S \",time.localtime()) logstr = str(tmpstr) + time_str +'\\n' print(logstr) f = open(logPath, \"a\") f.write(logstr) f.close() help =u\"----------------------------------------------------------\\n\\说明:可导入udb或oracle引擎\\n\\导入到UDB用法: AppendRasterFile.py ugoPath tif c:/data\\n\\导入到Oracle用法: AppendRasterFile.py ugoPath server user pwd tif c:/data\\n\\----------------------------------------------------------\\n\" if __name__=='__main__': if len(sys.argv)&gt;2: ugo=sys.argv[1] if os.path.exists(ugo): sys.path.append(ugo) import smu else: print u'组件路径不存在.' sys.exit() else: print help sys.exit() if len(sys.argv) == 4: engType='sceUDB' fileType=sys.argv[2] fileType=getType(fileType) path=sys.argv[3] udb = path+'/test.udb' udd = path+'/test.udd' if os.path.exists(udb): os.remove(udb) if os.path.exists(udd): os.remove(udd) print 'toDB ing' toDB(udb, '', '', engType, fileType, path) smu.Exit()#清空环境，释放内存 elif len(sys.argv) == 7: engType='sceOraclePlus' server=sys.argv[2] user=sys.argv[3] pwd=sys.argv[4] fileType=sys.argv[5] fileType=getType(fileType) path=sys.argv[6] toDB(server, user, pwd, engType, fileType, path) smu.Exit()#清空环境，释放内存 手工合成WMTS调用路径动机一般OGC WMTS地图只提供了xml描述，地图应用常常要合成WMTS完整的调用URL。我们需要获知以下参数： BaseURL:例如 “http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100” SERVICE：“WMTS“，常量，服务类型，在此设置为WMTS VERSION：“1.0.0“，常量，版本号，一般1.0.0 REQUEST：“GetTile“，常量，获取地图瓦片操作 LAYER：“SR“，变量，地图图层名。从xml中提取 FORMAT：“image/png“，变量，从xml中提取。一般是image/png或image/tile等 TILEMATRIXSET：“Custom_SR“，分块矩阵名称，从xml中提取。 OFFLEVEL：“0“，分辨率分级偏移，扩展字段，用于项目中叠加天地图地图。 步骤 获取baseurl首先先拿到WMTS描述xml路径，如http://localhost:8090/iserver/services/map-china400/wmts100 获取xml文件内容在浏览器中打开xml路径，如http://localhost:8090/iserver/services/ 提取参数 拼接urlurl = ‘http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100&#39; + ‘?’ +‘&amp;SERVICE=WMTS’‘&amp;VERSION=1.0.0’‘&amp;REQUEST=GetTile’‘&amp;LAYER=SR’‘&amp;FORMAT=image/png’‘&amp;TILEMATRIXSET=Custom_SR’‘&amp;OFFLEVEL=0’ 最终即为所得url=http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&amp;SERVICE=WMTS&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;LAYER=SR&amp;FORMAT=image/png&amp;TILEMATRIXSET=Custom_SR&amp;OFFLEVEL=0 Leaflet 示例动机 加载本地png瓦片 加载GeoJson 点要素自动聚类 源码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Leaflet debug page&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"../dist/leaflet.css\" /&gt; &lt;script src=\"../dist/leaflet.js\"&gt;&lt;/script&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;link rel=\"stylesheet\" href=\"screen.css\" /&gt; &lt;link rel=\"stylesheet\" href=\"../dist/MarkerCluster.css\" /&gt; &lt;link rel=\"stylesheet\" href=\"../dist/MarkerCluster.Default.css\" /&gt; &lt;script src=\"../dist/leaflet.markercluster-src.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"geojson-sample.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=\"map\"&gt;&lt;/div&gt; &lt;span&gt;Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds&lt;/span&gt; &lt;script type=\"text/javascript\"&gt; var geoJsonData = &#123; \"type\": \"FeatureCollection\", \"features\": [ &#123; \"type\": \"Feature\", \"id\":\"1\", \"properties\": &#123; \"address\": \"2\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209316333,31.2210922667 ] &#125; &#125;, &#123; \"type\": \"Feature\", \"id\":\"2\", \"properties\": &#123; \"address\": \"151\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [114.2238417833,31.20975435 ] &#125; &#125;, &#123; \"type\": \"Feature\", \"id\":\"3\", \"properties\": &#123; \"address\": \"21\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2169955667,31.218193 ] &#125; &#125;, &#123; \"type\": \"Feature\", \"id\":\"4\", \"properties\": &#123; \"address\": \"14\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2240856667,31.2216963 ] &#125; &#125;, &#123; \"type\": \"Feature\", \"id\":\"5\", \"properties\": &#123; \"address\": \"38B\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2196982333,31.2188702167 ] &#125; &#125;, &#123; \"type\": \"Feature\", \"id\":\"6\", \"properties\": &#123; \"address\": \"38\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209942 ,31.2192782833 ] &#125; &#125; ] &#125;; &lt;!-- var mymap = L.map('map').setView([31, 113], 10); --&gt; var tiles = L.tileLayer('http://localhost/roadmap/&#123;z&#125;/&#123;x&#125;/&#123;y&#125;.png', &#123; maxZoom: 15, attribution: '&amp;copy; &lt;a href=\"http://osm.org/copyright\"&gt;OpenStreetMap&lt;/a&gt; contributors' &#125;),latlng = L.latLng(31, 113); var map = L.map('map', &#123;center: latlng, zoom: 10, layers: [tiles]&#125;); var geojson = L.geoJson(geoJsonData, &#123; style: function (feature) &#123; return &#123;color: feature.properties.color&#125;; &#125;, onEachFeature: function (feature, layer) &#123; var popupText = 'geometry type: ' + feature.geometry.type; if (feature.properties.address) &#123; popupText += '&lt;br/&gt;address: ' + feature.properties.address; &#125; layer.bindPopup(popupText); &#125; &#125;); geojson.addLayer(new L.Marker(new L.LatLng(31.745530718801952, 113.194091796875))); var eye1 = new L.Marker(new L.LatLng(30.7250783020332547, 111.8212890625)); var eye2 = new L.Marker(new L.LatLng(30.7360637370492077, 113.2275390625)); var nose = new L.Marker(new L.LatLng(31.3292264529974207, 112.5463867187)); var mouth = new L.Polygon([ new L.LatLng(30.3841426927920029, 111.7333984375), new L.LatLng(30.6037944300589726, 111.964111328125), new L.LatLng(31.6806671337507222, 112.249755859375), new L.LatLng(31.7355743631421197, 112.67822265625), new L.LatLng(31.5928123762763, 113.0078125), new L.LatLng(30.3292264529974207, 113.3154296875) ]); var markers = L.markerClusterGroup(); markers.addLayer(geojson).addLayers([eye1,eye2,nose,mouth]); map.addLayer(markers); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; 江西水利一张图调用示例源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165&lt;head&gt; &lt;meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"&gt; &lt;title&gt;江西地图服务调用测试&lt;/title&gt; &lt;!--引用需要的脚本--&gt; &lt;script src=\"./libs/SuperMap.Include.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; //声明变量map、layer、url function init() &#123; var map, layer; map = new SuperMap.Map(\"map\",&#123;controls: [ new SuperMap.Control.ScaleLine(), new SuperMap.Control.Zoom(), new SuperMap.Control.Navigation(&#123; dragPanOptions: &#123; enableKinetic: true &#125; &#125;)] &#125;); // 多个图层叠加，设置allOverlays开关为true map.allOverlays = true; //当前图层的分辨率数组信息,和matrixIds一样， // 需要用户从wmts服务获取并明确设置,resolutions数组和matrixIds数组长度相同 var scales=[2.958293554545656E8, 1.479146777272828E8, 7.39573388636414E7, 3.69786694318207E7, 1.848933471591035E7, 9244667.357955175 , 4622333.678977588 , 2311166.839488794 , 1155583.419744397 , 577791.7098721985 , 288895.85493609926 , 144447.92746804963 , 72223.96373402482 , 36111.98186701241 , 18055.990933506204 , 90279.95466753103 , 4513.997733376551 , 2256.998866688275 , 1128.499433344138 , 564.2497166720688]; // SuperMap发布的 wmtsTDT接口的地图服务，设置对应的matrixID和resolution数组 var matrixIds=[],temp,resolutions=[]; for(var i=6;i&lt;scales.length;i++)&#123; temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137); resolutions.push(temp); matrixIds[i-6]=&#123;identifier:i&#125;;//天地图的identifier是从1开始的 &#125; //河流图层 layer0 = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.46:8080/iserver/services/map-JX_LINE/wmtsTDT\", layer: \"LINE_V\", style: \"default\", matrixSet: \"Custom_LINE_V\", format: \"image/png\", resolutions:resolutions, matrixIds:matrixIds, opacity: 1, requestEncoding:\"KVP\"&#125;); // 湖泊图层 layer1 = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.46:8080/iserver/services/map-JX_LAKE/wmtsTDT\", layer: \"LAKE_V\", style: \"default\", matrixSet: \"Custom_LAKE_V\", format: \"image/png\", resolutions:resolutions, matrixIds:matrixIds, opacity: 1, requestEncoding:\"KVP\"&#125;); // 天地图分辨率resolution数组和matrixID数组 matrixSetTDT = []; resolutionsTDT = []; for(var i=6;i&lt;17;i++)&#123; temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137); resolutionsTDT.push(temp); matrixSetTDT[i-6]=&#123;identifier:i+1&#125;;//天地图的identifier是从1开始的 &#125; // 天地图行政界线底图服务 layer2 = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/ZHL140325/wmts\", layer: \"vec20140318\", style: \"vec20140318\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); // 天地图交通底图服务 layerJT = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/JTL140325/wmts\", layer: \"Road325\", style: \"Road325\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); // 天地图行政界线底图服务 layerXZ = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/ZHL140325/wmts\", layer: \"vec20140318\", style: \"vec20140318\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); // 行政注记 （影像） layerPOI7_14 = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/POI7_17/wmts\", layer: \"POI7_14\", style: \"POI7_14\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); // 天地图影像底图服务 layerIMGL7_L17s = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/IMGL7_L17/wmts\", layer: \"IMGL7_L17s\", style: \"IMGL7_L17s\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); // 天地图行政注记（矢量） layerPoi325 = new SuperMap.Layer.WMTS(&#123; url: \"http://10.36.5.70:9010/ZHLZJ140325/wmts\", layer: \"Poi325\", style: \"Poi325\", matrixSet: \"Matrix_0\", format: \"image/tile\", resolutions:resolutionsTDT, matrixIds:matrixSetTDT, opacity: 1, requestEncoding:\"KVP\"&#125;); //矢量底图 map.addLayers([layerXZ ,layer0 ,layer1 ,layer2 ,layerJT ,layerPoi325 ]); //影像底图 &lt;!-- map.addLayers([layerIMGL7_L17s,layer0 ,layer1 ,layer2 ,layerJT, layerPOI7_14 ]); --&gt; map.setCenter(new SuperMap.LonLat(114, 26), 0); &#125; &lt;/script&gt; &lt;/head&gt;&lt;body onload=\"init()\"&gt; &lt;!--地图显示的div--&gt; &lt;div id=\"map\" width=\"100%\" height=\"100%\" &gt; &lt;/div&gt; &lt;/body&gt;","categories":[{"name":"Develop","slug":"Develop","permalink":"http://localhost:4000/categories/Develop/"}],"tags":[{"name":"WebGIS","slug":"WebGIS","permalink":"http://localhost:4000/tags/WebGIS/"}]},{"title":"IDL","slug":"IDL","date":"2017-06-04T12:24:36.000Z","updated":"2018-07-31T13:48:49.180Z","comments":true,"path":"2017/06/04/IDL/","link":"","permalink":"http://localhost:4000/2017/06/04/IDL/","excerpt":"动机求学期间，用过IDL一阵子。将零散的编录到博客，铭记时光。 IDL概述 首先看看IDL能干什么，《Solving Real Problems with Computer Graphics》ppt是英文的，很精彩。 其次是IDL基础语法，辜智慧的IDL入门ppt，全面简练。有其他编程语言基础试写几段code就很容易上手。","text":"动机求学期间，用过IDL一阵子。将零散的编录到博客，铭记时光。 IDL概述 首先看看IDL能干什么，《Solving Real Problems with Computer Graphics》ppt是英文的，很精彩。 其次是IDL基础语法，辜智慧的IDL入门ppt，全面简练。有其他编程语言基础试写几段code就很容易上手。 由于其强大的功能和独特的特点，IDL语言可以应用于任何领域的三维数据可视化、数值计算、三维图形建模、科学数据读取等功能中。概括说来，在地球科学（包括气象、水文、海洋、土壤、地质、地下水等）、医学影像、图像处理、GIS系统、软件开发，大学教学，实验室，测试技术，天文，航空航天、信号处理，防御工程，数学统计及分析，环境工程等很多领域，IDL语言都可以得到广泛而又深远的应用。目前应用IDL语言，已经开发出了ENVI、IMAGIS、RiverTools、医学等成熟产品。具体的应用实例也非常多，如在2000年澳大利亚悉尼奥运会综合预报系统、美国国家环境卫星数据和信息服务中心的厄尔尼诺现象分析等工作中得到了成功的应用。作为面向矩阵、语法简单的第四代可视化语言，IDL致力于科学数据的可视化和分析，是跨平台应用开发的最佳选择。它集可视化、交互分析、大型商业开发为一体，为用户提供完善、灵活、有效地开发环境。问问自己，准备要用IDL来干什么。要有的放矢才行。 找回桌面Envi快捷方式 envi快捷方式 E:\\ITT\\IDL64\\bin\\bin.x86\\idlrt.exe -nodemowarn -novm “E:\\ITT\\IDL64\\lib\\hook\\envi.sav” idl快捷方式 E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe idl+envi快捷方式 E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe -minimized -noconfirmexit -nosplash @“E:\\ITT\\IDL64\\products\\envi44\\bin\\envi.run” myEclipse配置IDL开发环境新安装了Envi5.0 IDL8.2，总结一下，JSP调用IDL的配置，jar包配置，环境变量配置，dll配置，tomcat路径配置，tomcat运行选项配置，jdk lib和bin配置。结果是要能自如地在jsp里面建立pro对应的java对象。 已经配置成功。汇总记录一下： myEclipse Java Web Project添加javaidlb.jar包，这个毫无疑问，不添加编译工程都失败； java 的jdk jre bin 和lib目录下不要有任何idl的dll或者jar包； 环境变量path添加idl\\bin和idl\\bin\\bin.x86，哪一个起作用我暂时没辨别； myEclipse 中Tomcat选项添加了idl bin bin.x86 lib目录，是否起作用暂时没辨别； myEclipse 中Installed Jre添加选项，就是IDL调试开关； 重新安装一次Envi5（如实记录，不知是否起作用）； TM3、4波段GeoTiff数据计算NDVINDVI是遥感图像处理最常见的 1234567891011121314PRO TIFF_NDVI,F1,F2,FOUT F1 = DIALOG_PICKFILE(TITLE = 'B4 TIFF',FILTER='*.TIF',/READ) F2 = DIALOG_PICKFILE(TITLE = 'B3 TIFF',FILTER='*.TIF',/READ) FOUT =DIALOG_PICKFILE(TITLE = 'RESULT PATH',FILTER='*.TIF',/WRITE) IF(FILE_TEST(F1) GT 0 AND FILE_TEST(F2) GT 0) THEN BEGIN B1 = READ_TIFF(F1,GEOTIFF=GE1) B2 = READ_TIFF(F2,GEOTIFF=GE2) HELP,B1,B2 C = 0.001 WRITE_TIFF,FOUT,-1.0&gt;( (FLOAT(B1)-FLOAT(B2))/(FLOAT(B1)+FLOAT(B2) + C) )&lt;1.0,/FLOAT,GEOTIFF=GE2 PRINT,'OK ENDIF END IDL PCA主成分分析在多元统计分析中，主成分分析（Principal components analysis，PCA）是一种分析、简化数据集的技术。主成分分析经常用于减少数据集的维数，同时保持数据集中的对方差贡献最大的特征。【wiki】 在遥感影像解译与分类中，PCA是经常用到的降维滤噪处理技术。现在实现这个处理流程，便于熟悉和掌握IDL矩阵乘除运算操作。 1234567891011121314151617181920212223242526272829Pro Pca,Data,Eigenvalues = Egvalues,Eigenvectors = Egvec,Percent = Percent,_Extra=Extra Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type= Type If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin Data = Transpose(Reform(Data,Ns*Nl,Nb)) Corr = Correlate(Data,/Covariance) Egvalues = Eigenql( Corr, Eigenvectors=Egvec,/Double ,/Absolute) Absegvalue = Abs(Egvalues) Percent = Absegvalue / Total(Absegvalue); ; Egvec Format ;Egvec = [ Egvec1 ; Egvec2 ; Egvec3 ; ... Data = Temporary(Reform(Transpose(Egvec) ### Transpose(Data),Ns,Nl,Nb)) EndifEnd;---------------------------------------Pro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type Sz = Size(Data) Type = Sz[0] Ge 1 ? Sz[-2] : 0 Ns = Sz[0] Ge 1 ? Sz[1] : 1 Nl = Sz[0] Ge 2 ? Sz[2] : 1 Nb = Sz[0] Ge 3 ? Sz[3] : 1 End IDL EOF分析关于EOF详细介绍请wiki http://en.wikipedia.org/wiki/Empirical_orthogonal_functions或者Google之。 与PCA一样，EOF也是遥感多维变量的一种线性变换，同样可以达到降维的目的。EOF多用于气象要素场等包含了时间、空间信息的数据，例如可以根据多年气象站的降雨监测资料，提取出空间“主成分”，即若干个主要的大面积降雨或者干旱的地区；时间“主成分”，即降雨年际周期或者年内周期。 EOF是一种极有效的数据处理手段，可以直接得到有物理意义的结果。 12345678910111213141516171819202122232425262728Pro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type Sz = Size(Data) Type = Sz[0] Ge 1 ? Sz[-2] : 0 Ns = Sz[0] Ge 1 ? Sz[1] : 1 Nl = Sz[0] Ge 2 ? Sz[2] : 1 Nb = Sz[0] Ge 3 ? Sz[3] : 1 EndPro Eofs,Data,Eof,Pcs ;Svdc,Data(*,*),W,U,V,/Column ;Eofs=Reform(U(*,*),Nlons,Nlats,Cutoff) ;Pcs=V ;Svls=W Eof = -1 Pcs = -1 Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin Svdc,Data,W,U,V,/Column Data = Transpose(Reform(Data,Ns*Nl,Nb)) Eof=Reform(U,Ns,Nl,Nb) Pcs = V EndifEnd IDL 求坡度坡向12345678910111213141516171819202122232425262728Pro Aspect_Slope,Dem,Aspect = Aspect,Slope=Slope,Pixelsize = Pixelsize ;Ref To Doi:10.1016/J.Cageo.2003.07.005 Aspect = -1 Slope = -1 Pixelsize = [30.,30.] Get_Sz,Dem,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type If Isa(Dem,/Number) And Nb Eq 1 And Size(Dem,/N_Dimensions) Eq 2 Then Begin K_X = Transpose([-1,1]) K_Y = [-1.0,1.0] Dx = Convol(Dem,K_X,/Edge_Truncate,/Nan)/Pixelsize[1] ; Mei Cuo , Dy = Convol(Dem,K_Y,/Edge_Truncate,/Nan)/Pixelsize[0] Pi = Acos(-1.d) Help,Dx,Dy Slope = Atan( Sqrt(Dx*Dx + Dy * Dy)) * 180.0 / Pi Aspect = 270 + Atan(Dy*1.0 /Dx) - 90.0 * Fix(Dx / Abs(Dx)) EndifEndPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type Sz = Size(Data) Type = Sz[0] Ge 1 ? Sz[-2] : 0 Ns = Sz[0] Ge 1 ? Sz[1] : 1 Nl = Sz[0] Ge 2 ? Sz[2] : 1 Nb = Sz[0] Ge 3 ? Sz[3] : 1 End IDL 求TVDI介绍参见ENVI下温度植被干旱指数(TVDI)功能模块 主要是如何求得散点图上下两条边，我的策略是竖着切开散点，分作n个柱子。每个柱子如果总点数大于200，就统计最大最小的50个点作为干湿边的组成部分。 sort排序函数，where查找满足条件的元素的下标和个数，linefit线性拟合，poly根据拟合结果和x求得y。具体的多看帮助,那里说的详细,还有例子。 1234567891011121314151617181920212223242526272829303132333435363738394041Pro Tvdi,Ndvi,Lst,Nbins,Res Res = -1 Sz1 = Size(Ndvi,/Dimensions) Sz2 = Size(Lst,/Dimensions) If N_Elements(Sz1) Ne 2 Or N_Elements(Sz2) Ne 2 Then Return If Total(Abs(Sz1 - Sz2)) Ne 0 Then Return If ~Isa(Ndvi,/Number) And ~Isa(Lst,/Number) Then Return ;Find Dyr Wet Pts Range = [0.0,1.0] Npt_Filter = 200 Pts = 50 Dry_Pts = [0] Wet_Pts = [0] Idx = Floor(Ndvi * Nbins) For I = 0, Nbins Do Begin Pt = Where(Idx Eq I,Cnt) If(Cnt Gt Npt_Filter) Then Begin Ii = Sort(Lst[Pt]) Dry_Pts = [ Dry_Pts,Pt[Ii[Indgen(Pts)]] ] Wet_Pts = [ Wet_Pts,Pt[Ii[-Indgen(Pts)]] ] Endif End If N_Elements(Dry_Pts) Le 1 Then Return Dry_Pts = Dry_Pts[1:*] Wet_Pts = Wet_Pts[1:*] Wet = Linfit(Ndvi[Wet_Pts],Lst[Wet_Pts]) Dry = Linfit(Ndvi[Dry_Pts],Lst[Dry_Pts]) Good = Where(Ndvi Ge Range[0] And Ndvi Le Range[1],Cnt) If Cnt Le 0 Then Return Res = Make_Array(Size = Size(Ndvi)) Res[Good] = (Lst - Poly(Ndvi[Good],Wet)) / (Poly(Ndvi[Good],Dry) - Poly(Ndvi[Good],Wet) ) End IDL建立影像金字塔形成按目录放好的，类似于Google Map Tile的金字塔瓦片Jpg。 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849Pro Tsplit ; 读入jpeg格式文件 Szfile = 'E:\\Test.Jpg'; Dialog_Pickfile(Title = 'Input Data') Read_Jpeg,Szfile,Image,True = 3 ; 切割5级 Nlevel = 5; ; For Ilevel = 0,Nlevel-1 Do Begin Split,Image,Ilevel,Ib Endfor ReturnEndPro Split,Image,Level,Iband Src = 'E:\\Src' Ns0 = 512 Nl0 = 512 N0 = 2^Level Sz = Size(Image,/Dimensions) Help,Sz Print,Sz Nx = Sz[0] Ny = Sz[1] Xspan = Nx*1.0/N0; Yspan = Ny*1.0/N0; Imglet = Bytarr(Ns0,Nl0,3) Fmt = '(%\"%S\\\\%D\\\\Img_%D_%D.Jpg\")'; For Is = l,N0-1 Do Begin For Il = l,N0 -1 Do Begin X = Indgen(Ns0)#Replicate(1,Nl0)*Xspan/Ns0 + Is*Xspan Y = Replicate(1,Ns0)#Indgen(Nl0)*Yspan/Nl0 + Il*Yspan For Ib = 0,2 Do Begin Imglet[*,*,Ib] = Bilinear(Image[*,*,Ib],X,Y) Endfor Fileout = String(Src,Level,N0-Il-1,Is,Format =Fmt) Dir = File_Dirname(Fileout) If(File_Test(Dir,/Directory) Lt 1) Then File_Mkdir,Dir Write_Jpeg,Fileout,Imglet,True = 3 Endfor EndforEnd; 主程序Pro Pyrmid Tsplit Print,'DoneEnd 按经纬度批量下载MODIS产品Modis免费分发，光谱通道丰富，产品体系成熟，在多个行业和领域有广泛成功的应用。已成为重要的遥感数据源之一。一般若需获取modis数据，要注册wist账号，查询订购（免费）并等待回复mail，整个流程一般约需数小时。为了避免等待，本文用IDL语言实现了modis产品的地理范围查询，返回的url直接添加到迅雷下载任务列表。运行环境：IDL7.0以上版本，迅雷5.0版本以上 原理 Modis官方ftp站点实时记录了5分钟产品的经纬度范围，并保存在txt文件中。Txt各列以逗号分隔，可以用记事本查看。 Modis官方ftp站点还保存有全部常规产品hdf格式文件。 IDL对象IDLnetUrl可以获取ftp站点目录列表，运行ftp命令，获得http协议url指向的文件。 IDL对象IDLcomIDispatch对象可以调用com /ole对象；迅雷ThunderAgent.Agent是一种ole组件，可用于新建添加迅雷下载任务。 流程 ) 指定日期、经纬度多边形polygon ) 获得指定日期5分钟产品的地理范围txt文件，获得指定日期5分钟产品列表（简洁模式） ) 解析txt中各5分钟产品经纬度范围、日夜模式，判断与指定的经纬度polygon是否相交；有交集则记录5分钟产品的url ) 将所有符合要求的hdf文件url添加为迅雷下载任务 源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186;-----------------------------------------------------------------Pro Modistest Query_Download,2010,7,18,[110,110,117,117],[34,30,30,34],Productname='021km'End;-----------------------------------------------------------------Pro Query_Download,Year,Month,Day,Xpoly,Ypoly,Productname=Productname Get_Modis_Metafile,Year,Month,Day,Geometa1,Modlist,/Terra,Productname=Productname Query_Modis,Geometa1,Modlist,Xpoly,Ypoly Get_Modis_Metafile,Year,Month,Day,Geometa2,Mydlist,/Aqua,Productname=Productname Query_Modis,Geometa2,Mydlist,Xpoly,Ypoly If Size(Modlist,/Type) Eq 7 Then L = [Modlist] If Size(Mydlist,/Type) Eq 7 Then L = [L,Mydlist] If N_Elements(L) Gt 0 Then Add_Download,L End;-----------------------------------------------------------------Pro Query_Modis,Data,Filelist,Xpoly,Ypoly Flist =Filelist Filelist = -1 If Size(Data,/Type) Ne 7 Or Size(Flist,/Type) Ne 7 Or N_Elements(Xpoly) Ne N_Elements(Ypoly) Then Return G = &#123;Geometa,G_Id:'',Starttime:'',Set:b,Orbit_Number:l,Daynight:b,Box:Dindgen(4),X:Dindgen(4),Y:Dindgen(4)&#125; Meta = [G] For I = 3,N_Elements(Data)-1 Do Begin If N_Elements(Data) Le 3 Then Return; Tmp = Strsplit(Data[I],\",\",/Extract) If N_Elements(Tmp) Eq 17 Then Begin G.G_Id = (Strsplit(Tmp[0],'.',/Extract))[2] G.Starttime = Tmp[1] G.Set = Tmp[2] G.Orbit_Number = Tmp[3] G.Daynight = Byte(Tmp[4]) G.Box = Tmp[5:8] G.X = Tmp[9:12] G.Y = Tmp[13:16] Meta = [Meta,G] Endif Endfor If N_Elements(Meta) Gt 1 Then Meta = Meta[1:*] Else Return Idx = Intarr(480); I = Fix(Strmid(File_Basename(Flist),18,4))/5 Idx[I] = Indgen(N_Elements(I)) Ret = [''] For I = 0,N_Elements(Meta)-1 Do Begin Id = Idx[Fix(Meta[I].G_Id)/5] ; ;换日线附近一般不满足要求 If (Max(Meta[I].X) - Min(Meta[I].X)) Gt 300 Then Continue ; If Total(Inside(Xpoly,Ypoly,Meta[I].X,Meta[I].Y)) Gt 0 $ And Meta[I].Daynight Lt Byte('N') $ And Id Gt 0 Then Ret = [Ret,Flist[Id]] Endfor Filelist = N_Elements(Ret) Gt 1 ? Ret[1:*] : -1 End;-----------------------------------------------------------------Pro Get_Modis_Metafile,Year,Month,Day,Geometa,Flist,Terra=Terra,Aqua=Aqua,Productname=Productname Geometa = -1 Flist = -1; Catch, Errorstatus If (Errorstatus Ne 0) Then Begin Catch, /Cancel R = Dialog_Message(!Error_State.Msg, Title='Url Error', $ /Error) Print, !Error_State.Msg Return Endif Case 1 Of Keyword_Set(Terra):Begin Prefix = 'Mod' Satellite = 'Terra' Break End Keyword_Set(Aqua):Begin Prefix = 'Myd' Satellite = 'Aqua' Break End Else:Return Endcase Productname = Keyword_Set(Productname) ? Productname : '021km' Site = 'Ftp://Ladsweb.Nascom.Nasa.Gov' Jday = Julday(Month,Day,Year,0,0,0) - Julday(1,1,Year,0,0,0) Format = '(\"Geometa/6/'+Satellite+'/\",I4,\"/\",\"'+Prefix+'03_\",I4,\"-\",I02,\"-\",I02,\".Txt\") Dir_Fmt = '(\"/Alldata/5/\",\"'+Prefix+Productname+'/\",I4,\"/\",I03,\"/\")' Url = String([Year,Year,Month,Day],Format=Format) Dir = Site+ String([Year,Jday],Format = Dir_Fmt) ; Create A New Url Object Ourl = Obj_New('Idlneturl',$ Callback_Function ='Ddcall',$ Url_Scheme = 'Ftp',$ Url_Host = 'Ladsweb.Nascom.Nasa.Gov',$ Url_Path = Url,$ Url_Username = 'Anonymous',$ Url_Password = '',$ Ftp_Connection_Mode = 0) Geometa = Ourl-&gt;Get( /String_Array ) Flist = Dir + Ourl-&gt;Getftpdirlist(Url=Dir,/Short) Ourl-&gt;Closeconnections Obj_Destroy, OurlEnd;-----------------------------------------------------------------Function Ddcall, Status, Progress, Data Print, Status Return, 1End;-----------------------------------------------------------------Pro Add_Download,Url Othunder = Obj_New('Idlcomidispatch$Progid$Thunderagent_Agent'); If Obj_Valid(Othunder) Then Begin For I = 0,N_Elements(Url)-1 Do Othunder-&gt;Addtask,Url[I],\"\",\"\",\"\",\"\",1,0,5 Othunder-&gt;Committasks,1 Obj_Destroy ,Othunder EndifEnd;-----------------------------------------------------------------Function Inside, X, Y, Xpts, Ypts, Index=Index On_Error, 1 Sx = Size(Xpts) Sy = Size(Ypts) If (Sx[0] Eq 1) Then Nx=Sx[1] Else Message, 'X Coordinates Of Polygon Not A Vector.' If (Sy[0] Eq 1) Then Ny=Sy[1] Else Message, 'Y Coordinates Of Polygon Not A Vector.' If (Nx Eq Ny) Then N = Nx Else Message, 'Incompatable Vector Dimensions.' ; Close The Polygon. Tmp_Xpts = [Xpts, Xpts[0]] Tmp_Ypts = [Ypts, Ypts[0]] ; Set Up Counters. I = Indgen(N) Ip = Indgen(N)+1 Nn = N_Elements(X) X1 = Tmp_Xpts(I) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn) Y1 = Tmp_Ypts(I) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn) X2 = Tmp_Xpts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn) Y2 = Tmp_Ypts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn) Dp = X1*X2 + Y1*Y2 ; Dot-Product Cp = X1*Y2 - Y1*X2 ; Cross-Product Theta = Atan(Cp,Dp) Ret = Replicate(0l, N_Elements(X)) I = Where(Abs(Total(Theta,1)) Gt 0.01, Count) If (Count Gt 0) Then Ret(I)=1 ; Make This A Scalar Value If There Is Only One Value. If (N_Elements(Ret) Eq 1) Then Ret=Ret[0] ; If The Index Keyword Is Set, Then Return Indices. If (Arg_Present(Index)) Then Ret=(Indgen(/Long, N_Elements(X)))(Where(Ret Eq 1)) Return, RetEnd","categories":[{"name":"Develop","slug":"Develop","permalink":"http://localhost:4000/categories/Develop/"}],"tags":[{"name":"IDL","slug":"IDL","permalink":"http://localhost:4000/tags/IDL/"},{"name":"Remote Sensing","slug":"Remote-Sensing","permalink":"http://localhost:4000/tags/Remote-Sensing/"}]},{"title":"ToDos","slug":"todos","date":"2017-06-04T12:01:02.000Z","updated":"2018-07-31T13:48:49.181Z","comments":true,"path":"2017/06/04/todos/","link":"","permalink":"http://localhost:4000/2017/06/04/todos/","excerpt":"锻炼 慢跑，直至半马 游泳 徒手健身，力量训练 乐旅游 喀纳斯、丽江、拉萨、深港、厦门 黄山、泰安、哈尔滨、呼伦贝尔 美国（孤单星球手册）","text":"锻炼 慢跑，直至半马 游泳 徒手健身，力量训练 乐旅游 喀纳斯、丽江、拉萨、深港、厦门 黄山、泰安、哈尔滨、呼伦贝尔 美国（孤单星球手册） 美 透视、摄影、钢笔字画 晨读、兴趣, 詹宏志谈读书 文 顾城诗 Chinadaily VOA慢速、常速 事德 理 情 麦肯锡、PDCA、刻意练习、思判、导图速读记忆 8/2法则，要事尽早、优先、21天 30秒 金字塔 三三分解 953100 A4清单 多事合并，小步快跑 保持愉悦感、放慢、从容；赞美，记录日志的习惯； 技计算机（网UIC）： Python 科学计算与数据分析 GoF 设计模式，用户交互设计 Web App，Node，SQL，PS Office VBA 项目管理： 核心需求，商务谈判/议事规则，辩论（换位思考） TED演讲，激励，决策、讲故事、分享 第五级领导人 效能人士： 1分钟原则 战胜拖拉，GTD 有效效果效率， 识记复习 60分钟大声 文献管理，区县百科 GISer： CGB CIM+GIS+BIM 定类计量 定序数据 定距计量 定比计量 遥感信息库、年鉴分析、产业分析 城乡规划信息学 斥力-张力模型，引力模型（平方根比例）","categories":[{"name":"目标","slug":"目标","permalink":"http://localhost:4000/categories/目标/"}],"tags":[{"name":"锻炼","slug":"锻炼","permalink":"http://localhost:4000/tags/锻炼/"},{"name":"享受","slug":"享受","permalink":"http://localhost:4000/tags/享受/"},{"name":"技能","slug":"技能","permalink":"http://localhost:4000/tags/技能/"}]},{"title":"搭建Hexo，在不同机器上编辑博客","slug":"hexo","date":"2017-06-03T10:55:11.000Z","updated":"2018-07-31T13:48:49.180Z","comments":true,"path":"2017/06/03/hexo/","link":"","permalink":"http://localhost:4000/2017/06/03/hexo/","excerpt":"在有git环境，可连github的网络机器上，无缝无痛更新hexo博客。具体包括： 可取回hexo source，并剔除node_modules目录； 可取回theme目录，并剔除对应的node_module目录； 另外机器上的编辑，可正常upload；","text":"在有git环境，可连github的网络机器上，无缝无痛更新hexo博客。具体包括： 可取回hexo source，并剔除node_modules目录； 可取回theme目录，并剔除对应的node_module目录； 另外机器上的编辑，可正常upload； 安装NodeJS 下载NodeJS安装包设置taobao registry npm install -g nrm –registry=https://registry.npm.taobao.org nrm use taobao 安装hexo npm i hexo -g hexo init yourblogpath cd yourblogpath hexo clean hexo g hexo s hexo d Git环境安装GitforWindows 配置github.com的hosts git常用操作 git init git status git add –all git commit -m ‘test’ git remote add origin git@github.com:peaceFun/hexo-src.git git push -f –set-upstream origin master 测试连接github.com打开Git Bash环境 ssh -T git@github.com permission denied问题排除1234567git config --global user.name \"Git账号\" git config --global user.email \"Git邮箱\"ssh-keygen -t rsa -C \"your_email@example.com\"将SSH公钥添加到GitHub账户eval `ssh-agent`ssh-add ~/.ssh/id_rsassh-add -lssh -T git@github.com git下载博客内容 git clone -b hexo-src https://github.com/peaceFun/hexo-src.git hexoblog cd hexoblog npm i 内容文件编辑 hexo clean hexo g hexo s 检查页面显示正常 hexo clean git add –all git commit -m ‘something…’ git push -f –set-upstream origin hexo-src:hexo-src hexo d 打开查看更新后的Geo-I站点 参考：hexo 设置hexo 主题设置miho主题图站","categories":[{"name":"搭建hexo","slug":"搭建hexo","permalink":"http://localhost:4000/categories/搭建hexo/"}],"tags":[{"name":"hexo","slug":"hexo","permalink":"http://localhost:4000/tags/hexo/"},{"name":"博客","slug":"博客","permalink":"http://localhost:4000/tags/博客/"}]},{"title":"Office VBA例子","slug":"wordrep","date":"2017-04-25T05:13:06.000Z","updated":"2018-07-31T13:48:49.182Z","comments":true,"path":"2017/04/25/wordrep/","link":"","permalink":"http://localhost:4000/2017/04/25/wordrep/","excerpt":"替换多个Word文件中的字符串动机需替换多个doc文件中的地名等字符串，人工处理慢且容易出错。","text":"替换多个Word文件中的字符串动机需替换多个doc文件中的地名等字符串，人工处理慢且容易出错。 源码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061' -------------------------------------------------------------------------' 用来替换文件夹多个doc中的字符串' 作者：wishmo@tom.com' 日期：2017年4月25日Function docReplace(fullpath, searchStr, replaceStr) Application.ScreenUpdating = False Dim myDoc As Document Set myDoc = Documents.Open(FileName:=(fullpath)) Selection.Find.ClearFormatting Selection.Find.Replacement.ClearFormatting With Selection.Find .Text = searchStr .Replacement.Text = replaceStr .Forward = True .Wrap = wdFindAsk .Format = False .MatchCase = False .MatchWholeWord = False .MatchByte = True .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute Replace:=wdReplaceAll myDoc.Save myDoc.Close Set myDoc = Nothing Application.ScreenUpdating = TrueEnd Function' ------------------------------------------------------------------------Function getDir() Dim myPath As String ' 选择目标文件夹 With Application.FileDialog(msoFileDialogFolderPicker) .Title = \"选择目标文件夹\" If .Show = -1 Then myPath = .SelectedItems(1) Else Exit Function End If End With getDir = myPathEnd Function' ---------------------------------------------------------------------------' 批量替换多个doc中的字符串' --------------------------------------------------------------------Sub MultiDocReplace() Application.ScreenUpdating = True Dim fpath As String, myPath As String myPath = getDir() docFile = Dir(myPath &amp; \"\\*.doc*\", vbDirectory) Do While docFile &lt;&gt; \"\" ' 开始循环。 fpath = myPath &amp; \"\\\" &amp; docFile Call docReplace(fpath, \"江苏\", \"安徽\") docFile = Dir Loop Application.ScreenUpdating = TrueEnd Sub 根据清单生成GTD事项动机从工作表清单生成重要、紧急、次要、琐事4类事项 源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147' --------------------------------------------------------------------------------' 用来从清单生成紧急、重要、次要、琐事4类清单，督促办理' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------' Sheet1第一行表头，至少包括以下几列' 序号 主题 分项任务 详细说明 结果描述 联络人 提出时间 截止时间 完成时间 重要 紧急 备注' --------------------------------------------------------------------------------' 从本工作表生成数据库连接' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------Function connect() Dim conn As Object, PathStr As String, strConn As String, strSQL As String Set conn = CreateObject(\"ADODB.Connection\") PathStr = ThisWorkbook.FullName '设置工作簿的完整路径和名称 Select Case Application.Version * 1 '设置连接字符串,根据版本创建连接 Case Is &lt;= 11 strConn = \"Provider=Microsoft.Jet.Oledb.4.0;Extended Properties=excel 8.0;Data source=\" &amp; PathStr Case Is &gt;= 12 strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; PathStr &amp; \";Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\"\" End Select conn.Open strConn Set connect = connEnd Function' --------------------------------------------------------------------------------' 删除工作表、新建工作表' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------Function renewSheet(shtname) On Error Resume Next Application.DisplayAlerts = False Set sht = Sheets(shtname) If Not IsNull(sht) Then sht.Delete End If Set sht = Sheets.Add() sht.Name = shtname Set renewSheet = sht Application.DisplayAlerts = TrueEnd Function' --------------------------------------------------------------------------------' 在指定的工作表中填充4类事项' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------Sub divide(conn, targetShtName) 'On Error Resume Next Dim firstrow As Integer, rst As Object Dim title(5) As String, cindex(5) As Integer, mode As Integer, i As Integer Dim SQL(5) As String, pre As String pre = \"select 序号,主题,分项任务,详细说明,结果描述,联络人,提出时间,截止时间,备注 from [Sheet1$A1:M100] where 分项任务 is not null and 完成时间 is null and \" SQL(0) = pre + \" len(重要) &gt; 0 and len(紧急) &gt;0\" SQL(1) = pre + \" len(重要) &gt; 0 and 紧急 is null\" SQL(2) = pre + \" 重要 is null and len(紧急) &gt; 0 \" SQL(3) = pre + \" 重要 is null and 紧急 is null \" SQL(4) = \"select 序号,主题,分项任务,详细说明,结果描述,联络人,提出时间,截止时间,备注 from [Sheet1$A1:M100] where 完成时间 is not null\" cindex(0) = 3 cindex(1) = 5 cindex(2) = 6 cindex(3) = 8 cindex(4) = 10 title(0) = \"紧急\" title(1) = \"重要\" title(2) = \"琐事\" title(3) = \"小事\" title(4) = \"完结\" Debug.Print targetShtName Set rst = CreateObject(\"ADODB.Recordset\") Set sht = Sheets(targetShtName) firstrow = 1 With sht rst.CursorLocation = 3 For mode = 0 To 4 Step 1 rst.Open SQL(mode), conn, adOpenKeyset If rst.Fields.Count &gt; 1 Then Range(Cells(firstrow + 1, 1), Cells(firstrow + 1, rst.Fields.Count)).Merge .Cells(firstrow + 1, 1).Value = title(mode) .Cells(firstrow + 1, 1).RowHeight = 35 .Cells(firstrow + 1, 1).HorizontalAlignment = xlCenter ' 居中 .Cells(firstrow + 1, 1).Interior.ColorIndex = cindex(mode) .Cells(2 + firstrow, i + 1).ColumnWidth = 10 For i = 0 To rst.Fields.Count - 1 '填写标题 fdname = rst.Fields(i).Name .Cells(2 + firstrow, i + 1).ColumnWidth = getWidth(fdname) .Cells(2 + firstrow, i + 1).EntireRow.AutoFit .Cells(2 + firstrow, i + 1) = fdname Next i End If ' 复制选择集数据 Range(\"A\" &amp; (firstrow + 3)).CopyFromRecordset rst firstrow = firstrow + rst.RecordCount + 4 rst.Close Next mode ' .Cells.EntireColumn.AutoFit '自动调整列宽 .Cells.WrapText = True Set rst = Nothing End WithEnd Sub' --------------------------------------------------------------------------------' 根据字段名获得列宽' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------Function getWidth(fdname) dim wid as Integer wid = 10 Select Case fdname Case \"分项任务\" wid = 20 Case \"详细说明\" wid = 20 Case \"结果描述\" wid = 30 Case \"备注\" wid = 15 Case Else wid = 10 End Select getWidth = widEnd Function' --------------------------------------------------------------------------------' 用来从清单生成紧急、重要、次要、琐事4类清单，督促办理' 作者：wishmo@tom.com' 日期：2017年4月25日' --------------------------------------------------------------------------------Sub GTD() Dim conn As Object, rst As Object Set conn = connect() Set sht = renewSheet(\"4象限\") Call divide(conn, \"4象限\") conn.Close Set conn = Nothing End Sub 合并重复单元格动机要将内容相同的相邻单元格合并为1个 源码1234567891011121314151617181920212223242526272829303132333435363738394041424344Sub MergeCellsWithSameValue() Application.ScreenUpdating = False Application.DisplayAlerts = False Dim r As Integer Dim c As Integer Sheets(\"Sheet1\").Activate For r = Sheet1.UsedRange.Rows.Count To 1 Step -1 For c = Sheet1.UsedRange.Columns.Count To 1 Step -1 If Not IsEmpty(Cells(r, c)) Then If Not IsNumeric(Left(Cells(r, c).Value, 1)) Then If r &gt; 1 Then If Not IsEmpty(Cells(r - 1, c).Value) Then If Cells(r, c) = Cells(r - 1, c) Then Range(Cells(r, c), Cells(r - 1, c)).Merge GoTo NEXTLOOP End If End If End If If c &gt; 1 Then If Not IsEmpty(Cells(r, c - 1).Value) Then If Cells(r, c) = Cells(r, c - 1) Then Range(Cells(r, c), Cells(r, c - 1)).Merge GoTo NEXTLOOP End If End If End If End If End IfNEXTLOOP: Next Next Sheet1.UsedRange.EntireRow.AutoFit Sheet1.UsedRange.EntireColumn.AutoFit Sheet1.UsedRange.HorizontalAlignment = xlCenter Sheet1.UsedRange.VerticalAlignment = xlCenter Application.DisplayAlerts = True Application.ScreenUpdating = True End Sub","categories":[{"name":"Develop","slug":"Develop","permalink":"http://localhost:4000/categories/Develop/"}],"tags":[{"name":"word","slug":"word","permalink":"http://localhost:4000/tags/word/"},{"name":"vba","slug":"vba","permalink":"http://localhost:4000/tags/vba/"}]}]}