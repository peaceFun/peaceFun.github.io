{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/icon.jpg","path":"icon.jpg","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"source/404.html","hash":"9eb955271b03c72a4bb23a06b60e4ecb4070a880","modified":1496582225000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1498209012256},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1498209012261},{"_id":"themes/next/.javascript_ignore","hash":"f9ea3c5395f8feb225a24e2c32baa79afda30c16","modified":1498209012281},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1498209012277},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1498209012285},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1498209012287},{"_id":"themes/next/.travis.yml","hash":"c42d9608c8c7fe90de7b1581a8dc3886e90c179e","modified":1498209012291},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1498209012296},{"_id":"themes/next/README.en.md","hash":"4ece25ee5f64447cd522e54cb0fffd9a375f0bd4","modified":1498209012302},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1498209012307},{"_id":"themes/next/_config.yml","hash":"b970348bc30f9c71cd98e0f39f205de98e310e99","modified":1496569512816},{"_id":"themes/next/bower.json","hash":"be0a430362cb73a7e3cf9ecf51a67edf8214b637","modified":1498209012314},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1498209012319},{"_id":"themes/next/package.json","hash":"7e87b2621104b39a30488654c2a8a0c6a563574b","modified":1498209012860},{"_id":"source/_posts/IDL.md","hash":"7942f6e89d7c19b005422684714feae77e01fe26","modified":1497017689000},{"_id":"source/_posts/hexo.md","hash":"e0010ecdb158c197f9dfb91c41cc51b735857450","modified":1496584060000},{"_id":"source/_posts/manager.md","hash":"01536ed77b2a5eaae4524b6a0a207cb92aaff498","modified":1497528419000},{"_id":"source/_posts/todos.md","hash":"97a732213005293c1cdf71b2eaa02eeb312b6931","modified":1528417866960},{"_id":"source/_posts/webgis.md","hash":"17c825c246df3f61a1c059edc406dbf46289c016","modified":1497014598000},{"_id":"source/_posts/wordrep.md","hash":"b9f6063ef6ad78ae1f406779fec8464f33e4016b","modified":1497012265000},{"_id":"source/about/index.md","hash":"3f17a8572e4827aa3700492be4c1f548a916d940","modified":1528418060332},{"_id":"source/categories/index.md","hash":"674b0625991750232daa94191e297af1c0fc1082","modified":1496582225000},{"_id":"source/icon.jpg","hash":"f292ca6f0d76d28ef716384c7ffff8b88ef807d0","modified":1496582225000},{"_id":"source/tags/index.md","hash":"1df26ee3c3ed7653ff0195b29ebfb141c0e22c98","modified":1496582226000},{"_id":"themes/next/languages/de.yml","hash":"306db8c865630f32c6b6260ade9d3209fbec8011","modified":1498209012324},{"_id":"themes/next/languages/default.yml","hash":"4cc6aeb1ac09a58330e494c8771773758ab354af","modified":1498209012325},{"_id":"themes/next/languages/en.yml","hash":"e7def07a709ef55684490b700a06998c67f35f39","modified":1498209012327},{"_id":"themes/next/languages/fr-FR.yml","hash":"24180322c83587a153cea110e74e96eacc3355ad","modified":1498209012332},{"_id":"themes/next/languages/ja.yml","hash":"1c3a05ab80a6f8be63268b66da6f19da7aa2c638","modified":1498209012334},{"_id":"themes/next/languages/id.yml","hash":"2835ea80dadf093fcf47edd957680973f1fb6b85","modified":1498209012333},{"_id":"themes/next/languages/ko.yml","hash":"be150543379150f78329815af427bf152c0e9431","modified":1498209012340},{"_id":"themes/next/languages/pt-BR.yml","hash":"958e49571818a34fdf4af3232a07a024050f8f4e","modified":1498209012345},{"_id":"themes/next/languages/pt.yml","hash":"36c8f60dacbe5d27d84d0e0d6974d7679f928da0","modified":1498209012350},{"_id":"themes/next/languages/zh-Hans.yml","hash":"3c0c7dfd0256457ee24df9e9879226c58cb084b5","modified":1498209012357},{"_id":"themes/next/languages/ru.yml","hash":"1549a7c2fe23caa7cbedcd0aa2b77c46e57caf27","modified":1498209012352},{"_id":"themes/next/languages/zh-hk.yml","hash":"1c917997413bf566cb79e0975789f3c9c9128ccd","modified":1498209012361},{"_id":"themes/next/languages/zh-tw.yml","hash":"0b2c18aa76570364003c8d1cd429fa158ae89022","modified":1498209012362},{"_id":"themes/next/layout/_layout.swig","hash":"a44305f8fa7fe9c80eb50c0696a704424b589750","modified":1498209012385},{"_id":"themes/next/layout/archive.swig","hash":"5de4dca06b05d99e4f6bad617a4b8f4f3592fb01","modified":1498209012833},{"_id":"themes/next/layout/category.swig","hash":"82e7bc278559b4335ad974659104eaaf04863032","modified":1498209012837},{"_id":"themes/next/layout/index.swig","hash":"03e8a2cda03bad42ac0cb827025eb81f95d496a2","modified":1498209012841},{"_id":"themes/next/layout/page.swig","hash":"baa667bc801349d5c4984c0f172973d3780400df","modified":1498209012846},{"_id":"themes/next/layout/post.swig","hash":"2d5f8d7f0a96b611e2d5a5e4d111fc17726a990f","modified":1498209012847},{"_id":"themes/next/layout/schedule.swig","hash":"f93c53f6fd5c712584f6efba6f770c30fa8a3e80","modified":1498209012852},{"_id":"themes/next/layout/tag.swig","hash":"2e73ee478e981092ea9a5d10dd472a9461db395b","modified":1498209012856},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1498209014584},{"_id":"themes/next/scripts/merge-configs.js","hash":"13c8b3a2d9fce06c2488820d9248d190c8100e0a","modified":1498209012867},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1498209014598},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1498209012882},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1498209014611},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013298},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1498209012364},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1498209012365},{"_id":"themes/next/layout/_partials/comments.swig","hash":"1c7d3c975e499b9aa3119d6724b030b7b00fc87e","modified":1498209012417},{"_id":"themes/next/layout/_partials/footer.swig","hash":"7172c6053118b7c291a56a7860128a652ae66b83","modified":1498209012422},{"_id":"themes/next/layout/_partials/head.swig","hash":"6a7eb93d8aa7d4baa472890bd666b921f449d8af","modified":1498209012432},{"_id":"themes/next/layout/_partials/header.swig","hash":"a1ffbb691dfad3eaf2832a11766e58a179003b8b","modified":1498209012440},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1498209012444},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1498209012445},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1498209012449},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1498209012391},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"b16fcbf0efd20c018d7545257a8533c497ea7647","modified":1498209012395},{"_id":"themes/next/layout/_macro/post.swig","hash":"9481f43ed356e00df7b519e92ad0becebc9e1505","modified":1498209012405},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1498209012410},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"a2b213c1a7c37cd6e4749f2018371f4c1f4f0d23","modified":1498209012412},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1498209012416},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1498209012517},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1498209012518},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"9baf90f7c40b3b10f288e9268c3191e895890cea","modified":1498209012538},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1498209012711},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1498209012709},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1498209012727},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1498209012738},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1498209012762},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1498209012756},{"_id":"themes/next/scripts/tags/button.js","hash":"62e6dbeb53d07627a048132c79630b45d9a8f2cc","modified":1498209012890},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1498209012891},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1498209012905},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1498209012921},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1498209012923},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1498209013297},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1498209013303},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1498209013305},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1498209013310},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1498209013316},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1498209013322},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1498209013328},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1498209013334},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1498209013339},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1498209013345},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1498209013347},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1498209013348},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1498209013353},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1498209013357},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1498209013359},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1498209012907},{"_id":"themes/next/scripts/tags/note.js","hash":"21b102db8a01c7b15ae2c0ea3ef3d4cf807ec6ed","modified":1498209012924},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209012523},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209012524},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013187},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013188},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013202},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013284},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1498209013295},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1498209012434},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1498209012439},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1498209012454},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1498209012467},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1498209012463},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1498209012472},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1498209012495},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1498209012500},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1498209012512},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1498209012522},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1498209012528},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1498209012557},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1498209012558},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1498209012563},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1498209012568},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1498209012580},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1498209012591},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"3358d11b9a26185a2d36c96049e4340e701646e4","modified":1498209012592},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1498209012615},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1498209012632},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1498209012645},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1498209012647},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1498209012670},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1498209012681},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1498209012682},{"_id":"themes/next/layout/_third-party/comments/gentie.swig","hash":"03592d1d731592103a41ebb87437fe4b0a4c78ca","modified":1498209012694},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"abb92620197a16ed2c0775edf18a0f044a82256e","modified":1498209012696},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1498209012695},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"af9dd8a4aed7d06cf47b363eebff48850888566c","modified":1498209012708},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"1d0d01aaeb7bcde3671263d736718f8837c20182","modified":1498209012706},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1498209012773},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1498209012796},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1498209012810},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1498209012822},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1498209013186},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1498209013192},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1498209013202},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1498209013283},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"06f432f328a5b8a9ef0dbd5301b002aba600b4ce","modified":1498209013286},{"_id":"themes/next/source/css/_variables/base.styl","hash":"d4061ecbf65479f62cca6ceff207d94fd91e3dc7","modified":1498209661396},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1498209013376},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1498209013386},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1498209013406},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"aab7be0a6e2724b3faa9338db93c19556c559625","modified":1498209013394},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1498209013417},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1498209013415},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1498209013431},{"_id":"themes/next/source/js/src/post-details.js","hash":"af7a417dd1cb02465a7b98211653e7c6192e6d55","modified":1498209013444},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1498209013459},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1498209013548},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1498209013461},{"_id":"themes/next/source/js/src/utils.js","hash":"b2ea56de27fddc6d9118051da384f781cd93951d","modified":1498209013462},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1498209013856},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"3587602ad777b031628bb5944864d1a4fcfea4ac","modified":1498209013868},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1498209013873},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1498209013878},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1498209013980},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1498209013982},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1498209013990},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1498209013991},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1498209014056},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1498209014049},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1498209014054},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1498209014064},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1498209014066},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1498209014146},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1498209014240},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1498209014242},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1498209014248},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1498209014250},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1498209014251},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1498209014256},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1498209014260},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1498209014264},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1498209014269},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1498209014268},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1498209014273},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1498209014277},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1498209014281},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1498209014201},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1498209014306},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1498209014203},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1498209014204},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1498209014207},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1498209014224},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1498209014238},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1498209014325},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1498209014348},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1498209014370},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1498209014500},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1498209014506},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1498209014554},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1498209014566},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1498209014578},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1498209014199},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1498209012767},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1498209012771},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"59ad08bcc6fe9793594869ac2b4c525021453e78","modified":1498209012926},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"ef089a407c90e58eca10c49bc47ec978f96e03ba","modified":1498209012931},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1498209012932},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1498209012936},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1498209012938},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1498209012990},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1498209013097},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1498209013156},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"7804e31c44717c9a9ddf0f8482b9b9c1a0f74538","modified":1498209013162},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1498209013171},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1498209013177},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1498209013179},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1498209013184},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1498209013211},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1498209013219},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1498209013221},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1498209013229},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fda14bc35be2e1b332809b55b3d07155a833dbf4","modified":1498209013238},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1498209013245},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1498209013247},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1498209013252},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1498209013253},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"82bbaa6322764779a1ac2e2c8390ce901c7972e2","modified":1498209013255},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1498209013262},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1498209013256},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1498209013265},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1498209013270},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1498209013272},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1498209013273},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"e3e23751d4ad24e8714b425d768cf68e37de7ded","modified":1498209013275},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1498209013276},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"d9c0b3dc9158e717fde36f554709e6c3a22b5f85","modified":1498209013521},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"79da92119bc246fe05d1626ac98426a83ec90a94","modified":1498209013451},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1498209013880},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1498209013543},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1498209013881},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1498209013882},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1498209013884},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1498209013885},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1498209013887},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1498209013936},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1498209013957},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1498209013979},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1498209014073},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1498209014010},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1498209014078},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1498209014085},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1498209014042},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1498209014482},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1498209014495},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"38e48f275ad00daa9dcdcb8d9b44e576acda4707","modified":1498209013486},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1498209013516},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1498209014135},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1498209014141},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1498209014530},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1498209012939},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1498209012944},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1498209012946},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1498209012951},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1498209012947},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1498209012956},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1498209012960},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"740d37f428b8f4574a76fc95cc25e50e0565f45e","modified":1498209012965},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1498209012967},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1498209013002},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"beccb53dcd658136fb91a0c5678dea8f37d6e0b6","modified":1498209012994},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1498209013006},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1498209013007},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1498209013015},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"88c7d75646b66b168213190ee4cd874609afd5e3","modified":1498209013014},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"ed88c8b51d0517759c777e71a6bfbe2907bcd994","modified":1498209013020},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1498209013024},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1498209013030},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1498209013026},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1498209013034},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1498209013041},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"08a500b2984f109b751f3697ca33172d1340591a","modified":1498209013048},{"_id":"themes/next/source/css/_common/components/post/post-wordcount.styl","hash":"4fda5d38c6c8d910e3bf5c74a48a8d4a3f3dc73d","modified":1498209013054},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"468bc734f47209096588ef1a8e55e60a3b12aa63","modified":1498209013055},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1498209013064},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"5f6ea57aabfa30a437059bf8352f1ad829dbd4ff","modified":1498209013070},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1498209013072},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1498209013078},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1498209013060},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"77c92a449ce84d558d26d052681f2e0dd77c70c9","modified":1498209013082},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"a2ec22ef4a6817bbb2abe8660fcd99fe4ca0cc5e","modified":1498209013083},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1498209013088},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1498209013092},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1498209013100},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1498209013099},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1498209013101},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1498209013103},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"dfc86d37f5b580977d82af6ef835082d09a0c499","modified":1498209013104},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"dd310c2d999185e881db007360176ee2f811df10","modified":1498209013108},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1498209013113},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1498209013117},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1498209013122},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1498209013128},{"_id":"themes/next/source/css/_common/components/third-party/gentie.styl","hash":"586a3ec0f1015e7207cd6a2474362e068c341744","modified":1498209013131},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1498209013136},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1498209013142},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"bb3be8374c31c372ed0995bd8030d2b920d581de","modified":1498209013147},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1498209013141},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1498209012971},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1498209012975},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1498209012983},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1498209012981},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1498209012985},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1498209013249},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1498209013250},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1498209013263},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1498209013466},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1498209013470},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1498209013476},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1498209013481},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1498209013893},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1498209013888},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1498209013915},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1498209013909},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1498209013910},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1498209013931},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1498209014101},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1498209014094},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1498209014129},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1498209013843},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1498209014468},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1498209014121},{"_id":"public/atom.xml","hash":"c95f4bc318aa2480aa34c3a5a4f34dc44aa233e8","modified":1528418315456},{"_id":"public/baidusitemap.xml","hash":"f3647467a7b910f4e3a6c06a09fcebf73955e41c","modified":1528418315464},{"_id":"public/sitemap.xml","hash":"bdcc91dfd208074ff71b90345223115187c696ee","modified":1528418315465},{"_id":"public/404.html","hash":"a3cfae671e2950ec65e97fa507bdd757c108641b","modified":1528418315470},{"_id":"public/about/index.html","hash":"192c6ec51e68bb535faaae7eb06d2e1d2c459936","modified":1528418315470},{"_id":"public/categories/index.html","hash":"9b6ebe41ad46b2bafceea1715ffe4d149a07961d","modified":1528418315470},{"_id":"public/tags/index.html","hash":"73ff45c888fe94c0b0ccd7df7052beef198f0119","modified":1528418315470},{"_id":"public/archives/index.html","hash":"23b96acfaefb3587df3a40bffa803e625819349a","modified":1528418315471},{"_id":"public/archives/2017/index.html","hash":"bb37fb776b43b336520ad2816dae000bfcce7918","modified":1528418315471},{"_id":"public/archives/2017/04/index.html","hash":"9264f3b627a0d55c192293ec7496a189958c7f49","modified":1528418315471},{"_id":"public/archives/2017/06/index.html","hash":"cff0f007b8bef5124401274a0b9a65f3bb2b903b","modified":1528418315471},{"_id":"public/categories/hexo/index.html","hash":"3b058bbde83cddc1216c5e6fad71e92b931beb15","modified":1528418315471},{"_id":"public/categories/Develop/index.html","hash":"efac9b7e5a70a57ae0c4815c9745b0be2678e9ec","modified":1528418315471},{"_id":"public/categories/Management/index.html","hash":"5aee60ae3242f1ca00232cca07a1ffe854390f9a","modified":1528418315471},{"_id":"public/categories//index.html","hash":"525b7c6de3b30327099e1e7e5482eab3f0810014","modified":1528418315471},{"_id":"public/tags/hexo/index.html","hash":"c87edab833239f500d2e59537be5f5996db11fb6","modified":1528418315471},{"_id":"public/tags//index.html","hash":"41d7efcf86aa1d0e7f83978ca0b57009018e6d7a","modified":1528418315471},{"_id":"public/tags/IDL/index.html","hash":"a92b3b63f99a42af3ce674e04023009ef0777d3a","modified":1528418315471},{"_id":"public/tags/Remote-Sensing/index.html","hash":"3ca1279bf8787d495fb51f6622f5da0a4a7aabbb","modified":1528418315471},{"_id":"public/tags//index.html","hash":"6fae0036149d1eb986e8bea0c096e2bbafde0b56","modified":1528418315471},{"_id":"public/tags//index.html","hash":"838f79205c0ede5e51d5e9267b3e3e8dea45023f","modified":1528418315471},{"_id":"public/tags//index.html","hash":"61388614ec17b94f3ab1279798ad104a9a6d6b7d","modified":1528418315471},{"_id":"public/tags//index.html","hash":"0f739ab5345f7f258dfe1a0351266d6dce5efdc2","modified":1528418315472},{"_id":"public/tags/WebGIS/index.html","hash":"bbfebd159e20a390a652dfa6b2adadf5ab0c1a25","modified":1528418315472},{"_id":"public/tags/word/index.html","hash":"06c83f019f954ec7932a11aa144b436f62fc9bde","modified":1528418315472},{"_id":"public/tags/vba/index.html","hash":"7f126372e166528a6c73e6425fb5d3769c908bf7","modified":1528418315472},{"_id":"public/2017/06/15/manager/index.html","hash":"7f2e98c14ffb01db4fa73005b79a639415732d83","modified":1528418315472},{"_id":"public/2017/06/04/webgis/index.html","hash":"77445c2b251e38c490acdcb8abe99897af94b2e0","modified":1528418315472},{"_id":"public/2017/06/04/IDL/index.html","hash":"981d2bffe4ff306ae56d8a661cc129755df3cfc6","modified":1528418315472},{"_id":"public/2017/06/04/todos/index.html","hash":"58cd6c268de155f92286dcbcc3d56205ac58ee48","modified":1528418315472},{"_id":"public/2017/06/03/hexo/index.html","hash":"c788f526b31d7d71d5ae1aba3465ec02d3e7a77e","modified":1528418315472},{"_id":"public/2017/04/25/wordrep/index.html","hash":"f1104676782845f706b5eacd4b2f5be7dccfc837","modified":1528418315472},{"_id":"public/index.html","hash":"6268c9d11a49df1d8c122ddc05ce1b6140e3efa7","modified":1528418315472},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1528418315529},{"_id":"public/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1528418315529},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1528418315529},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1528418315529},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1528418315529},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1528418315529},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1528418315529},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1528418315529},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1528418315529},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1528418315530},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1528418315530},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1528418315530},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1528418315530},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1528418315530},{"_id":"public/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1528418315530},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1528418315530},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1528418315530},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1528418315530},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1528418315530},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1528418315530},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1528418315531},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1528418315531},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1528418315531},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1528418315531},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1528418315531},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1528418315531},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1528418315531},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1528418315531},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1528418316215},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1528418316222},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1528418316246},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1528418316246},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1528418316246},{"_id":"public/js/src/bootstrap.js","hash":"aab7be0a6e2724b3faa9338db93c19556c559625","modified":1528418316246},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1528418316246},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1528418316246},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1528418316246},{"_id":"public/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1528418316247},{"_id":"public/js/src/post-details.js","hash":"af7a417dd1cb02465a7b98211653e7c6192e6d55","modified":1528418316247},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1528418316247},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1528418316247},{"_id":"public/lib/fastclick/README.html","hash":"da3c74d484c73cc7df565e8abbfa4d6a5a18d4da","modified":1528418316247},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1528418316247},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1528418316247},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1528418316247},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1528418316247},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1528418316247},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1528418316247},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1528418316248},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1528418316248},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"3587602ad777b031628bb5944864d1a4fcfea4ac","modified":1528418316248},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1528418316249},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"a6358170d346af13b1452ac157b60505bec7015c","modified":1528418316249},{"_id":"public/js/src/utils.js","hash":"b2ea56de27fddc6d9118051da384f781cd93951d","modified":1528418316249},{"_id":"public/lib/jquery_lazyload/README.html","hash":"bde24335f6bc09d8801c0dcd7274f71b466552bd","modified":1528418316249},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1528418316249},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1528418316249},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1528418316249},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1528418316249},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1528418316249},{"_id":"public/js/src/schemes/pisces.js","hash":"79da92119bc246fe05d1626ac98426a83ec90a94","modified":1528418316249},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1528418316249},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1528418316250},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1528418316250},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1528418316250},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1528418316250},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1528418316250},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1528418316250},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1528418316250},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1528418316250},{"_id":"public/css/main.css","hash":"83273fe374df5d36a90f7dc9cc24fec5b6de4891","modified":1528418316250},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1528418316250},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1528418316250},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1528418316251},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1528418316251},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1528418316251},{"_id":"public/lib/Han/dist/han.min.css","hash":"d9c0b3dc9158e717fde36f554709e6c3a22b5f85","modified":1528418316251},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1528418316251},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1528418316251},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1528418316251},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1528418316251},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1528418316251},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1528418316252},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1528418316252},{"_id":"public/lib/Han/dist/han.css","hash":"38e48f275ad00daa9dcdcb8d9b44e576acda4707","modified":1528418316252},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1528418316252},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1528418316252},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1528418316252},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1528418316252},{"_id":"public/icon.jpg","hash":"f292ca6f0d76d28ef716384c7ffff8b88ef807d0","modified":1528418316253},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1528418316253},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1528418316253},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1528418316253},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1528418316294}],"Category":[{"name":"hexo","_id":"cji58stt90005zsr4ucp6r0qk"},{"name":"Develop","_id":"cji58stti000bzsr42k2odlqh"},{"name":"Management","_id":"cji58sttm000fzsr482gmp8wk"},{"name":"","_id":"cji58sttp000kzsr4xfiq433i"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","date":"2018-06-07T08:59:05.668Z","updated":"2017-06-04T13:17:05.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cji58strf0000zsr46803jd2t","content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","site":{"data":{}},"excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>"},{"title":"","date":"2018-06-08T00:34:02.000Z","_content":"\n## \n\nA Geo-Intelligence Minner\n \nQQ303358320    \nEmail: wishmo@yeah.net\n","source":"about/index.md","raw":"---\ntitle: \ndate: 2018-06-08 08:34:02\n---\n\n## \n\nA Geo-Intelligence Minner\n \nQQ303358320    \nEmail: wishmo@yeah.net\n","updated":"2018-06-08T00:34:20.332Z","path":"about/index.html","comments":1,"layout":"page","_id":"cji58stt50002zsr4d6zq0v5k","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br>A Geo-Intelligence Minner</p>\n<p>QQ303358320<br>Email: <a href=\"mailto:wishmo@yeah.net\" target=\"_blank\" rel=\"noopener\">wishmo@yeah.net</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br>A Geo-Intelligence Minner</p>\n<p>QQ303358320<br>Email: <a href=\"mailto:wishmo@yeah.net\" target=\"_blank\" rel=\"noopener\">wishmo@yeah.net</a></p>\n"},{"title":"categories","date":"2017-06-03T10:27:52.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2017-06-03 18:27:52\ntype: \"categories\"\n---\n","updated":"2017-06-04T13:17:05.000Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cji58stt80004zsr42j0et7ab","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","date":"2017-06-03T10:33:35.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2017-06-03 18:33:35\ntype: \"tags\"\n\n---\n","updated":"2017-06-04T13:17:06.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cji58sttd0008zsr45d4ixmdu","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Hexo","date":"2017-06-03T10:55:11.000Z","_content":"\n\n## \n\n> https://github.com/peaceFun/hexo-src.git\n> \n> 1. git init \n> 1. git add .\n> 1. git commit -m 'test'\n> 1. git remote add origin git@github.com:peaceFun/hexo-src.git\n> 1. git push -f --set-upstream origin master\n> \n\n## \n> 1. hexo clean \n> 1. git push -f --set-upstream origin master\n\n\n<!--more-->\n## \n\n1. hexo init hexo\n2. git clone https://github.com/peaceFun/hexo-src.git rt\n3. cp -Rf rt/. hexo\n4. rm -rf rt\n\n\n## NPM taobao\n> http://npm.taobao.org\n> \n```\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\n\ncnpm install -g hexo\ncnpm install -g hexo-generator-feed\ncnpm install -g hexo-generator-sitemap\ncnpm install -g hexo-deployer-git\ncnpm install -g hexo-generator-tag\ncnpm install -g hexo-cli\n```","source":"_posts/hexo.md","raw":"---\ntitle: Hexo\ndate: 2017-06-03 18:55:11\ntags: [hexo,]\ncategories: hexo\n---\n\n\n## \n\n> https://github.com/peaceFun/hexo-src.git\n> \n> 1. git init \n> 1. git add .\n> 1. git commit -m 'test'\n> 1. git remote add origin git@github.com:peaceFun/hexo-src.git\n> 1. git push -f --set-upstream origin master\n> \n\n## \n> 1. hexo clean \n> 1. git push -f --set-upstream origin master\n\n\n<!--more-->\n## \n\n1. hexo init hexo\n2. git clone https://github.com/peaceFun/hexo-src.git rt\n3. cp -Rf rt/. hexo\n4. rm -rf rt\n\n\n## NPM taobao\n> http://npm.taobao.org\n> \n```\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\n\ncnpm install -g hexo\ncnpm install -g hexo-generator-feed\ncnpm install -g hexo-generator-sitemap\ncnpm install -g hexo-deployer-git\ncnpm install -g hexo-generator-tag\ncnpm install -g hexo-cli\n```","slug":"hexo","published":1,"updated":"2017-06-04T13:47:40.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58stt10001zsr4nxowwvbm","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p><a href=\"https://github.com/peaceFun/hexo-src.git\" target=\"_blank\" rel=\"noopener\">https://github.com/peaceFun/hexo-src.git</a></p>\n<ol>\n<li>git init </li>\n<li>git add .</li>\n<li>git commit -m test</li>\n<li>git remote add origin <a href=\"mailto:git@github.com\" target=\"_blank\" rel=\"noopener\">git@github.com</a>:peaceFun/hexo-src.git</li>\n<li>git push -f set-upstream origin master</li>\n</ol>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<ol>\n<li>hexo clean </li>\n<li>git push -f set-upstream origin master</li>\n</ol>\n</blockquote>\n<a id=\"more\"></a>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>hexo init hexo</li>\n<li>git clone <a href=\"https://github.com/peaceFun/hexo-src.git\" target=\"_blank\" rel=\"noopener\">https://github.com/peaceFun/hexo-src.git</a> rt</li>\n<li>cp -Rf rt/. hexo</li>\n<li>rm -rf rt</li>\n</ol>\n<h2 id=\"NPM-taobao\"><a href=\"#NPM-taobao\" class=\"headerlink\" title=\"NPM taobao\"></a>NPM taobao</h2><blockquote>\n<p><a href=\"http://npm.taobao.org\" target=\"_blank\" rel=\"noopener\">http://npm.taobao.org</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class=\"line\"></span><br><span class=\"line\">cnpm install -g hexo</span><br><span class=\"line\">cnpm install -g hexo-generator-feed</span><br><span class=\"line\">cnpm install -g hexo-generator-sitemap</span><br><span class=\"line\">cnpm install -g hexo-deployer-git</span><br><span class=\"line\">cnpm install -g hexo-generator-tag</span><br><span class=\"line\">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p><a href=\"https://github.com/peaceFun/hexo-src.git\" target=\"_blank\" rel=\"noopener\">https://github.com/peaceFun/hexo-src.git</a></p>\n<ol>\n<li>git init </li>\n<li>git add .</li>\n<li>git commit -m test</li>\n<li>git remote add origin <a href=\"mailto:git@github.com\" target=\"_blank\" rel=\"noopener\">git@github.com</a>:peaceFun/hexo-src.git</li>\n<li>git push -f set-upstream origin master</li>\n</ol>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<ol>\n<li>hexo clean </li>\n<li>git push -f set-upstream origin master</li>\n</ol>\n</blockquote>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>hexo init hexo</li>\n<li>git clone <a href=\"https://github.com/peaceFun/hexo-src.git\" target=\"_blank\" rel=\"noopener\">https://github.com/peaceFun/hexo-src.git</a> rt</li>\n<li>cp -Rf rt/. hexo</li>\n<li>rm -rf rt</li>\n</ol>\n<h2 id=\"NPM-taobao\"><a href=\"#NPM-taobao\" class=\"headerlink\" title=\"NPM taobao\"></a>NPM taobao</h2><blockquote>\n<p><a href=\"http://npm.taobao.org\" target=\"_blank\" rel=\"noopener\">http://npm.taobao.org</a></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class=\"line\"></span><br><span class=\"line\">cnpm install -g hexo</span><br><span class=\"line\">cnpm install -g hexo-generator-feed</span><br><span class=\"line\">cnpm install -g hexo-generator-sitemap</span><br><span class=\"line\">cnpm install -g hexo-deployer-git</span><br><span class=\"line\">cnpm install -g hexo-generator-tag</span><br><span class=\"line\">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure>"},{"title":"IDL","date":"2017-06-04T12:24:36.000Z","_content":"\n## \nIDL\n\n## IDL\n\n1. IDLSolving Real Problems with Computer Graphicsppt\n1. IDLIDLpptcode\n\n<!-- more -->\nIDLGISIDL\nIDLENVIIMAGISRiverTools2000IDL \nIDL\n\n## Envi\n1. envi\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlrt.exe -nodemowarn -novm \"E:\\ITT\\IDL64\\lib\\hook\\envi.sav\"\n\n1. idl\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe\n\n1. idl+envi\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe -minimized -noconfirmexit -nosplash @E:\\ITT\\IDL64\\products\\envi44\\bin\\envi.run\n \n## myEclipseIDL\nEnvi5.0 IDL8.2JSPIDLjardlltomcattomcatjdk libbinjspprojava\n \n\n1. myEclipse Java Web Projectjavaidlb.jar\n1. java jdk jre bin libidldlljar\n1. pathidl\\binidl\\bin\\bin.x86\n1. myEclipse Tomcatidl bin bin.x86 lib\n1. myEclipse Installed JreIDL\n1. Envi5\n\n\n## TM34GeoTiffNDVI\nNDVI![NDVI](http://i.weather.com.cn/images/henan/nyqx/ygjc/nyyg/2011/05/22/6731D1A3076F2F3187AF7FE47EE34B76.jpg)\n\n``` Fortran\nPRO TIFF_NDVI,F1,F2,FOUT \n    F1 = DIALOG_PICKFILE(TITLE = 'B4 TIFF',FILTER='*.TIF',/READ) \n    F2 = DIALOG_PICKFILE(TITLE = 'B3 TIFF',FILTER='*.TIF',/READ) \n    FOUT =DIALOG_PICKFILE(TITLE = 'RESULT PATH',FILTER='*.TIF',/WRITE) \n    \n    IF(FILE_TEST(F1) GT 0 AND FILE_TEST(F2) GT 0) THEN BEGIN \n        B1 = READ_TIFF(F1,GEOTIFF=GE1) \n        B2 = READ_TIFF(F2,GEOTIFF=GE2) \n        HELP,B1,B2 \n        C = 0.001 \n        WRITE_TIFF,FOUT,-1.0>( (FLOAT(B1)-FLOAT(B2))/(FLOAT(B1)+FLOAT(B2) + C) )<1.0,/FLOAT,GEOTIFF=GE2 \n        PRINT,'OK \n    ENDIF \nEND \n```\n\n## IDL PCA\nPrincipal components analysisPCAwiki\n\nPCAIDL\n\n``` fortran\nPro Pca,Data,Eigenvalues = Egvalues,Eigenvectors = Egvec,Percent = Percent,_Extra=Extra\n  Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type= Type\n  \n  If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin\n    Data = Transpose(Reform(Data,Ns*Nl,Nb))\n    Corr = Correlate(Data,/Covariance)\n    Egvalues = Eigenql( Corr, Eigenvectors=Egvec,/Double ,/Absolute)\n    Absegvalue = Abs(Egvalues)\n    Percent = Absegvalue / Total(Absegvalue);\n    ; Egvec Format\n    ;Egvec = [  Egvec1\n    ;           Egvec2\n    ;           Egvec3\n    ;           ...\n    \n    Data = Temporary(Reform(Transpose(Egvec) ## Transpose(Data),Ns,Nl,Nb))\n  Endif\nEnd\n;---------------------------------------\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n```\n\n## IDL EOF\nEOFwiki http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle\n\nPCAEOFEOF\n\nEOF\n\n``` fortran\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n\n\nPro Eofs,Data,Eof,Pcs\n  ;Svdc,Data(*,*),W,U,V,/Column\n  ;Eofs=Reform(U(*,*),Nlons,Nlats,Cutoff)\n  ;Pcs=V\n  ;Svls=W\n  Eof = -1\n  Pcs = -1\n  Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n  \n  If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin\n    Svdc,Data,W,U,V,/Column\n    Data = Transpose(Reform(Data,Ns*Nl,Nb))\n    Eof=Reform(U,Ns,Nl,Nb)\n    Pcs = V\n  Endif\nEnd\n```\n\n## IDL \n\n``` fortran\nPro Aspect_Slope,Dem,Aspect = Aspect,Slope=Slope,Pixelsize = Pixelsize\n  ;Ref To Doi:10.1016/J.Cageo.2003.07.005\n  Aspect = -1\n  Slope = -1\n  Pixelsize = [30.,30.]\n  Get_Sz,Dem,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n  If Isa(Dem,/Number) And Nb Eq 1 And Size(Dem,/N_Dimensions) Eq 2 Then Begin\n    K_X = Transpose([-1,1])\n    K_Y = [-1.0,1.0]\n    Dx = Convol(Dem,K_X,/Edge_Truncate,/Nan)/Pixelsize[1] ; Mei Cuo ,\n    Dy = Convol(Dem,K_Y,/Edge_Truncate,/Nan)/Pixelsize[0]\n    Pi = Acos(-1.0d)\n    Help,Dx,Dy\n    Slope = Atan( Sqrt(Dx*Dx + Dy * Dy)) * 180.0 / Pi\n    Aspect = 270 + Atan(Dy*1.0 /Dx) - 90.0 * Fix(Dx / Abs(Dx))\n  Endif\nEnd\n\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n```\n\n## IDL TVDI\n[ENVI(TVDI)](http://blog.sina.com.cn/s/blog_764b1e9d0100wdrr.html)\n\n1. n20050\n\n1. sortwherelinefitpolyxy,,\n\n``` fortran\nPro Tvdi,Ndvi,Lst,Nbins,Res\n  Res = -1\n  \n  Sz1 = Size(Ndvi,/Dimensions)\n  Sz2 = Size(Lst,/Dimensions)\n  If N_Elements(Sz1) Ne 2 Or N_Elements(Sz2) Ne 2 Then Return\n  If Total(Abs(Sz1 - Sz2)) Ne 0 Then Return\n  If ~Isa(Ndvi,/Number) And ~Isa(Lst,/Number) Then Return\n  \n  ;Find Dyr Wet Pts\n  Range = [0.0,1.0]\n  Npt_Filter = 200\n  Pts = 50\n  Dry_Pts = [0]\n  Wet_Pts = [0]\n  \n  Idx = Floor(Ndvi * Nbins)\n  For I = 0, Nbins Do Begin\n    Pt = Where(Idx Eq I,Cnt)\n    If(Cnt Gt Npt_Filter) Then Begin\n      Ii = Sort(Lst[Pt])\n      Dry_Pts = [ Dry_Pts,Pt[Ii[Indgen(Pts)]] ]\n      Wet_Pts = [ Wet_Pts,Pt[Ii[-Indgen(Pts)]] ]\n    Endif\n  End\n  \n  If N_Elements(Dry_Pts) Le 1 Then Return\n  \n  Dry_Pts = Dry_Pts[1:*]\n  Wet_Pts = Wet_Pts[1:*]\n  \n  Wet = Linfit(Ndvi[Wet_Pts],Lst[Wet_Pts])\n  Dry = Linfit(Ndvi[Dry_Pts],Lst[Dry_Pts])\n  \n  Good = Where(Ndvi Ge Range[0] And Ndvi Le Range[1],Cnt)\n  If Cnt Le 0 Then Return\n  \n  Res = Make_Array(Size = Size(Ndvi))\n  Res[Good] = (Lst - Poly(Ndvi[Good],Wet)) / (Poly(Ndvi[Good],Dry) - Poly(Ndvi[Good],Wet) )\n  \nEnd\n```\n\n## IDL\n\nGoogle Map TileJpg\n\n``` fortran\nPro Tsplit\n  ; jpeg\n  Szfile = 'E:\\Test.Jpg'; Dialog_Pickfile(Title = 'Input Data')\n  Read_Jpeg,Szfile,Image,True = 3\n  ; 5\n  Nlevel = 5;\n  ;\n  For Ilevel = 0,Nlevel-1 Do Begin\n      Split,Image,Ilevel,Ib\n  Endfor\n  Return\nEnd\n\nPro Split,Image,Level,Iband\n  Src = 'E:\\Src'\n  Ns0 = 512\n  Nl0 = 512\n  N0 = 2^Level\n  Sz = Size(Image,/Dimensions)\n  Help,Sz\n  Print,Sz\n  Nx = Sz[0]\n  Ny = Sz[1]\n  Xspan = Nx*1.0/N0;\n  Yspan = Ny*1.0/N0;\n  Imglet = Bytarr(Ns0,Nl0,3)\n\n  Fmt = '(%\"%S\\\\%D\\\\Img_%D_%D.Jpg\")';\n  For Is = 0l,N0-1 Do Begin\n      For Il = 0l,N0 -1 Do Begin\n          X = Indgen(Ns0)#Replicate(1,Nl0)*Xspan/Ns0 + Is*Xspan\n          Y = Replicate(1,Ns0)#Indgen(Nl0)*Yspan/Nl0 + Il*Yspan\n          For Ib = 0,2 Do Begin\n              Imglet[*,*,Ib] = Bilinear(Image[*,*,Ib],X,Y)\n          Endfor\n          Fileout = String(Src,Level,N0-Il-1,Is,Format =Fmt)\n          Dir = File_Dirname(Fileout)\n          If(File_Test(Dir,/Directory) Lt 1) Then File_Mkdir,Dir\n          Write_Jpeg,Fileout,Imglet,True = 3\n      Endfor\n  Endfor\nEnd\n\n; \nPro Pyrmid\n\n  Tsplit\n  Print,'Done\nEnd\n```\n\n## MODIS\n\nModismodiswistmailIDLmodisurl\n![](http://images.cnitblog.com/blog/583396/201311/18161902-2988572b59ca46cdabffb013ca0372a3.jpg)\nIDL7.05.0\n\n### \n1. Modisftp5txtTxt\n1. Modisftphdf\n1. IDLIDLnetUrlftpftphttpurl\n1. IDLIDLcomIDispatchcom /oleThunderAgent.Agentole\n\n### \n1. ) polygon\n1. ) 5txt5\n![](http://images.cnitblog.com/blog/583396/201311/20132851-03d184fa364745519d43217049bdfab3.gif)\n1. ) txt5polygon5url\n1. ) hdfurl\n\n### \n\n``` fortran\n;-----------------------------------------------------------------\n\nPro Modistest\n  Query_Download,2010,7,18,[110,110,117,117],[34,30,30,34],Productname='021km'\nEnd\n;-----------------------------------------------------------------\n\nPro Query_Download,Year,Month,Day,Xpoly,Ypoly,Productname=Productname\n\n  Get_Modis_Metafile,Year,Month,Day,Geometa1,Modlist,/Terra,Productname=Productname\n  Query_Modis,Geometa1,Modlist,Xpoly,Ypoly\n  \n  Get_Modis_Metafile,Year,Month,Day,Geometa2,Mydlist,/Aqua,Productname=Productname\n  Query_Modis,Geometa2,Mydlist,Xpoly,Ypoly\n  \n  If Size(Modlist,/Type) Eq 7 Then L = [Modlist]\n  If Size(Mydlist,/Type) Eq 7 Then L = [L,Mydlist]  \n  If N_Elements(L) Gt 0 Then Add_Download,L\n  \nEnd\n;-----------------------------------------------------------------\n\nPro Query_Modis,Data,Filelist,Xpoly,Ypoly\n  \n  Flist =Filelist\n  Filelist = -1\n  If Size(Data,/Type) Ne 7 Or Size(Flist,/Type) Ne 7 Or N_Elements(Xpoly) Ne N_Elements(Ypoly) Then Return\n  \n  G = {Geometa,G_Id:'',Starttime:'',Set:0b,Orbit_Number:1l,Daynight:0b,Box:Dindgen(4),X:Dindgen(4),Y:Dindgen(4)}\n  Meta = [G]\n  \n  For I = 3,N_Elements(Data)-1 Do Begin\n    If N_Elements(Data) Le 3 Then Return;\n    \n    Tmp = Strsplit(Data[I],\",\",/Extract)\n    If N_Elements(Tmp) Eq 17 Then Begin    \n      G.G_Id = (Strsplit(Tmp[0],'.',/Extract))[2]\n      G.Starttime = Tmp[1]\n      G.Set = Tmp[2]\n      G.Orbit_Number = Tmp[3]\n      G.Daynight = Byte(Tmp[4])\n      G.Box = Tmp[5:8]\n      G.X = Tmp[9:12]\n      G.Y = Tmp[13:16]\n      Meta = [Meta,G]\n    Endif\n  Endfor\n  \n  If N_Elements(Meta) Gt 1 Then Meta = Meta[1:*] Else Return\n \n  Idx = Intarr(480);    \n  I = Fix(Strmid(File_Basename(Flist),18,4))/5\n  Idx[I] = Indgen(N_Elements(I))\n \n  Ret = ['']\n  For I = 0,N_Elements(Meta)-1 Do Begin\n    Id = Idx[Fix(Meta[I].G_Id)/5]\n    ;\n    ;\n    If (Max(Meta[I].X) - Min(Meta[I].X)) Gt 300 Then Continue      \n    ;\n    If Total(Inside(Xpoly,Ypoly,Meta[I].X,Meta[I].Y)) Gt 0 $\n      And  Meta[I].Daynight Lt Byte('N') $\n      And  Id Gt 0  Then Ret = [Ret,Flist[Id]]      \n  Endfor\n  \n  Filelist = N_Elements(Ret) Gt 1 ? Ret[1:*] : -1\n \nEnd\n;-----------------------------------------------------------------\n\nPro Get_Modis_Metafile,Year,Month,Day,Geometa,Flist,Terra=Terra,Aqua=Aqua,Productname=Productname\n  Geometa = -1\n  Flist = -1;\n  \n  Catch, Errorstatus\n  If (Errorstatus Ne 0) Then Begin\n    Catch, /Cancel\n    R = Dialog_Message(!Error_State.Msg, Title='Url Error', $\n      /Error)\n    Print, !Error_State.Msg\n    Return\n  Endif\n    \n  Case 1 Of\n    Keyword_Set(Terra):Begin\n      Prefix = 'Mod'\n      Satellite = 'Terra'      \n      Break\n    End\n    Keyword_Set(Aqua):Begin\n      Prefix = 'Myd'\n      Satellite = 'Aqua'     \n      Break\n    End\n    Else:Return   \n  Endcase\n  Productname = Keyword_Set(Productname) ? Productname : '021km'\n  \n  Site = 'Ftp://Ladsweb.Nascom.Nasa.Gov'\n  Jday = Julday(Month,Day,Year,0,0,0) - Julday(1,1,Year,0,0,0)\n  Format = '(\"Geometa/6/'+Satellite+'/\",I4,\"/\",\"'+Prefix+'03_\",I4,\"-\",I02,\"-\",I02,\".Txt\")\n  Dir_Fmt = '(\"/Alldata/5/\",\"'+Prefix+Productname+'/\",I4,\"/\",I03,\"/\")'\n  \n  Url = String([Year,Year,Month,Day],Format=Format)\n  Dir = Site+ String([Year,Jday],Format = Dir_Fmt)       \n      \n  ; Create A New Url Object\n  Ourl = Obj_New('Idlneturl',$\n    Callback_Function ='Ddcall',$\n    Url_Scheme = 'Ftp',$\n    Url_Host = 'Ladsweb.Nascom.Nasa.Gov',$\n    Url_Path = Url,$\n    Url_Username = 'Anonymous',$\n    Url_Password = '',$\n    Ftp_Connection_Mode = 0)\n  \n  \n  Geometa = Ourl->Get( /String_Array ) \n  Flist = Dir + Ourl->Getftpdirlist(Url=Dir,/Short)  \n  \n  Ourl->Closeconnections  \n  Obj_Destroy, Ourl\n\nEnd\n;-----------------------------------------------------------------\n\nFunction Ddcall, Status, Progress, Data\n  Print, Status\n  Return, 1\nEnd\n;-----------------------------------------------------------------\n\nPro Add_Download,Url\n\n  Othunder = Obj_New('Idlcomidispatch$Progid$Thunderagent_Agent');\n  \n  If Obj_Valid(Othunder) Then Begin\n    For I = 0,N_Elements(Url)-1 Do Othunder->Addtask,Url[I],\"\",\"\",\"\",\"\",1,0,5\n    Othunder->Committasks,1\n    Obj_Destroy ,Othunder\n  Endif\nEnd\n;-----------------------------------------------------------------\n\nFunction Inside, X, Y, Xpts, Ypts, Index=Index\n\n    On_Error, 1\n\n    Sx = Size(Xpts)\n    Sy = Size(Ypts)\n    If (Sx[0] Eq 1) Then Nx=Sx[1] Else Message, 'X Coordinates Of Polygon Not A Vector.'\n    If (Sy[0] Eq 1) Then Ny=Sy[1] Else Message, 'Y Coordinates Of Polygon Not A Vector.'\n    If (Nx Eq Ny) Then N = Nx Else Message, 'Incompatable Vector Dimensions.'\n\n    ; Close The Polygon.\n    Tmp_Xpts = [Xpts, Xpts[0]]\n    Tmp_Ypts = [Ypts, Ypts[0]]\n\n    ; Set Up Counters.\n    I = Indgen(N)\n    Ip = Indgen(N)+1\n\n    Nn = N_Elements(X)\n    X1 = Tmp_Xpts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)\n    Y1 = Tmp_Ypts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)\n    X2 = Tmp_Xpts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)\n    Y2 = Tmp_Ypts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)\n\n    Dp = X1*X2 + Y1*Y2 ; Dot-Product\n    Cp = X1*Y2 - Y1*X2 ; Cross-Product\n    Theta = Atan(Cp,Dp)\n\n    Ret = Replicate(0l, N_Elements(X))\n    I = Where(Abs(Total(Theta,1)) Gt 0.01, Count)\n    If (Count Gt 0) Then Ret(I)=1\n\n    ; Make This A Scalar Value If There Is Only One Value.\n    If (N_Elements(Ret) Eq 1) Then Ret=Ret[0]\n\n    ; If The Index Keyword Is Set, Then Return Indices.\n    If (Arg_Present(Index)) Then Ret=(Indgen(/Long, N_Elements(X)))(Where(Ret Eq 1))\n\n    Return, Ret\n\nEnd\n```","source":"_posts/IDL.md","raw":"---\ntitle: IDL\ndate: 2017-06-04 20:24:36\ntags: [IDL,Remote Sensing]\ncategories: Develop\n---\n\n## \nIDL\n\n## IDL\n\n1. IDLSolving Real Problems with Computer Graphicsppt\n1. IDLIDLpptcode\n\n<!-- more -->\nIDLGISIDL\nIDLENVIIMAGISRiverTools2000IDL \nIDL\n\n## Envi\n1. envi\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlrt.exe -nodemowarn -novm \"E:\\ITT\\IDL64\\lib\\hook\\envi.sav\"\n\n1. idl\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe\n\n1. idl+envi\n> E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe -minimized -noconfirmexit -nosplash @E:\\ITT\\IDL64\\products\\envi44\\bin\\envi.run\n \n## myEclipseIDL\nEnvi5.0 IDL8.2JSPIDLjardlltomcattomcatjdk libbinjspprojava\n \n\n1. myEclipse Java Web Projectjavaidlb.jar\n1. java jdk jre bin libidldlljar\n1. pathidl\\binidl\\bin\\bin.x86\n1. myEclipse Tomcatidl bin bin.x86 lib\n1. myEclipse Installed JreIDL\n1. Envi5\n\n\n## TM34GeoTiffNDVI\nNDVI![NDVI](http://i.weather.com.cn/images/henan/nyqx/ygjc/nyyg/2011/05/22/6731D1A3076F2F3187AF7FE47EE34B76.jpg)\n\n``` Fortran\nPRO TIFF_NDVI,F1,F2,FOUT \n    F1 = DIALOG_PICKFILE(TITLE = 'B4 TIFF',FILTER='*.TIF',/READ) \n    F2 = DIALOG_PICKFILE(TITLE = 'B3 TIFF',FILTER='*.TIF',/READ) \n    FOUT =DIALOG_PICKFILE(TITLE = 'RESULT PATH',FILTER='*.TIF',/WRITE) \n    \n    IF(FILE_TEST(F1) GT 0 AND FILE_TEST(F2) GT 0) THEN BEGIN \n        B1 = READ_TIFF(F1,GEOTIFF=GE1) \n        B2 = READ_TIFF(F2,GEOTIFF=GE2) \n        HELP,B1,B2 \n        C = 0.001 \n        WRITE_TIFF,FOUT,-1.0>( (FLOAT(B1)-FLOAT(B2))/(FLOAT(B1)+FLOAT(B2) + C) )<1.0,/FLOAT,GEOTIFF=GE2 \n        PRINT,'OK \n    ENDIF \nEND \n```\n\n## IDL PCA\nPrincipal components analysisPCAwiki\n\nPCAIDL\n\n``` fortran\nPro Pca,Data,Eigenvalues = Egvalues,Eigenvectors = Egvec,Percent = Percent,_Extra=Extra\n  Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type= Type\n  \n  If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin\n    Data = Transpose(Reform(Data,Ns*Nl,Nb))\n    Corr = Correlate(Data,/Covariance)\n    Egvalues = Eigenql( Corr, Eigenvectors=Egvec,/Double ,/Absolute)\n    Absegvalue = Abs(Egvalues)\n    Percent = Absegvalue / Total(Absegvalue);\n    ; Egvec Format\n    ;Egvec = [  Egvec1\n    ;           Egvec2\n    ;           Egvec3\n    ;           ...\n    \n    Data = Temporary(Reform(Transpose(Egvec) ## Transpose(Data),Ns,Nl,Nb))\n  Endif\nEnd\n;---------------------------------------\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n```\n\n## IDL EOF\nEOFwiki http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle\n\nPCAEOFEOF\n\nEOF\n\n``` fortran\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n\n\nPro Eofs,Data,Eof,Pcs\n  ;Svdc,Data(*,*),W,U,V,/Column\n  ;Eofs=Reform(U(*,*),Nlons,Nlats,Cutoff)\n  ;Pcs=V\n  ;Svls=W\n  Eof = -1\n  Pcs = -1\n  Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n  \n  If Isa(Data,/Number) And Nb Gt 1 And Size(Data,/N_Dimensions) Eq 3 Then Begin\n    Svdc,Data,W,U,V,/Column\n    Data = Transpose(Reform(Data,Ns*Nl,Nb))\n    Eof=Reform(U,Ns,Nl,Nb)\n    Pcs = V\n  Endif\nEnd\n```\n\n## IDL \n\n``` fortran\nPro Aspect_Slope,Dem,Aspect = Aspect,Slope=Slope,Pixelsize = Pixelsize\n  ;Ref To Doi:10.1016/J.Cageo.2003.07.005\n  Aspect = -1\n  Slope = -1\n  Pixelsize = [30.,30.]\n  Get_Sz,Dem,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n  If Isa(Dem,/Number) And Nb Eq 1 And Size(Dem,/N_Dimensions) Eq 2 Then Begin\n    K_X = Transpose([-1,1])\n    K_Y = [-1.0,1.0]\n    Dx = Convol(Dem,K_X,/Edge_Truncate,/Nan)/Pixelsize[1] ; Mei Cuo ,\n    Dy = Convol(Dem,K_Y,/Edge_Truncate,/Nan)/Pixelsize[0]\n    Pi = Acos(-1.0d)\n    Help,Dx,Dy\n    Slope = Atan( Sqrt(Dx*Dx + Dy * Dy)) * 180.0 / Pi\n    Aspect = 270 + Atan(Dy*1.0 /Dx) - 90.0 * Fix(Dx / Abs(Dx))\n  Endif\nEnd\n\nPro Get_Sz,Data,Ns=Ns,Nl=Nl,Nb=Nb,Type = Type\n\n  Sz = Size(Data)\n  \n  Type = Sz[0] Ge 1 ? Sz[-2] : 0\n  Ns = Sz[0] Ge 1 ? Sz[1] : 1\n  Nl = Sz[0] Ge 2 ? Sz[2] : 1\n  Nb = Sz[0] Ge 3 ? Sz[3] : 1\n  \nEnd\n```\n\n## IDL TVDI\n[ENVI(TVDI)](http://blog.sina.com.cn/s/blog_764b1e9d0100wdrr.html)\n\n1. n20050\n\n1. sortwherelinefitpolyxy,,\n\n``` fortran\nPro Tvdi,Ndvi,Lst,Nbins,Res\n  Res = -1\n  \n  Sz1 = Size(Ndvi,/Dimensions)\n  Sz2 = Size(Lst,/Dimensions)\n  If N_Elements(Sz1) Ne 2 Or N_Elements(Sz2) Ne 2 Then Return\n  If Total(Abs(Sz1 - Sz2)) Ne 0 Then Return\n  If ~Isa(Ndvi,/Number) And ~Isa(Lst,/Number) Then Return\n  \n  ;Find Dyr Wet Pts\n  Range = [0.0,1.0]\n  Npt_Filter = 200\n  Pts = 50\n  Dry_Pts = [0]\n  Wet_Pts = [0]\n  \n  Idx = Floor(Ndvi * Nbins)\n  For I = 0, Nbins Do Begin\n    Pt = Where(Idx Eq I,Cnt)\n    If(Cnt Gt Npt_Filter) Then Begin\n      Ii = Sort(Lst[Pt])\n      Dry_Pts = [ Dry_Pts,Pt[Ii[Indgen(Pts)]] ]\n      Wet_Pts = [ Wet_Pts,Pt[Ii[-Indgen(Pts)]] ]\n    Endif\n  End\n  \n  If N_Elements(Dry_Pts) Le 1 Then Return\n  \n  Dry_Pts = Dry_Pts[1:*]\n  Wet_Pts = Wet_Pts[1:*]\n  \n  Wet = Linfit(Ndvi[Wet_Pts],Lst[Wet_Pts])\n  Dry = Linfit(Ndvi[Dry_Pts],Lst[Dry_Pts])\n  \n  Good = Where(Ndvi Ge Range[0] And Ndvi Le Range[1],Cnt)\n  If Cnt Le 0 Then Return\n  \n  Res = Make_Array(Size = Size(Ndvi))\n  Res[Good] = (Lst - Poly(Ndvi[Good],Wet)) / (Poly(Ndvi[Good],Dry) - Poly(Ndvi[Good],Wet) )\n  \nEnd\n```\n\n## IDL\n\nGoogle Map TileJpg\n\n``` fortran\nPro Tsplit\n  ; jpeg\n  Szfile = 'E:\\Test.Jpg'; Dialog_Pickfile(Title = 'Input Data')\n  Read_Jpeg,Szfile,Image,True = 3\n  ; 5\n  Nlevel = 5;\n  ;\n  For Ilevel = 0,Nlevel-1 Do Begin\n      Split,Image,Ilevel,Ib\n  Endfor\n  Return\nEnd\n\nPro Split,Image,Level,Iband\n  Src = 'E:\\Src'\n  Ns0 = 512\n  Nl0 = 512\n  N0 = 2^Level\n  Sz = Size(Image,/Dimensions)\n  Help,Sz\n  Print,Sz\n  Nx = Sz[0]\n  Ny = Sz[1]\n  Xspan = Nx*1.0/N0;\n  Yspan = Ny*1.0/N0;\n  Imglet = Bytarr(Ns0,Nl0,3)\n\n  Fmt = '(%\"%S\\\\%D\\\\Img_%D_%D.Jpg\")';\n  For Is = 0l,N0-1 Do Begin\n      For Il = 0l,N0 -1 Do Begin\n          X = Indgen(Ns0)#Replicate(1,Nl0)*Xspan/Ns0 + Is*Xspan\n          Y = Replicate(1,Ns0)#Indgen(Nl0)*Yspan/Nl0 + Il*Yspan\n          For Ib = 0,2 Do Begin\n              Imglet[*,*,Ib] = Bilinear(Image[*,*,Ib],X,Y)\n          Endfor\n          Fileout = String(Src,Level,N0-Il-1,Is,Format =Fmt)\n          Dir = File_Dirname(Fileout)\n          If(File_Test(Dir,/Directory) Lt 1) Then File_Mkdir,Dir\n          Write_Jpeg,Fileout,Imglet,True = 3\n      Endfor\n  Endfor\nEnd\n\n; \nPro Pyrmid\n\n  Tsplit\n  Print,'Done\nEnd\n```\n\n## MODIS\n\nModismodiswistmailIDLmodisurl\n![](http://images.cnitblog.com/blog/583396/201311/18161902-2988572b59ca46cdabffb013ca0372a3.jpg)\nIDL7.05.0\n\n### \n1. Modisftp5txtTxt\n1. Modisftphdf\n1. IDLIDLnetUrlftpftphttpurl\n1. IDLIDLcomIDispatchcom /oleThunderAgent.Agentole\n\n### \n1. ) polygon\n1. ) 5txt5\n![](http://images.cnitblog.com/blog/583396/201311/20132851-03d184fa364745519d43217049bdfab3.gif)\n1. ) txt5polygon5url\n1. ) hdfurl\n\n### \n\n``` fortran\n;-----------------------------------------------------------------\n\nPro Modistest\n  Query_Download,2010,7,18,[110,110,117,117],[34,30,30,34],Productname='021km'\nEnd\n;-----------------------------------------------------------------\n\nPro Query_Download,Year,Month,Day,Xpoly,Ypoly,Productname=Productname\n\n  Get_Modis_Metafile,Year,Month,Day,Geometa1,Modlist,/Terra,Productname=Productname\n  Query_Modis,Geometa1,Modlist,Xpoly,Ypoly\n  \n  Get_Modis_Metafile,Year,Month,Day,Geometa2,Mydlist,/Aqua,Productname=Productname\n  Query_Modis,Geometa2,Mydlist,Xpoly,Ypoly\n  \n  If Size(Modlist,/Type) Eq 7 Then L = [Modlist]\n  If Size(Mydlist,/Type) Eq 7 Then L = [L,Mydlist]  \n  If N_Elements(L) Gt 0 Then Add_Download,L\n  \nEnd\n;-----------------------------------------------------------------\n\nPro Query_Modis,Data,Filelist,Xpoly,Ypoly\n  \n  Flist =Filelist\n  Filelist = -1\n  If Size(Data,/Type) Ne 7 Or Size(Flist,/Type) Ne 7 Or N_Elements(Xpoly) Ne N_Elements(Ypoly) Then Return\n  \n  G = {Geometa,G_Id:'',Starttime:'',Set:0b,Orbit_Number:1l,Daynight:0b,Box:Dindgen(4),X:Dindgen(4),Y:Dindgen(4)}\n  Meta = [G]\n  \n  For I = 3,N_Elements(Data)-1 Do Begin\n    If N_Elements(Data) Le 3 Then Return;\n    \n    Tmp = Strsplit(Data[I],\",\",/Extract)\n    If N_Elements(Tmp) Eq 17 Then Begin    \n      G.G_Id = (Strsplit(Tmp[0],'.',/Extract))[2]\n      G.Starttime = Tmp[1]\n      G.Set = Tmp[2]\n      G.Orbit_Number = Tmp[3]\n      G.Daynight = Byte(Tmp[4])\n      G.Box = Tmp[5:8]\n      G.X = Tmp[9:12]\n      G.Y = Tmp[13:16]\n      Meta = [Meta,G]\n    Endif\n  Endfor\n  \n  If N_Elements(Meta) Gt 1 Then Meta = Meta[1:*] Else Return\n \n  Idx = Intarr(480);    \n  I = Fix(Strmid(File_Basename(Flist),18,4))/5\n  Idx[I] = Indgen(N_Elements(I))\n \n  Ret = ['']\n  For I = 0,N_Elements(Meta)-1 Do Begin\n    Id = Idx[Fix(Meta[I].G_Id)/5]\n    ;\n    ;\n    If (Max(Meta[I].X) - Min(Meta[I].X)) Gt 300 Then Continue      \n    ;\n    If Total(Inside(Xpoly,Ypoly,Meta[I].X,Meta[I].Y)) Gt 0 $\n      And  Meta[I].Daynight Lt Byte('N') $\n      And  Id Gt 0  Then Ret = [Ret,Flist[Id]]      \n  Endfor\n  \n  Filelist = N_Elements(Ret) Gt 1 ? Ret[1:*] : -1\n \nEnd\n;-----------------------------------------------------------------\n\nPro Get_Modis_Metafile,Year,Month,Day,Geometa,Flist,Terra=Terra,Aqua=Aqua,Productname=Productname\n  Geometa = -1\n  Flist = -1;\n  \n  Catch, Errorstatus\n  If (Errorstatus Ne 0) Then Begin\n    Catch, /Cancel\n    R = Dialog_Message(!Error_State.Msg, Title='Url Error', $\n      /Error)\n    Print, !Error_State.Msg\n    Return\n  Endif\n    \n  Case 1 Of\n    Keyword_Set(Terra):Begin\n      Prefix = 'Mod'\n      Satellite = 'Terra'      \n      Break\n    End\n    Keyword_Set(Aqua):Begin\n      Prefix = 'Myd'\n      Satellite = 'Aqua'     \n      Break\n    End\n    Else:Return   \n  Endcase\n  Productname = Keyword_Set(Productname) ? Productname : '021km'\n  \n  Site = 'Ftp://Ladsweb.Nascom.Nasa.Gov'\n  Jday = Julday(Month,Day,Year,0,0,0) - Julday(1,1,Year,0,0,0)\n  Format = '(\"Geometa/6/'+Satellite+'/\",I4,\"/\",\"'+Prefix+'03_\",I4,\"-\",I02,\"-\",I02,\".Txt\")\n  Dir_Fmt = '(\"/Alldata/5/\",\"'+Prefix+Productname+'/\",I4,\"/\",I03,\"/\")'\n  \n  Url = String([Year,Year,Month,Day],Format=Format)\n  Dir = Site+ String([Year,Jday],Format = Dir_Fmt)       \n      \n  ; Create A New Url Object\n  Ourl = Obj_New('Idlneturl',$\n    Callback_Function ='Ddcall',$\n    Url_Scheme = 'Ftp',$\n    Url_Host = 'Ladsweb.Nascom.Nasa.Gov',$\n    Url_Path = Url,$\n    Url_Username = 'Anonymous',$\n    Url_Password = '',$\n    Ftp_Connection_Mode = 0)\n  \n  \n  Geometa = Ourl->Get( /String_Array ) \n  Flist = Dir + Ourl->Getftpdirlist(Url=Dir,/Short)  \n  \n  Ourl->Closeconnections  \n  Obj_Destroy, Ourl\n\nEnd\n;-----------------------------------------------------------------\n\nFunction Ddcall, Status, Progress, Data\n  Print, Status\n  Return, 1\nEnd\n;-----------------------------------------------------------------\n\nPro Add_Download,Url\n\n  Othunder = Obj_New('Idlcomidispatch$Progid$Thunderagent_Agent');\n  \n  If Obj_Valid(Othunder) Then Begin\n    For I = 0,N_Elements(Url)-1 Do Othunder->Addtask,Url[I],\"\",\"\",\"\",\"\",1,0,5\n    Othunder->Committasks,1\n    Obj_Destroy ,Othunder\n  Endif\nEnd\n;-----------------------------------------------------------------\n\nFunction Inside, X, Y, Xpts, Ypts, Index=Index\n\n    On_Error, 1\n\n    Sx = Size(Xpts)\n    Sy = Size(Ypts)\n    If (Sx[0] Eq 1) Then Nx=Sx[1] Else Message, 'X Coordinates Of Polygon Not A Vector.'\n    If (Sy[0] Eq 1) Then Ny=Sy[1] Else Message, 'Y Coordinates Of Polygon Not A Vector.'\n    If (Nx Eq Ny) Then N = Nx Else Message, 'Incompatable Vector Dimensions.'\n\n    ; Close The Polygon.\n    Tmp_Xpts = [Xpts, Xpts[0]]\n    Tmp_Ypts = [Ypts, Ypts[0]]\n\n    ; Set Up Counters.\n    I = Indgen(N)\n    Ip = Indgen(N)+1\n\n    Nn = N_Elements(X)\n    X1 = Tmp_Xpts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)\n    Y1 = Tmp_Ypts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)\n    X2 = Tmp_Xpts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)\n    Y2 = Tmp_Ypts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)\n\n    Dp = X1*X2 + Y1*Y2 ; Dot-Product\n    Cp = X1*Y2 - Y1*X2 ; Cross-Product\n    Theta = Atan(Cp,Dp)\n\n    Ret = Replicate(0l, N_Elements(X))\n    I = Where(Abs(Total(Theta,1)) Gt 0.01, Count)\n    If (Count Gt 0) Then Ret(I)=1\n\n    ; Make This A Scalar Value If There Is Only One Value.\n    If (N_Elements(Ret) Eq 1) Then Ret=Ret[0]\n\n    ; If The Index Keyword Is Set, Then Return Indices.\n    If (Arg_Present(Index)) Then Ret=(Indgen(/Long, N_Elements(X)))(Where(Ret Eq 1))\n\n    Return, Ret\n\nEnd\n```","slug":"IDL","published":1,"updated":"2017-06-09T14:14:49.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58stt60003zsr4akkzk1ug","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IDL</p>\n<h2 id=\"IDL\"><a href=\"#IDL\" class=\"headerlink\" title=\"IDL\"></a>IDL</h2><ol>\n<li>IDLSolving Real Problems with Computer Graphicsppt</li>\n<li>IDLIDLpptcode</li>\n</ol>\n<a id=\"more\"></a>\n<p>IDLGISIDL<br>IDLENVIIMAGISRiverTools2000IDL<br>IDL</p>\n<h2 id=\"Envi\"><a href=\"#Envi\" class=\"headerlink\" title=\"Envi\"></a>Envi</h2><ol>\n<li><p>envi</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlrt.exe -nodemowarn -novm E:\\ITT\\IDL64\\lib\\hook\\envi.sav</p>\n</blockquote>\n</li>\n<li><p>idl</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe</p>\n</blockquote>\n</li>\n<li><p>idl+envi</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe -minimized -noconfirmexit -nosplash @E:\\ITT\\IDL64\\products\\envi44\\bin\\envi.run</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"myEclipseIDL\"><a href=\"#myEclipseIDL\" class=\"headerlink\" title=\"myEclipseIDL\"></a>myEclipseIDL</h2><p>Envi5.0 IDL8.2JSPIDLjardlltomcattomcatjdk libbinjspprojava</p>\n<p></p>\n<ol>\n<li>myEclipse Java Web Projectjavaidlb.jar</li>\n<li>java jdk jre bin libidldlljar</li>\n<li>pathidl\\binidl\\bin\\bin.x86</li>\n<li>myEclipse Tomcatidl bin bin.x86 lib</li>\n<li>myEclipse Installed JreIDL</li>\n<li>Envi5</li>\n</ol>\n<h2 id=\"TM34GeoTiffNDVI\"><a href=\"#TM34GeoTiffNDVI\" class=\"headerlink\" title=\"TM34GeoTiffNDVI\"></a>TM34GeoTiffNDVI</h2><p>NDVI<img src=\"http://i.weather.com.cn/images/henan/nyqx/ygjc/nyyg/2011/05/22/6731D1A3076F2F3187AF7FE47EE34B76.jpg\" alt=\"NDVI\"></p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PRO TIFF_NDVI,F1,F2,FOUT </span><br><span class=\"line\">    F1 = DIALOG_PICKFILE(TITLE = <span class=\"string\">'B4 TIFF'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/READ) </span><br><span class=\"line\">    F2 = DIALOG_PICKFILE(TITLE = <span class=\"string\">'B3 TIFF'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/READ) </span><br><span class=\"line\">    FOUT =DIALOG_PICKFILE(TITLE = <span class=\"string\">'RESULT PATH'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/<span class=\"built_in\">WRITE</span>) </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">IF</span>(FILE_TEST(F1) GT <span class=\"number\">0</span> AND FILE_TEST(F2) GT <span class=\"number\">0</span>) <span class=\"keyword\">THEN</span> BEGIN </span><br><span class=\"line\">        B1 = READ_TIFF(F1,GEOTIFF=GE1) </span><br><span class=\"line\">        B2 = READ_TIFF(F2,GEOTIFF=GE2) </span><br><span class=\"line\">        HELP,B1,B2 </span><br><span class=\"line\">        C = <span class=\"number\">0.001</span> </span><br><span class=\"line\">        WRITE_TIFF,FOUT,-<span class=\"number\">1.0</span>&gt;( (<span class=\"built_in\">FLOAT</span>(B1)-<span class=\"built_in\">FLOAT</span>(B2))/(<span class=\"built_in\">FLOAT</span>(B1)+<span class=\"built_in\">FLOAT</span>(B2) + C) )&lt;<span class=\"number\">1.0</span>,/<span class=\"built_in\">FLOAT</span>,GEOTIFF=GE2 </span><br><span class=\"line\">        <span class=\"built_in\">PRINT</span>,<span class=\"string\">'OK </span></span><br><span class=\"line\"><span class=\"string\">    ENDIF </span></span><br><span class=\"line\"><span class=\"string\">END</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-PCA\"><a href=\"#IDL-PCA\" class=\"headerlink\" title=\"IDL PCA\"></a>IDL PCA</h2><p>Principal components analysisPCAwiki</p>\n<p>PCAIDL</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Pca,<span class=\"keyword\">Data</span>,Eigenvalues = Egvalues,Eigenvectors = Egvec,Percent = Percent,_Extra=Extra</span><br><span class=\"line\">  Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span>= <span class=\"keyword\">Type</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Number</span>) And Nb Gt <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/N_Dimensions) Eq <span class=\"number\">3</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = <span class=\"built_in\">Transpose</span>(Reform(<span class=\"keyword\">Data</span>,Ns*Nl,Nb))</span><br><span class=\"line\">    Corr = Correlate(<span class=\"keyword\">Data</span>,/Covariance)</span><br><span class=\"line\">    Egvalues = Eigenql( Corr, Eigenvectors=Egvec,/<span class=\"keyword\">Double</span> ,/Absolute)</span><br><span class=\"line\">    Absegvalue = <span class=\"built_in\">Abs</span>(Egvalues)</span><br><span class=\"line\">    Percent = Absegvalue / Total(Absegvalue);</span><br><span class=\"line\">    ; Egvec <span class=\"keyword\">Format</span></span><br><span class=\"line\">    ;Egvec = [  Egvec1</span><br><span class=\"line\">    ;           Egvec2</span><br><span class=\"line\">    ;           Egvec3</span><br><span class=\"line\">    ;           ...</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = Temporary(Reform(<span class=\"built_in\">Transpose</span>(Egvec) ## <span class=\"built_in\">Transpose</span>(<span class=\"keyword\">Data</span>),Ns,Nl,Nb))</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;---------------------------------------</span><br><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-EOF\"><a href=\"#IDL-EOF\" class=\"headerlink\" title=\"IDL EOF\"></a>IDL EOF</h2><p>EOFwiki <a href=\"http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle\" target=\"_blank\" rel=\"noopener\">http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle</a></p>\n<p>PCAEOFEOF</p>\n<p>EOF</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Eofs,<span class=\"keyword\">Data</span>,Eof,Pcs</span><br><span class=\"line\">  ;Svdc,<span class=\"keyword\">Data</span>(*,*),W,U,V,/Column</span><br><span class=\"line\">  ;Eofs=Reform(U(*,*),Nlons,Nlats,Cutoff)</span><br><span class=\"line\">  ;Pcs=V</span><br><span class=\"line\">  ;Svls=W</span><br><span class=\"line\">  Eof = -<span class=\"number\">1</span></span><br><span class=\"line\">  Pcs = -<span class=\"number\">1</span></span><br><span class=\"line\">  Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Number</span>) And Nb Gt <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/N_Dimensions) Eq <span class=\"number\">3</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    Svdc,<span class=\"keyword\">Data</span>,W,U,V,/Column</span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = <span class=\"built_in\">Transpose</span>(Reform(<span class=\"keyword\">Data</span>,Ns*Nl,Nb))</span><br><span class=\"line\">    Eof=Reform(U,Ns,Nl,Nb)</span><br><span class=\"line\">    Pcs = V</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-\"><a href=\"#IDL-\" class=\"headerlink\" title=\"IDL \"></a>IDL </h2><figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Aspect_Slope,Dem,Aspect = Aspect,Slope=Slope,Pixelsize = Pixelsize</span><br><span class=\"line\">  ;Ref To Doi:<span class=\"number\">10.1016</span>/J.Cageo<span class=\"number\">.2003.</span><span class=\"number\">07.005</span></span><br><span class=\"line\">  Aspect = -<span class=\"number\">1</span></span><br><span class=\"line\">  Slope = -<span class=\"number\">1</span></span><br><span class=\"line\">  Pixelsize = [<span class=\"number\">30.</span>,<span class=\"number\">30.</span>]</span><br><span class=\"line\">  Get_Sz,Dem,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(Dem,/<span class=\"keyword\">Number</span>) And Nb Eq <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(Dem,/N_Dimensions) Eq <span class=\"number\">2</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    K_X = <span class=\"built_in\">Transpose</span>([-<span class=\"number\">1</span>,<span class=\"number\">1</span>])</span><br><span class=\"line\">    K_Y = [-<span class=\"number\">1.0</span>,<span class=\"number\">1.0</span>]</span><br><span class=\"line\">    Dx = Convol(Dem,K_X,/Edge_Truncate,/Nan)/Pixelsize[<span class=\"number\">1</span>] ; Mei Cuo ,</span><br><span class=\"line\">    Dy = Convol(Dem,K_Y,/Edge_Truncate,/Nan)/Pixelsize[<span class=\"number\">0</span>]</span><br><span class=\"line\">    Pi = <span class=\"built_in\">Acos</span>(-<span class=\"number\">1.</span>d)</span><br><span class=\"line\">    Help,Dx,Dy</span><br><span class=\"line\">    Slope = <span class=\"built_in\">Atan</span>( <span class=\"built_in\">Sqrt</span>(Dx*Dx + Dy * Dy)) * <span class=\"number\">180.0</span> / Pi</span><br><span class=\"line\">    Aspect = <span class=\"number\">270</span> + <span class=\"built_in\">Atan</span>(Dy*<span class=\"number\">1.0</span> /Dx) - <span class=\"number\">90.0</span> * Fix(Dx / <span class=\"built_in\">Abs</span>(Dx))</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-TVDI\"><a href=\"#IDL-TVDI\" class=\"headerlink\" title=\"IDL TVDI\"></a>IDL TVDI</h2><p><a href=\"http://blog.sina.com.cn/s/blog_764b1e9d0100wdrr.html\" target=\"_blank\" rel=\"noopener\">ENVI(TVDI)</a></p>\n<ol>\n<li><p>n20050</p>\n</li>\n<li><p>sortwherelinefitpolyxy,,</p>\n</li>\n</ol>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Tvdi,Ndvi,Lst,Nbins,Res</span><br><span class=\"line\">  Res = -<span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Sz1 = <span class=\"built_in\">Size</span>(Ndvi,/Dimensions)</span><br><span class=\"line\">  Sz2 = <span class=\"built_in\">Size</span>(Lst,/Dimensions)</span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Sz1) Ne <span class=\"number\">2</span> Or N_Elements(Sz2) Ne <span class=\"number\">2</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> Total(<span class=\"built_in\">Abs</span>(Sz1 - Sz2)) Ne <span class=\"number\">0</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> ~Isa(Ndvi,/<span class=\"keyword\">Number</span>) And ~Isa(Lst,/<span class=\"keyword\">Number</span>) <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  ;Find Dyr Wet Pts</span><br><span class=\"line\">  <span class=\"built_in\">Range</span> = [<span class=\"number\">0.0</span>,<span class=\"number\">1.0</span>]</span><br><span class=\"line\">  Npt_Filter = <span class=\"number\">200</span></span><br><span class=\"line\">  Pts = <span class=\"number\">50</span></span><br><span class=\"line\">  Dry_Pts = [<span class=\"number\">0</span>]</span><br><span class=\"line\">  Wet_Pts = [<span class=\"number\">0</span>]</span><br><span class=\"line\">  </span><br><span class=\"line\">  Idx = <span class=\"built_in\">Floor</span>(Ndvi * Nbins)</span><br><span class=\"line\">  For I = <span class=\"number\">0</span>, Nbins <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    Pt = <span class=\"keyword\">Where</span>(Idx Eq I,Cnt)</span><br><span class=\"line\">    <span class=\"keyword\">If</span>(Cnt Gt Npt_Filter) <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">      Ii = Sort(Lst[Pt])</span><br><span class=\"line\">      Dry_Pts = [ Dry_Pts,Pt[Ii[Indgen(Pts)]] ]</span><br><span class=\"line\">      Wet_Pts = [ Wet_Pts,Pt[Ii[-Indgen(Pts)]] ]</span><br><span class=\"line\">    <span class=\"keyword\">Endif</span></span><br><span class=\"line\">  <span class=\"keyword\">End</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Dry_Pts) Le <span class=\"number\">1</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Dry_Pts = Dry_Pts[<span class=\"number\">1</span>:*]</span><br><span class=\"line\">  Wet_Pts = Wet_Pts[<span class=\"number\">1</span>:*]</span><br><span class=\"line\">  </span><br><span class=\"line\">  Wet = Linfit(Ndvi[Wet_Pts],Lst[Wet_Pts])</span><br><span class=\"line\">  Dry = Linfit(Ndvi[Dry_Pts],Lst[Dry_Pts])</span><br><span class=\"line\">  </span><br><span class=\"line\">  Good = <span class=\"keyword\">Where</span>(Ndvi Ge <span class=\"built_in\">Range</span>[<span class=\"number\">0</span>] And Ndvi Le <span class=\"built_in\">Range</span>[<span class=\"number\">1</span>],Cnt)</span><br><span class=\"line\">  <span class=\"keyword\">If</span> Cnt Le <span class=\"number\">0</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Res = Make_Array(<span class=\"built_in\">Size</span> = <span class=\"built_in\">Size</span>(Ndvi))</span><br><span class=\"line\">  Res[Good] = (Lst - Poly(Ndvi[Good],Wet)) / (Poly(Ndvi[Good],Dry) - Poly(Ndvi[Good],Wet) )</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL\"><a href=\"#IDL\" class=\"headerlink\" title=\"IDL\"></a>IDL</h2><p>Google Map TileJpg</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Tsplit</span><br><span class=\"line\">  ; jpeg</span><br><span class=\"line\">  Szfile = <span class=\"string\">'E:\\Test.Jpg'</span>; Dialog_Pickfile(Title = <span class=\"string\">'Input Data'</span>)</span><br><span class=\"line\">  Read_Jpeg,Szfile,Image,True = <span class=\"number\">3</span></span><br><span class=\"line\">  ; <span class=\"number\">5</span></span><br><span class=\"line\">  Nlevel = <span class=\"number\">5</span>;</span><br><span class=\"line\">  ;</span><br><span class=\"line\">  For Ilevel = <span class=\"number\">0</span>,Nlevel-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">      Split,Image,Ilevel,Ib</span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  <span class=\"keyword\">Return</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Split,Image,Level,Iband</span><br><span class=\"line\">  Src = <span class=\"string\">'E:\\Src'</span></span><br><span class=\"line\">  Ns0 = <span class=\"number\">512</span></span><br><span class=\"line\">  Nl0 = <span class=\"number\">512</span></span><br><span class=\"line\">  N0 = <span class=\"number\">2</span>^Level</span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(Image,/Dimensions)</span><br><span class=\"line\">  Help,Sz</span><br><span class=\"line\">  <span class=\"built_in\">Print</span>,Sz</span><br><span class=\"line\">  Nx = Sz[<span class=\"number\">0</span>]</span><br><span class=\"line\">  Ny = Sz[<span class=\"number\">1</span>]</span><br><span class=\"line\">  Xspan = Nx*<span class=\"number\">1.0</span>/N0;</span><br><span class=\"line\">  Yspan = Ny*<span class=\"number\">1.0</span>/N0;</span><br><span class=\"line\">  Imglet = Bytarr(Ns0,Nl0,<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">Fmt</span> = <span class=\"string\">'(%\"%S\\\\%D\\\\Img_%D_%D.Jpg\")'</span>;</span><br><span class=\"line\">  For Is = l,N0-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">      For Il = l,N0 -<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">          X = Indgen(Ns0)#Replicate(<span class=\"number\">1</span>,Nl0)*Xspan/Ns0 + Is*Xspan</span><br><span class=\"line\">          Y = Replicate(<span class=\"number\">1</span>,Ns0)#Indgen(Nl0)*Yspan/Nl0 + Il*Yspan</span><br><span class=\"line\">          For Ib = <span class=\"number\">0</span>,<span class=\"number\">2</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">              Imglet[*,*,Ib] = Bilinear(Image[*,*,Ib],X,Y)</span><br><span class=\"line\">          Endfor</span><br><span class=\"line\">          Fileout = String(Src,Level,N0-Il-<span class=\"number\">1</span>,Is,<span class=\"keyword\">Format</span> =<span class=\"keyword\">Fmt</span>)</span><br><span class=\"line\">          Dir = File_Dirname(Fileout)</span><br><span class=\"line\">          <span class=\"keyword\">If</span>(File_Test(Dir,/Directory) Lt <span class=\"number\">1</span>) <span class=\"keyword\">Then</span> File_Mkdir,Dir</span><br><span class=\"line\">          Write_Jpeg,Fileout,Imglet,True = <span class=\"number\">3</span></span><br><span class=\"line\">      Endfor</span><br><span class=\"line\">  Endfor</span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">; </span><br><span class=\"line\">Pro Pyrmid</span><br><span class=\"line\"></span><br><span class=\"line\">  Tsplit</span><br><span class=\"line\">  <span class=\"built_in\">Print</span>,<span class=\"string\">'Done</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"MODIS\"><a href=\"#MODIS\" class=\"headerlink\" title=\"MODIS\"></a>MODIS</h2><p>ModismodiswistmailIDLmodisurl<br><img src=\"http://images.cnitblog.com/blog/583396/201311/18161902-2988572b59ca46cdabffb013ca0372a3.jpg\" alt=\"\"><br>IDL7.05.0</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>Modisftp5txtTxt</li>\n<li>Modisftphdf</li>\n<li>IDLIDLnetUrlftpftphttpurl</li>\n<li>IDLIDLcomIDispatchcom /oleThunderAgent.Agentole</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>) polygon</li>\n<li>) 5txt5<br><img src=\"http://images.cnitblog.com/blog/583396/201311/20132851-03d184fa364745519d43217049bdfab3.gif\" alt=\"\"></li>\n<li>) txt5polygon5url</li>\n<li>) hdfurl</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Modistest</span><br><span class=\"line\">  Query_Download,<span class=\"number\">2010</span>,<span class=\"number\">7</span>,<span class=\"number\">18</span>,[<span class=\"number\">110</span>,<span class=\"number\">110</span>,<span class=\"number\">117</span>,<span class=\"number\">117</span>],[<span class=\"number\">34</span>,<span class=\"number\">30</span>,<span class=\"number\">30</span>,<span class=\"number\">34</span>],Productname=<span class=\"string\">'021km'</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Query_Download,Year,Month,Day,Xpoly,Ypoly,Productname=Productname</span><br><span class=\"line\"></span><br><span class=\"line\">  Get_Modis_Metafile,Year,Month,Day,Geometa1,Modlist,/Terra,Productname=Productname</span><br><span class=\"line\">  Query_Modis,Geometa1,Modlist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  Get_Modis_Metafile,Year,Month,Day,Geometa2,Mydlist,/Aqua,Productname=Productname</span><br><span class=\"line\">  Query_Modis,Geometa2,Mydlist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(Modlist,/<span class=\"keyword\">Type</span>) Eq <span class=\"number\">7</span> <span class=\"keyword\">Then</span> L = [Modlist]</span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(Mydlist,/<span class=\"keyword\">Type</span>) Eq <span class=\"number\">7</span> <span class=\"keyword\">Then</span> L = [L,Mydlist]  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(L) Gt <span class=\"number\">0</span> <span class=\"keyword\">Then</span> Add_Download,L</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Query_Modis,<span class=\"keyword\">Data</span>,Filelist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  Flist =Filelist</span><br><span class=\"line\">  Filelist = -<span class=\"number\">1</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Type</span>) Ne <span class=\"number\">7</span> Or <span class=\"built_in\">Size</span>(Flist,/<span class=\"keyword\">Type</span>) Ne <span class=\"number\">7</span> Or N_Elements(Xpoly) Ne N_Elements(Ypoly) <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  G = &#123;Geometa,G_Id:<span class=\"string\">''</span>,Starttime:<span class=\"string\">''</span>,Set:b,Orbit_Number:l,Daynight:b,Box:Dindgen(<span class=\"number\">4</span>),X:Dindgen(<span class=\"number\">4</span>),Y:Dindgen(<span class=\"number\">4</span>)&#125;</span><br><span class=\"line\">  Meta = [G]</span><br><span class=\"line\">  </span><br><span class=\"line\">  For I = <span class=\"number\">3</span>,N_Elements(<span class=\"keyword\">Data</span>)-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    <span class=\"keyword\">If</span> N_Elements(<span class=\"keyword\">Data</span>) Le <span class=\"number\">3</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    Tmp = Strsplit(<span class=\"keyword\">Data</span>[I],<span class=\"string\">\",\"</span>,/Extract)</span><br><span class=\"line\">    <span class=\"keyword\">If</span> N_Elements(Tmp) Eq <span class=\"number\">17</span> <span class=\"keyword\">Then</span> Begin    </span><br><span class=\"line\">      G.G_Id = (Strsplit(Tmp[<span class=\"number\">0</span>],<span class=\"string\">'.'</span>,/Extract))[<span class=\"number\">2</span>]</span><br><span class=\"line\">      G.Starttime = Tmp[<span class=\"number\">1</span>]</span><br><span class=\"line\">      G.Set = Tmp[<span class=\"number\">2</span>]</span><br><span class=\"line\">      G.Orbit_Number = Tmp[<span class=\"number\">3</span>]</span><br><span class=\"line\">      G.Daynight = Byte(Tmp[<span class=\"number\">4</span>])</span><br><span class=\"line\">      G.Box = Tmp[<span class=\"number\">5</span>:<span class=\"number\">8</span>]</span><br><span class=\"line\">      G.X = Tmp[<span class=\"number\">9</span>:<span class=\"number\">12</span>]</span><br><span class=\"line\">      G.Y = Tmp[<span class=\"number\">13</span>:<span class=\"number\">16</span>]</span><br><span class=\"line\">      Meta = [Meta,G]</span><br><span class=\"line\">    <span class=\"keyword\">Endif</span></span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Meta) Gt <span class=\"number\">1</span> <span class=\"keyword\">Then</span> Meta = Meta[<span class=\"number\">1</span>:*] <span class=\"keyword\">Else</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  Idx = Intarr(<span class=\"number\">480</span>);    </span><br><span class=\"line\">  I = Fix(Strmid(File_Basename(Flist),<span class=\"number\">18</span>,<span class=\"number\">4</span>))/<span class=\"number\">5</span></span><br><span class=\"line\">  Idx[I] = Indgen(N_Elements(I))</span><br><span class=\"line\"> </span><br><span class=\"line\">  Ret = [<span class=\"string\">''</span>]</span><br><span class=\"line\">  For I = <span class=\"number\">0</span>,N_Elements(Meta)-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    Id = Idx[Fix(Meta[I].G_Id)/<span class=\"number\">5</span>]</span><br><span class=\"line\">    ;</span><br><span class=\"line\">    ;</span><br><span class=\"line\">    <span class=\"keyword\">If</span> (<span class=\"built_in\">Max</span>(Meta[I].X) - <span class=\"built_in\">Min</span>(Meta[I].X)) Gt <span class=\"number\">300</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Continue</span>      </span><br><span class=\"line\">    ;</span><br><span class=\"line\">    <span class=\"keyword\">If</span> Total(Inside(Xpoly,Ypoly,Meta[I].X,Meta[I].Y)) Gt <span class=\"number\">0</span> $</span><br><span class=\"line\">      And  Meta[I].Daynight Lt Byte(<span class=\"string\">'N'</span>) $</span><br><span class=\"line\">      And  Id Gt <span class=\"number\">0</span>  <span class=\"keyword\">Then</span> Ret = [Ret,Flist[Id]]      </span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  </span><br><span class=\"line\">  Filelist = N_Elements(Ret) Gt <span class=\"number\">1</span> ? Ret[<span class=\"number\">1</span>:*] : -<span class=\"number\">1</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Get_Modis_Metafile,Year,Month,Day,Geometa,Flist,Terra=Terra,Aqua=Aqua,Productname=Productname</span><br><span class=\"line\">  Geometa = -<span class=\"number\">1</span></span><br><span class=\"line\">  Flist = -<span class=\"number\">1</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  Catch, Errorstatus</span><br><span class=\"line\">  <span class=\"keyword\">If</span> (Errorstatus Ne <span class=\"number\">0</span>) <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    Catch, /Cancel</span><br><span class=\"line\">    R = Dialog_Message(<span class=\"comment\">!Error_State.Msg, Title='Url Error', $</span></span><br><span class=\"line\">      /Error)</span><br><span class=\"line\">    <span class=\"built_in\">Print</span>, <span class=\"comment\">!Error_State.Msg</span></span><br><span class=\"line\">    <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"keyword\">Case</span> <span class=\"number\">1</span> Of</span><br><span class=\"line\">    Keyword_Set(Terra):Begin</span><br><span class=\"line\">      Prefix = <span class=\"string\">'Mod'</span></span><br><span class=\"line\">      Satellite = <span class=\"string\">'Terra'</span>      </span><br><span class=\"line\">      Break</span><br><span class=\"line\">    <span class=\"keyword\">End</span></span><br><span class=\"line\">    Keyword_Set(Aqua):Begin</span><br><span class=\"line\">      Prefix = <span class=\"string\">'Myd'</span></span><br><span class=\"line\">      Satellite = <span class=\"string\">'Aqua'</span>     </span><br><span class=\"line\">      Break</span><br><span class=\"line\">    <span class=\"keyword\">End</span></span><br><span class=\"line\">    <span class=\"keyword\">Else</span>:<span class=\"keyword\">Return</span>   </span><br><span class=\"line\">  Endcase</span><br><span class=\"line\">  Productname = Keyword_Set(Productname) ? Productname : <span class=\"string\">'021km'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Site = <span class=\"string\">'Ftp://Ladsweb.Nascom.Nasa.Gov'</span></span><br><span class=\"line\">  Jday = Julday(Month,Day,Year,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>) - Julday(<span class=\"number\">1</span>,<span class=\"number\">1</span>,Year,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">Format</span> = <span class=\"string\">'(\"Geometa/6/'</span>+Satellite+<span class=\"string\">'/\",I4,\"/\",\"'</span>+Prefix+<span class=\"string\">'03_\",I4,\"-\",I02,\"-\",I02,\".Txt\")</span></span><br><span class=\"line\"><span class=\"string\">  Dir_Fmt = '</span>(<span class=\"string\">\"/Alldata/5/\"</span>,<span class=\"string\">\"'+Prefix+Productname+'/\"</span>,I4,<span class=\"string\">\"/\"</span>,I03,<span class=\"string\">\"/\"</span>)<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Url = String([Year,Year,Month,Day],Format=Format)</span></span><br><span class=\"line\"><span class=\"string\">  Dir = Site+ String([Year,Jday],Format = Dir_Fmt)       </span></span><br><span class=\"line\"><span class=\"string\">      </span></span><br><span class=\"line\"><span class=\"string\">  ; Create A New Url Object</span></span><br><span class=\"line\"><span class=\"string\">  Ourl = Obj_New('</span>Idlneturl<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Callback_Function ='</span>Ddcall<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Scheme = '</span>Ftp<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Host = '</span>Ladsweb.Nascom.Nasa.Gov<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Path = Url,$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Username = '</span>Anonymous<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Password = '</span><span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Ftp_Connection_Mode = 0)</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Geometa = Ourl-&gt;Get( /String_Array ) </span></span><br><span class=\"line\"><span class=\"string\">  Flist = Dir + Ourl-&gt;Getftpdirlist(Url=Dir,/Short)  </span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Ourl-&gt;Closeconnections  </span></span><br><span class=\"line\"><span class=\"string\">  Obj_Destroy, Ourl</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Function Ddcall, Status, Progress, Data</span></span><br><span class=\"line\"><span class=\"string\">  Print, Status</span></span><br><span class=\"line\"><span class=\"string\">  Return, 1</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Pro Add_Download,Url</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  Othunder = Obj_New('</span>Idlcomidispatch$Progid$Thunderagent_Agent<span class=\"string\">');</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  If Obj_Valid(Othunder) Then Begin</span></span><br><span class=\"line\"><span class=\"string\">    For I = 0,N_Elements(Url)-1 Do Othunder-&gt;Addtask,Url[I],\"\",\"\",\"\",\"\",1,0,5</span></span><br><span class=\"line\"><span class=\"string\">    Othunder-&gt;Committasks,1</span></span><br><span class=\"line\"><span class=\"string\">    Obj_Destroy ,Othunder</span></span><br><span class=\"line\"><span class=\"string\">  Endif</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Function Inside, X, Y, Xpts, Ypts, Index=Index</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    On_Error, 1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Sx = Size(Xpts)</span></span><br><span class=\"line\"><span class=\"string\">    Sy = Size(Ypts)</span></span><br><span class=\"line\"><span class=\"string\">    If (Sx[0] Eq 1) Then Nx=Sx[1] Else Message, '</span>X Coordinates Of Polygon Not A Vector.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">    If (Sy[0] Eq 1) Then Ny=Sy[1] Else Message, '</span>Y Coordinates Of Polygon Not A Vector.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">    If (Nx Eq Ny) Then N = Nx Else Message, '</span>Incompatable Vector Dimensions.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Close The Polygon.</span></span><br><span class=\"line\"><span class=\"string\">    Tmp_Xpts = [Xpts, Xpts[0]]</span></span><br><span class=\"line\"><span class=\"string\">    Tmp_Ypts = [Ypts, Ypts[0]]</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Set Up Counters.</span></span><br><span class=\"line\"><span class=\"string\">    I = Indgen(N)</span></span><br><span class=\"line\"><span class=\"string\">    Ip = Indgen(N)+1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Nn = N_Elements(X)</span></span><br><span class=\"line\"><span class=\"string\">    X1 = Tmp_Xpts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    Y1 = Tmp_Ypts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    X2 = Tmp_Xpts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    Y2 = Tmp_Ypts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Dp = X1*X2 + Y1*Y2 ; Dot-Product</span></span><br><span class=\"line\"><span class=\"string\">    Cp = X1*Y2 - Y1*X2 ; Cross-Product</span></span><br><span class=\"line\"><span class=\"string\">    Theta = Atan(Cp,Dp)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Ret = Replicate(0l, N_Elements(X))</span></span><br><span class=\"line\"><span class=\"string\">    I = Where(Abs(Total(Theta,1)) Gt 0.01, Count)</span></span><br><span class=\"line\"><span class=\"string\">    If (Count Gt 0) Then Ret(I)=1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Make This A Scalar Value If There Is Only One Value.</span></span><br><span class=\"line\"><span class=\"string\">    If (N_Elements(Ret) Eq 1) Then Ret=Ret[0]</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; If The Index Keyword Is Set, Then Return Indices.</span></span><br><span class=\"line\"><span class=\"string\">    If (Arg_Present(Index)) Then Ret=(Indgen(/Long, N_Elements(X)))(Where(Ret Eq 1))</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Return, Ret</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IDL</p>\n<h2 id=\"IDL\"><a href=\"#IDL\" class=\"headerlink\" title=\"IDL\"></a>IDL</h2><ol>\n<li>IDLSolving Real Problems with Computer Graphicsppt</li>\n<li>IDLIDLpptcode</li>\n</ol>","more":"<p>IDLGISIDL<br>IDLENVIIMAGISRiverTools2000IDL<br>IDL</p>\n<h2 id=\"Envi\"><a href=\"#Envi\" class=\"headerlink\" title=\"Envi\"></a>Envi</h2><ol>\n<li><p>envi</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlrt.exe -nodemowarn -novm E:\\ITT\\IDL64\\lib\\hook\\envi.sav</p>\n</blockquote>\n</li>\n<li><p>idl</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe</p>\n</blockquote>\n</li>\n<li><p>idl+envi</p>\n<blockquote>\n<p>E:\\ITT\\IDL64\\bin\\bin.x86\\idlde.exe -minimized -noconfirmexit -nosplash @E:\\ITT\\IDL64\\products\\envi44\\bin\\envi.run</p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"myEclipseIDL\"><a href=\"#myEclipseIDL\" class=\"headerlink\" title=\"myEclipseIDL\"></a>myEclipseIDL</h2><p>Envi5.0 IDL8.2JSPIDLjardlltomcattomcatjdk libbinjspprojava</p>\n<p></p>\n<ol>\n<li>myEclipse Java Web Projectjavaidlb.jar</li>\n<li>java jdk jre bin libidldlljar</li>\n<li>pathidl\\binidl\\bin\\bin.x86</li>\n<li>myEclipse Tomcatidl bin bin.x86 lib</li>\n<li>myEclipse Installed JreIDL</li>\n<li>Envi5</li>\n</ol>\n<h2 id=\"TM34GeoTiffNDVI\"><a href=\"#TM34GeoTiffNDVI\" class=\"headerlink\" title=\"TM34GeoTiffNDVI\"></a>TM34GeoTiffNDVI</h2><p>NDVI<img src=\"http://i.weather.com.cn/images/henan/nyqx/ygjc/nyyg/2011/05/22/6731D1A3076F2F3187AF7FE47EE34B76.jpg\" alt=\"NDVI\"></p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PRO TIFF_NDVI,F1,F2,FOUT </span><br><span class=\"line\">    F1 = DIALOG_PICKFILE(TITLE = <span class=\"string\">'B4 TIFF'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/READ) </span><br><span class=\"line\">    F2 = DIALOG_PICKFILE(TITLE = <span class=\"string\">'B3 TIFF'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/READ) </span><br><span class=\"line\">    FOUT =DIALOG_PICKFILE(TITLE = <span class=\"string\">'RESULT PATH'</span>,FILTER=<span class=\"string\">'*.TIF'</span>,/<span class=\"built_in\">WRITE</span>) </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">IF</span>(FILE_TEST(F1) GT <span class=\"number\">0</span> AND FILE_TEST(F2) GT <span class=\"number\">0</span>) <span class=\"keyword\">THEN</span> BEGIN </span><br><span class=\"line\">        B1 = READ_TIFF(F1,GEOTIFF=GE1) </span><br><span class=\"line\">        B2 = READ_TIFF(F2,GEOTIFF=GE2) </span><br><span class=\"line\">        HELP,B1,B2 </span><br><span class=\"line\">        C = <span class=\"number\">0.001</span> </span><br><span class=\"line\">        WRITE_TIFF,FOUT,-<span class=\"number\">1.0</span>&gt;( (<span class=\"built_in\">FLOAT</span>(B1)-<span class=\"built_in\">FLOAT</span>(B2))/(<span class=\"built_in\">FLOAT</span>(B1)+<span class=\"built_in\">FLOAT</span>(B2) + C) )&lt;<span class=\"number\">1.0</span>,/<span class=\"built_in\">FLOAT</span>,GEOTIFF=GE2 </span><br><span class=\"line\">        <span class=\"built_in\">PRINT</span>,<span class=\"string\">'OK </span></span><br><span class=\"line\"><span class=\"string\">    ENDIF </span></span><br><span class=\"line\"><span class=\"string\">END</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-PCA\"><a href=\"#IDL-PCA\" class=\"headerlink\" title=\"IDL PCA\"></a>IDL PCA</h2><p>Principal components analysisPCAwiki</p>\n<p>PCAIDL</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Pca,<span class=\"keyword\">Data</span>,Eigenvalues = Egvalues,Eigenvectors = Egvec,Percent = Percent,_Extra=Extra</span><br><span class=\"line\">  Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span>= <span class=\"keyword\">Type</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Number</span>) And Nb Gt <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/N_Dimensions) Eq <span class=\"number\">3</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = <span class=\"built_in\">Transpose</span>(Reform(<span class=\"keyword\">Data</span>,Ns*Nl,Nb))</span><br><span class=\"line\">    Corr = Correlate(<span class=\"keyword\">Data</span>,/Covariance)</span><br><span class=\"line\">    Egvalues = Eigenql( Corr, Eigenvectors=Egvec,/<span class=\"keyword\">Double</span> ,/Absolute)</span><br><span class=\"line\">    Absegvalue = <span class=\"built_in\">Abs</span>(Egvalues)</span><br><span class=\"line\">    Percent = Absegvalue / Total(Absegvalue);</span><br><span class=\"line\">    ; Egvec <span class=\"keyword\">Format</span></span><br><span class=\"line\">    ;Egvec = [  Egvec1</span><br><span class=\"line\">    ;           Egvec2</span><br><span class=\"line\">    ;           Egvec3</span><br><span class=\"line\">    ;           ...</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = Temporary(Reform(<span class=\"built_in\">Transpose</span>(Egvec) ## <span class=\"built_in\">Transpose</span>(<span class=\"keyword\">Data</span>),Ns,Nl,Nb))</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;---------------------------------------</span><br><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-EOF\"><a href=\"#IDL-EOF\" class=\"headerlink\" title=\"IDL EOF\"></a>IDL EOF</h2><p>EOFwiki <a href=\"http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle\" target=\"_blank\" rel=\"noopener\">http://en.wikipedia.org/wiki/Empirical_orthogonal_functionsGoogle</a></p>\n<p>PCAEOFEOF</p>\n<p>EOF</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Eofs,<span class=\"keyword\">Data</span>,Eof,Pcs</span><br><span class=\"line\">  ;Svdc,<span class=\"keyword\">Data</span>(*,*),W,U,V,/Column</span><br><span class=\"line\">  ;Eofs=Reform(U(*,*),Nlons,Nlats,Cutoff)</span><br><span class=\"line\">  ;Pcs=V</span><br><span class=\"line\">  ;Svls=W</span><br><span class=\"line\">  Eof = -<span class=\"number\">1</span></span><br><span class=\"line\">  Pcs = -<span class=\"number\">1</span></span><br><span class=\"line\">  Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Number</span>) And Nb Gt <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/N_Dimensions) Eq <span class=\"number\">3</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    Svdc,<span class=\"keyword\">Data</span>,W,U,V,/Column</span><br><span class=\"line\">    <span class=\"keyword\">Data</span> = <span class=\"built_in\">Transpose</span>(Reform(<span class=\"keyword\">Data</span>,Ns*Nl,Nb))</span><br><span class=\"line\">    Eof=Reform(U,Ns,Nl,Nb)</span><br><span class=\"line\">    Pcs = V</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-\"><a href=\"#IDL-\" class=\"headerlink\" title=\"IDL \"></a>IDL </h2><figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Aspect_Slope,Dem,Aspect = Aspect,Slope=Slope,Pixelsize = Pixelsize</span><br><span class=\"line\">  ;Ref To Doi:<span class=\"number\">10.1016</span>/J.Cageo<span class=\"number\">.2003.</span><span class=\"number\">07.005</span></span><br><span class=\"line\">  Aspect = -<span class=\"number\">1</span></span><br><span class=\"line\">  Slope = -<span class=\"number\">1</span></span><br><span class=\"line\">  Pixelsize = [<span class=\"number\">30.</span>,<span class=\"number\">30.</span>]</span><br><span class=\"line\">  Get_Sz,Dem,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> Isa(Dem,/<span class=\"keyword\">Number</span>) And Nb Eq <span class=\"number\">1</span> And <span class=\"built_in\">Size</span>(Dem,/N_Dimensions) Eq <span class=\"number\">2</span> <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    K_X = <span class=\"built_in\">Transpose</span>([-<span class=\"number\">1</span>,<span class=\"number\">1</span>])</span><br><span class=\"line\">    K_Y = [-<span class=\"number\">1.0</span>,<span class=\"number\">1.0</span>]</span><br><span class=\"line\">    Dx = Convol(Dem,K_X,/Edge_Truncate,/Nan)/Pixelsize[<span class=\"number\">1</span>] ; Mei Cuo ,</span><br><span class=\"line\">    Dy = Convol(Dem,K_Y,/Edge_Truncate,/Nan)/Pixelsize[<span class=\"number\">0</span>]</span><br><span class=\"line\">    Pi = <span class=\"built_in\">Acos</span>(-<span class=\"number\">1.</span>d)</span><br><span class=\"line\">    Help,Dx,Dy</span><br><span class=\"line\">    Slope = <span class=\"built_in\">Atan</span>( <span class=\"built_in\">Sqrt</span>(Dx*Dx + Dy * Dy)) * <span class=\"number\">180.0</span> / Pi</span><br><span class=\"line\">    Aspect = <span class=\"number\">270</span> + <span class=\"built_in\">Atan</span>(Dy*<span class=\"number\">1.0</span> /Dx) - <span class=\"number\">90.0</span> * Fix(Dx / <span class=\"built_in\">Abs</span>(Dx))</span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Get_Sz,<span class=\"keyword\">Data</span>,Ns=Ns,Nl=Nl,Nb=Nb,<span class=\"keyword\">Type</span> = <span class=\"keyword\">Type</span></span><br><span class=\"line\"></span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">Type</span> = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[-<span class=\"number\">2</span>] : <span class=\"number\">0</span></span><br><span class=\"line\">  Ns = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">1</span> ? Sz[<span class=\"number\">1</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nl = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">2</span> ? Sz[<span class=\"number\">2</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  Nb = Sz[<span class=\"number\">0</span>] Ge <span class=\"number\">3</span> ? Sz[<span class=\"number\">3</span>] : <span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL-TVDI\"><a href=\"#IDL-TVDI\" class=\"headerlink\" title=\"IDL TVDI\"></a>IDL TVDI</h2><p><a href=\"http://blog.sina.com.cn/s/blog_764b1e9d0100wdrr.html\" target=\"_blank\" rel=\"noopener\">ENVI(TVDI)</a></p>\n<ol>\n<li><p>n20050</p>\n</li>\n<li><p>sortwherelinefitpolyxy,,</p>\n</li>\n</ol>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Tvdi,Ndvi,Lst,Nbins,Res</span><br><span class=\"line\">  Res = -<span class=\"number\">1</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Sz1 = <span class=\"built_in\">Size</span>(Ndvi,/Dimensions)</span><br><span class=\"line\">  Sz2 = <span class=\"built_in\">Size</span>(Lst,/Dimensions)</span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Sz1) Ne <span class=\"number\">2</span> Or N_Elements(Sz2) Ne <span class=\"number\">2</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> Total(<span class=\"built_in\">Abs</span>(Sz1 - Sz2)) Ne <span class=\"number\">0</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> ~Isa(Ndvi,/<span class=\"keyword\">Number</span>) And ~Isa(Lst,/<span class=\"keyword\">Number</span>) <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  ;Find Dyr Wet Pts</span><br><span class=\"line\">  <span class=\"built_in\">Range</span> = [<span class=\"number\">0.0</span>,<span class=\"number\">1.0</span>]</span><br><span class=\"line\">  Npt_Filter = <span class=\"number\">200</span></span><br><span class=\"line\">  Pts = <span class=\"number\">50</span></span><br><span class=\"line\">  Dry_Pts = [<span class=\"number\">0</span>]</span><br><span class=\"line\">  Wet_Pts = [<span class=\"number\">0</span>]</span><br><span class=\"line\">  </span><br><span class=\"line\">  Idx = <span class=\"built_in\">Floor</span>(Ndvi * Nbins)</span><br><span class=\"line\">  For I = <span class=\"number\">0</span>, Nbins <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    Pt = <span class=\"keyword\">Where</span>(Idx Eq I,Cnt)</span><br><span class=\"line\">    <span class=\"keyword\">If</span>(Cnt Gt Npt_Filter) <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">      Ii = Sort(Lst[Pt])</span><br><span class=\"line\">      Dry_Pts = [ Dry_Pts,Pt[Ii[Indgen(Pts)]] ]</span><br><span class=\"line\">      Wet_Pts = [ Wet_Pts,Pt[Ii[-Indgen(Pts)]] ]</span><br><span class=\"line\">    <span class=\"keyword\">Endif</span></span><br><span class=\"line\">  <span class=\"keyword\">End</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Dry_Pts) Le <span class=\"number\">1</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Dry_Pts = Dry_Pts[<span class=\"number\">1</span>:*]</span><br><span class=\"line\">  Wet_Pts = Wet_Pts[<span class=\"number\">1</span>:*]</span><br><span class=\"line\">  </span><br><span class=\"line\">  Wet = Linfit(Ndvi[Wet_Pts],Lst[Wet_Pts])</span><br><span class=\"line\">  Dry = Linfit(Ndvi[Dry_Pts],Lst[Dry_Pts])</span><br><span class=\"line\">  </span><br><span class=\"line\">  Good = <span class=\"keyword\">Where</span>(Ndvi Ge <span class=\"built_in\">Range</span>[<span class=\"number\">0</span>] And Ndvi Le <span class=\"built_in\">Range</span>[<span class=\"number\">1</span>],Cnt)</span><br><span class=\"line\">  <span class=\"keyword\">If</span> Cnt Le <span class=\"number\">0</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Res = Make_Array(<span class=\"built_in\">Size</span> = <span class=\"built_in\">Size</span>(Ndvi))</span><br><span class=\"line\">  Res[Good] = (Lst - Poly(Ndvi[Good],Wet)) / (Poly(Ndvi[Good],Dry) - Poly(Ndvi[Good],Wet) )</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDL\"><a href=\"#IDL\" class=\"headerlink\" title=\"IDL\"></a>IDL</h2><p>Google Map TileJpg</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Pro Tsplit</span><br><span class=\"line\">  ; jpeg</span><br><span class=\"line\">  Szfile = <span class=\"string\">'E:\\Test.Jpg'</span>; Dialog_Pickfile(Title = <span class=\"string\">'Input Data'</span>)</span><br><span class=\"line\">  Read_Jpeg,Szfile,Image,True = <span class=\"number\">3</span></span><br><span class=\"line\">  ; <span class=\"number\">5</span></span><br><span class=\"line\">  Nlevel = <span class=\"number\">5</span>;</span><br><span class=\"line\">  ;</span><br><span class=\"line\">  For Ilevel = <span class=\"number\">0</span>,Nlevel-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">      Split,Image,Ilevel,Ib</span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  <span class=\"keyword\">Return</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">Pro Split,Image,Level,Iband</span><br><span class=\"line\">  Src = <span class=\"string\">'E:\\Src'</span></span><br><span class=\"line\">  Ns0 = <span class=\"number\">512</span></span><br><span class=\"line\">  Nl0 = <span class=\"number\">512</span></span><br><span class=\"line\">  N0 = <span class=\"number\">2</span>^Level</span><br><span class=\"line\">  Sz = <span class=\"built_in\">Size</span>(Image,/Dimensions)</span><br><span class=\"line\">  Help,Sz</span><br><span class=\"line\">  <span class=\"built_in\">Print</span>,Sz</span><br><span class=\"line\">  Nx = Sz[<span class=\"number\">0</span>]</span><br><span class=\"line\">  Ny = Sz[<span class=\"number\">1</span>]</span><br><span class=\"line\">  Xspan = Nx*<span class=\"number\">1.0</span>/N0;</span><br><span class=\"line\">  Yspan = Ny*<span class=\"number\">1.0</span>/N0;</span><br><span class=\"line\">  Imglet = Bytarr(Ns0,Nl0,<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">Fmt</span> = <span class=\"string\">'(%\"%S\\\\%D\\\\Img_%D_%D.Jpg\")'</span>;</span><br><span class=\"line\">  For Is = l,N0-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">      For Il = l,N0 -<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">          X = Indgen(Ns0)#Replicate(<span class=\"number\">1</span>,Nl0)*Xspan/Ns0 + Is*Xspan</span><br><span class=\"line\">          Y = Replicate(<span class=\"number\">1</span>,Ns0)#Indgen(Nl0)*Yspan/Nl0 + Il*Yspan</span><br><span class=\"line\">          For Ib = <span class=\"number\">0</span>,<span class=\"number\">2</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">              Imglet[*,*,Ib] = Bilinear(Image[*,*,Ib],X,Y)</span><br><span class=\"line\">          Endfor</span><br><span class=\"line\">          Fileout = String(Src,Level,N0-Il-<span class=\"number\">1</span>,Is,<span class=\"keyword\">Format</span> =<span class=\"keyword\">Fmt</span>)</span><br><span class=\"line\">          Dir = File_Dirname(Fileout)</span><br><span class=\"line\">          <span class=\"keyword\">If</span>(File_Test(Dir,/Directory) Lt <span class=\"number\">1</span>) <span class=\"keyword\">Then</span> File_Mkdir,Dir</span><br><span class=\"line\">          Write_Jpeg,Fileout,Imglet,True = <span class=\"number\">3</span></span><br><span class=\"line\">      Endfor</span><br><span class=\"line\">  Endfor</span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\"></span><br><span class=\"line\">; </span><br><span class=\"line\">Pro Pyrmid</span><br><span class=\"line\"></span><br><span class=\"line\">  Tsplit</span><br><span class=\"line\">  <span class=\"built_in\">Print</span>,<span class=\"string\">'Done</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"MODIS\"><a href=\"#MODIS\" class=\"headerlink\" title=\"MODIS\"></a>MODIS</h2><p>ModismodiswistmailIDLmodisurl<br><img src=\"http://images.cnitblog.com/blog/583396/201311/18161902-2988572b59ca46cdabffb013ca0372a3.jpg\" alt=\"\"><br>IDL7.05.0</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>Modisftp5txtTxt</li>\n<li>Modisftphdf</li>\n<li>IDLIDLnetUrlftpftphttpurl</li>\n<li>IDLIDLcomIDispatchcom /oleThunderAgent.Agentole</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>) polygon</li>\n<li>) 5txt5<br><img src=\"http://images.cnitblog.com/blog/583396/201311/20132851-03d184fa364745519d43217049bdfab3.gif\" alt=\"\"></li>\n<li>) txt5polygon5url</li>\n<li>) hdfurl</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight fortran\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Modistest</span><br><span class=\"line\">  Query_Download,<span class=\"number\">2010</span>,<span class=\"number\">7</span>,<span class=\"number\">18</span>,[<span class=\"number\">110</span>,<span class=\"number\">110</span>,<span class=\"number\">117</span>,<span class=\"number\">117</span>],[<span class=\"number\">34</span>,<span class=\"number\">30</span>,<span class=\"number\">30</span>,<span class=\"number\">34</span>],Productname=<span class=\"string\">'021km'</span></span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Query_Download,Year,Month,Day,Xpoly,Ypoly,Productname=Productname</span><br><span class=\"line\"></span><br><span class=\"line\">  Get_Modis_Metafile,Year,Month,Day,Geometa1,Modlist,/Terra,Productname=Productname</span><br><span class=\"line\">  Query_Modis,Geometa1,Modlist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  Get_Modis_Metafile,Year,Month,Day,Geometa2,Mydlist,/Aqua,Productname=Productname</span><br><span class=\"line\">  Query_Modis,Geometa2,Mydlist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(Modlist,/<span class=\"keyword\">Type</span>) Eq <span class=\"number\">7</span> <span class=\"keyword\">Then</span> L = [Modlist]</span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(Mydlist,/<span class=\"keyword\">Type</span>) Eq <span class=\"number\">7</span> <span class=\"keyword\">Then</span> L = [L,Mydlist]  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(L) Gt <span class=\"number\">0</span> <span class=\"keyword\">Then</span> Add_Download,L</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Query_Modis,<span class=\"keyword\">Data</span>,Filelist,Xpoly,Ypoly</span><br><span class=\"line\">  </span><br><span class=\"line\">  Flist =Filelist</span><br><span class=\"line\">  Filelist = -<span class=\"number\">1</span></span><br><span class=\"line\">  <span class=\"keyword\">If</span> <span class=\"built_in\">Size</span>(<span class=\"keyword\">Data</span>,/<span class=\"keyword\">Type</span>) Ne <span class=\"number\">7</span> Or <span class=\"built_in\">Size</span>(Flist,/<span class=\"keyword\">Type</span>) Ne <span class=\"number\">7</span> Or N_Elements(Xpoly) Ne N_Elements(Ypoly) <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  G = &#123;Geometa,G_Id:<span class=\"string\">''</span>,Starttime:<span class=\"string\">''</span>,Set:b,Orbit_Number:l,Daynight:b,Box:Dindgen(<span class=\"number\">4</span>),X:Dindgen(<span class=\"number\">4</span>),Y:Dindgen(<span class=\"number\">4</span>)&#125;</span><br><span class=\"line\">  Meta = [G]</span><br><span class=\"line\">  </span><br><span class=\"line\">  For I = <span class=\"number\">3</span>,N_Elements(<span class=\"keyword\">Data</span>)-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    <span class=\"keyword\">If</span> N_Elements(<span class=\"keyword\">Data</span>) Le <span class=\"number\">3</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Return</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    Tmp = Strsplit(<span class=\"keyword\">Data</span>[I],<span class=\"string\">\",\"</span>,/Extract)</span><br><span class=\"line\">    <span class=\"keyword\">If</span> N_Elements(Tmp) Eq <span class=\"number\">17</span> <span class=\"keyword\">Then</span> Begin    </span><br><span class=\"line\">      G.G_Id = (Strsplit(Tmp[<span class=\"number\">0</span>],<span class=\"string\">'.'</span>,/Extract))[<span class=\"number\">2</span>]</span><br><span class=\"line\">      G.Starttime = Tmp[<span class=\"number\">1</span>]</span><br><span class=\"line\">      G.Set = Tmp[<span class=\"number\">2</span>]</span><br><span class=\"line\">      G.Orbit_Number = Tmp[<span class=\"number\">3</span>]</span><br><span class=\"line\">      G.Daynight = Byte(Tmp[<span class=\"number\">4</span>])</span><br><span class=\"line\">      G.Box = Tmp[<span class=\"number\">5</span>:<span class=\"number\">8</span>]</span><br><span class=\"line\">      G.X = Tmp[<span class=\"number\">9</span>:<span class=\"number\">12</span>]</span><br><span class=\"line\">      G.Y = Tmp[<span class=\"number\">13</span>:<span class=\"number\">16</span>]</span><br><span class=\"line\">      Meta = [Meta,G]</span><br><span class=\"line\">    <span class=\"keyword\">Endif</span></span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">If</span> N_Elements(Meta) Gt <span class=\"number\">1</span> <span class=\"keyword\">Then</span> Meta = Meta[<span class=\"number\">1</span>:*] <span class=\"keyword\">Else</span> <span class=\"keyword\">Return</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  Idx = Intarr(<span class=\"number\">480</span>);    </span><br><span class=\"line\">  I = Fix(Strmid(File_Basename(Flist),<span class=\"number\">18</span>,<span class=\"number\">4</span>))/<span class=\"number\">5</span></span><br><span class=\"line\">  Idx[I] = Indgen(N_Elements(I))</span><br><span class=\"line\"> </span><br><span class=\"line\">  Ret = [<span class=\"string\">''</span>]</span><br><span class=\"line\">  For I = <span class=\"number\">0</span>,N_Elements(Meta)-<span class=\"number\">1</span> <span class=\"keyword\">Do</span> Begin</span><br><span class=\"line\">    Id = Idx[Fix(Meta[I].G_Id)/<span class=\"number\">5</span>]</span><br><span class=\"line\">    ;</span><br><span class=\"line\">    ;</span><br><span class=\"line\">    <span class=\"keyword\">If</span> (<span class=\"built_in\">Max</span>(Meta[I].X) - <span class=\"built_in\">Min</span>(Meta[I].X)) Gt <span class=\"number\">300</span> <span class=\"keyword\">Then</span> <span class=\"keyword\">Continue</span>      </span><br><span class=\"line\">    ;</span><br><span class=\"line\">    <span class=\"keyword\">If</span> Total(Inside(Xpoly,Ypoly,Meta[I].X,Meta[I].Y)) Gt <span class=\"number\">0</span> $</span><br><span class=\"line\">      And  Meta[I].Daynight Lt Byte(<span class=\"string\">'N'</span>) $</span><br><span class=\"line\">      And  Id Gt <span class=\"number\">0</span>  <span class=\"keyword\">Then</span> Ret = [Ret,Flist[Id]]      </span><br><span class=\"line\">  Endfor</span><br><span class=\"line\">  </span><br><span class=\"line\">  Filelist = N_Elements(Ret) Gt <span class=\"number\">1</span> ? Ret[<span class=\"number\">1</span>:*] : -<span class=\"number\">1</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">End</span></span><br><span class=\"line\">;-----------------------------------------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">Pro Get_Modis_Metafile,Year,Month,Day,Geometa,Flist,Terra=Terra,Aqua=Aqua,Productname=Productname</span><br><span class=\"line\">  Geometa = -<span class=\"number\">1</span></span><br><span class=\"line\">  Flist = -<span class=\"number\">1</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  Catch, Errorstatus</span><br><span class=\"line\">  <span class=\"keyword\">If</span> (Errorstatus Ne <span class=\"number\">0</span>) <span class=\"keyword\">Then</span> Begin</span><br><span class=\"line\">    Catch, /Cancel</span><br><span class=\"line\">    R = Dialog_Message(<span class=\"comment\">!Error_State.Msg, Title='Url Error', $</span></span><br><span class=\"line\">      /Error)</span><br><span class=\"line\">    <span class=\"built_in\">Print</span>, <span class=\"comment\">!Error_State.Msg</span></span><br><span class=\"line\">    <span class=\"keyword\">Return</span></span><br><span class=\"line\">  <span class=\"keyword\">Endif</span></span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"keyword\">Case</span> <span class=\"number\">1</span> Of</span><br><span class=\"line\">    Keyword_Set(Terra):Begin</span><br><span class=\"line\">      Prefix = <span class=\"string\">'Mod'</span></span><br><span class=\"line\">      Satellite = <span class=\"string\">'Terra'</span>      </span><br><span class=\"line\">      Break</span><br><span class=\"line\">    <span class=\"keyword\">End</span></span><br><span class=\"line\">    Keyword_Set(Aqua):Begin</span><br><span class=\"line\">      Prefix = <span class=\"string\">'Myd'</span></span><br><span class=\"line\">      Satellite = <span class=\"string\">'Aqua'</span>     </span><br><span class=\"line\">      Break</span><br><span class=\"line\">    <span class=\"keyword\">End</span></span><br><span class=\"line\">    <span class=\"keyword\">Else</span>:<span class=\"keyword\">Return</span>   </span><br><span class=\"line\">  Endcase</span><br><span class=\"line\">  Productname = Keyword_Set(Productname) ? Productname : <span class=\"string\">'021km'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  Site = <span class=\"string\">'Ftp://Ladsweb.Nascom.Nasa.Gov'</span></span><br><span class=\"line\">  Jday = Julday(Month,Day,Year,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>) - Julday(<span class=\"number\">1</span>,<span class=\"number\">1</span>,Year,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">Format</span> = <span class=\"string\">'(\"Geometa/6/'</span>+Satellite+<span class=\"string\">'/\",I4,\"/\",\"'</span>+Prefix+<span class=\"string\">'03_\",I4,\"-\",I02,\"-\",I02,\".Txt\")</span></span><br><span class=\"line\"><span class=\"string\">  Dir_Fmt = '</span>(<span class=\"string\">\"/Alldata/5/\"</span>,<span class=\"string\">\"'+Prefix+Productname+'/\"</span>,I4,<span class=\"string\">\"/\"</span>,I03,<span class=\"string\">\"/\"</span>)<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Url = String([Year,Year,Month,Day],Format=Format)</span></span><br><span class=\"line\"><span class=\"string\">  Dir = Site+ String([Year,Jday],Format = Dir_Fmt)       </span></span><br><span class=\"line\"><span class=\"string\">      </span></span><br><span class=\"line\"><span class=\"string\">  ; Create A New Url Object</span></span><br><span class=\"line\"><span class=\"string\">  Ourl = Obj_New('</span>Idlneturl<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Callback_Function ='</span>Ddcall<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Scheme = '</span>Ftp<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Host = '</span>Ladsweb.Nascom.Nasa.Gov<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Path = Url,$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Username = '</span>Anonymous<span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Url_Password = '</span><span class=\"string\">',$</span></span><br><span class=\"line\"><span class=\"string\">    Ftp_Connection_Mode = 0)</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Geometa = Ourl-&gt;Get( /String_Array ) </span></span><br><span class=\"line\"><span class=\"string\">  Flist = Dir + Ourl-&gt;Getftpdirlist(Url=Dir,/Short)  </span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  Ourl-&gt;Closeconnections  </span></span><br><span class=\"line\"><span class=\"string\">  Obj_Destroy, Ourl</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Function Ddcall, Status, Progress, Data</span></span><br><span class=\"line\"><span class=\"string\">  Print, Status</span></span><br><span class=\"line\"><span class=\"string\">  Return, 1</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Pro Add_Download,Url</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  Othunder = Obj_New('</span>Idlcomidispatch$Progid$Thunderagent_Agent<span class=\"string\">');</span></span><br><span class=\"line\"><span class=\"string\">  </span></span><br><span class=\"line\"><span class=\"string\">  If Obj_Valid(Othunder) Then Begin</span></span><br><span class=\"line\"><span class=\"string\">    For I = 0,N_Elements(Url)-1 Do Othunder-&gt;Addtask,Url[I],\"\",\"\",\"\",\"\",1,0,5</span></span><br><span class=\"line\"><span class=\"string\">    Othunder-&gt;Committasks,1</span></span><br><span class=\"line\"><span class=\"string\">    Obj_Destroy ,Othunder</span></span><br><span class=\"line\"><span class=\"string\">  Endif</span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br><span class=\"line\"><span class=\"string\">;-----------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Function Inside, X, Y, Xpts, Ypts, Index=Index</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    On_Error, 1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Sx = Size(Xpts)</span></span><br><span class=\"line\"><span class=\"string\">    Sy = Size(Ypts)</span></span><br><span class=\"line\"><span class=\"string\">    If (Sx[0] Eq 1) Then Nx=Sx[1] Else Message, '</span>X Coordinates Of Polygon Not A Vector.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">    If (Sy[0] Eq 1) Then Ny=Sy[1] Else Message, '</span>Y Coordinates Of Polygon Not A Vector.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\">    If (Nx Eq Ny) Then N = Nx Else Message, '</span>Incompatable Vector Dimensions.<span class=\"string\">'</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Close The Polygon.</span></span><br><span class=\"line\"><span class=\"string\">    Tmp_Xpts = [Xpts, Xpts[0]]</span></span><br><span class=\"line\"><span class=\"string\">    Tmp_Ypts = [Ypts, Ypts[0]]</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Set Up Counters.</span></span><br><span class=\"line\"><span class=\"string\">    I = Indgen(N)</span></span><br><span class=\"line\"><span class=\"string\">    Ip = Indgen(N)+1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Nn = N_Elements(X)</span></span><br><span class=\"line\"><span class=\"string\">    X1 = Tmp_Xpts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    Y1 = Tmp_Ypts(I)  # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    X2 = Tmp_Xpts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([X],Nn)</span></span><br><span class=\"line\"><span class=\"string\">    Y2 = Tmp_Ypts(Ip) # Replicate(1,Nn) - Replicate(1,N) # Reform([Y],Nn)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Dp = X1*X2 + Y1*Y2 ; Dot-Product</span></span><br><span class=\"line\"><span class=\"string\">    Cp = X1*Y2 - Y1*X2 ; Cross-Product</span></span><br><span class=\"line\"><span class=\"string\">    Theta = Atan(Cp,Dp)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Ret = Replicate(0l, N_Elements(X))</span></span><br><span class=\"line\"><span class=\"string\">    I = Where(Abs(Total(Theta,1)) Gt 0.01, Count)</span></span><br><span class=\"line\"><span class=\"string\">    If (Count Gt 0) Then Ret(I)=1</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; Make This A Scalar Value If There Is Only One Value.</span></span><br><span class=\"line\"><span class=\"string\">    If (N_Elements(Ret) Eq 1) Then Ret=Ret[0]</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    ; If The Index Keyword Is Set, Then Return Indices.</span></span><br><span class=\"line\"><span class=\"string\">    If (Arg_Present(Index)) Then Ret=(Indgen(/Long, N_Elements(X)))(Where(Ret Eq 1))</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Return, Ret</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">End</span></span><br></pre></td></tr></table></figure>"},{"title":"","date":"2017-06-15T12:24:36.000Z","_content":"\n\n## \n1. \n1. \n1. \n\n###  \n1. 12\n1. \n1. \n1. \n### \n\n\n<!-- more -->\n### \n\n1. \n1. \n\n### \n\n90\n1. \n1. 90\n1. 90\n\nCEO\n","source":"_posts/manager.md","raw":"---\ntitle: \ndate: 2017-06-15 20:24:36\ntags: []\ncategories: Management\n---\n\n\n## \n1. \n1. \n1. \n\n###  \n1. 12\n1. \n1. \n1. \n### \n\n\n<!-- more -->\n### \n\n1. \n1. \n\n### \n\n90\n1. \n1. 90\n1. 90\n\nCEO\n","slug":"manager","published":1,"updated":"2017-06-15T12:06:59.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58sttc0007zsr4yog34ag4","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>12</li>\n<li></li>\n<li></li>\n<li><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><br><a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>90</p>\n<ol>\n<li></li>\n<li>90</li>\n<li>90</li>\n</ol>\n<p>CEO</p>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>12</li>\n<li></li>\n<li></li>\n<li><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><br>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>90</p>\n<ol>\n<li></li>\n<li>90</li>\n<li>90</li>\n</ol>\n<p>CEO</p>"},{"title":"ToDos","date":"2017-06-04T12:01:02.000Z","_content":"\n\n### \n\n1. \n1. \n1. \n\n### \n#### \n1. \n1. \n1. \n<!--more-->\n\n#### \n1. \n1. , \n\n#### \n1. \n1. Chinadaily VOA\n\n### \n  \n1. PDCA\n1. 8/221\n1. 30   953100 A4\n1. \n1. \n\n\n### \n\n#### UIC\n\n1. Python \n1. GoF \n1. Web AppNodeSQLPS\n1. Office VBA\n\n#### \n\n1. /\n1. TED\n1. \n\n#### \n1. 1\n1. GTD\n1.  \n1. 60\n1. \n\n#### GISer\n\n1. CGB CIM+GIS+BIM\n1.    \n1. \n1. \n1. -","source":"_posts/todos.md","raw":"---\ntitle: ToDos\ndate: 2017-06-04 20:01:02\ntags: [,,]\ncategories: \n\n---\n\n\n### \n\n1. \n1. \n1. \n\n### \n#### \n1. \n1. \n1. \n<!--more-->\n\n#### \n1. \n1. , \n\n#### \n1. \n1. Chinadaily VOA\n\n### \n  \n1. PDCA\n1. 8/221\n1. 30   953100 A4\n1. \n1. \n\n\n### \n\n#### UIC\n\n1. Python \n1. GoF \n1. Web AppNodeSQLPS\n1. Office VBA\n\n#### \n\n1. /\n1. TED\n1. \n\n#### \n1. 1\n1. GTD\n1.  \n1. 60\n1. \n\n#### GISer\n\n1. CGB CIM+GIS+BIM\n1.    \n1. \n1. \n1. -","slug":"todos","published":1,"updated":"2018-06-08T00:31:06.960Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58sttf0009zsr4ohaepc8h","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n<li><a id=\"more\"></a>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>, </li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>Chinadaily VOA</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>  </p>\n<ol>\n<li>PDCA</li>\n<li>8/221</li>\n<li>30   953100 A4</li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"UIC\"><a href=\"#UIC\" class=\"headerlink\" title=\"UIC\"></a>UIC</h4><ol>\n<li>Python </li>\n<li>GoF </li>\n<li>Web AppNodeSQLPS</li>\n<li>Office VBA</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>/</li>\n<li>TED</li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>1</li>\n<li>GTD</li>\n<li> </li>\n<li>60</li>\n<li></li>\n</ol>\n<h4 id=\"GISer\"><a href=\"#GISer\" class=\"headerlink\" title=\"GISer\"></a>GISer</h4><ol>\n<li>CGB CIM+GIS+BIM</li>\n<li>   </li>\n<li></li>\n<li></li>\n<li>-</li>\n</ol>\n","site":{"data":{}},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n<li>","more":"</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>, </li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>Chinadaily VOA</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>  </p>\n<ol>\n<li>PDCA</li>\n<li>8/221</li>\n<li>30   953100 A4</li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"UIC\"><a href=\"#UIC\" class=\"headerlink\" title=\"UIC\"></a>UIC</h4><ol>\n<li>Python </li>\n<li>GoF </li>\n<li>Web AppNodeSQLPS</li>\n<li>Office VBA</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>/</li>\n<li>TED</li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>1</li>\n<li>GTD</li>\n<li> </li>\n<li>60</li>\n<li></li>\n</ol>\n<h4 id=\"GISer\"><a href=\"#GISer\" class=\"headerlink\" title=\"GISer\"></a>GISer</h4><ol>\n<li>CGB CIM+GIS+BIM</li>\n<li>   </li>\n<li></li>\n<li></li>\n<li>-</li>\n</ol>"},{"title":"WebGIS","date":"2017-06-04T12:28:03.000Z","_content":"\n\n## \nSuperMap\n1. \n2. \n3. 4R\n\nWebGIS\n<!-- more -->\n## SuperPy Tif\n### \n1. GDALgdalinfo.exeGeoTiff\n1. DOSGeoTiffGeoTiff\n1. GeoTiffType=ByteGeoTiff\n```DOS\nfor /f %i in ('dir /b /s d:\\tifdata\\*.tif ') do @(\n    e:\\gdal1.4.2\\bin\\gdalinfo.exe %i >> e:\\tifstats.log\n    )\n```\n\n### \nSuperMapPyPython2.7.3Deskpro\n\n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020151646630-204827930.gif)\n\n\n``` python\n# coding: GB2312\n \n#===================================================\n#SuperMap UDB.\n#:\n#1\n#2\n#3\n#4UDB\n#5\n#===================================================\n \nimport sys\nimport string\nimport re\nimport os\nimport time\n \ndef getType(ext):\n    if ext.lower() == 'tif':\n        return 'fileTIF'\n    elif ext.lower() == 'img':\n        return 'fileIMG'\n \n \n \n#appenddatafiles   \ndef walkPath(type, path):\n    datafiles = []\n    reMatch = '[\\d\\D]*.tif$'\n    if type=='img':\n        reMath = '[\\d\\D]*.img$'\n   \n    for root, dirs, files in os.walk(path):\n        for file in files:\n            if (re.match(reMatch,file)):\n                datafiles.append(os.path.join(root, file))\n    print len(datafiles)               \n    return datafiles\n \ndef calcDatasetInfo(type, datafiles):\n    L=[]       \n    left=[]\n    top=[]\n    right=[]\n    bottom=[]\n    ratiox=[]\n    ratioy=[]\n \n    #\n    for file in datafiles:\n        L= smu.GetImageGeoRef(type,file)\n        print L\n        l=float(L[0][0])\n        t=float(L[0][1])\n        r=float(L[0][2])\n        b=float(L[0][3])\n        w=int(L[1][0])\n        h=int(L[1][1])\n        x=(r-l)/w\n        y=(t-b)/h\n       \n        left.append(l)\n        right.append(r)\n        top.append(t)\n        bottom.append(b)\n        ratiox.append(x)\n        ratioy.append(y)\n \n        #\n        dLeft=min(left)\n        dRight=max(right)\n        dTop=max(top)\n        dBottom=min(bottom)\n       \n        #\n        dRatioX = min(ratiox)\n        dRatioY = min(ratioy)\n       \n        #\n        nWidth = int((dRight-dLeft)/dRatioX)\n        nHeight = int((dTop-dBottom)/dRatioY)\n       \n        #\n        dRight=dLeft+dRatioX*nWidth\n        dBottom=dTop-dRatioY*nHeight\n        L = [nWidth, nHeight, dLeft, dTop, dRight, dBottom]\n   \n    return L\n \ndef toDB(server, user, pwd, engType, fileType, path):\n    files=[]\n    files=walkPath(fileType, path)\n    print len(files)\n    if len(files)>0:\n        L=[]\n        L = calcDatasetInfo(fileType, files)\n        pixType = smu.GetImagePixelFormatName(fileType, files[0])\n \n        odsAlias='test'\n        if len(L)==6:\n            nWidth=L[0]\n            nHeight=L[1]\n            dLeft=L[2]\n            dTop=L[3]\n            dRight=L[4]\n            dBottom=L[5]\n            dtName='test'\n            isOpen=smu.OpenDataSource(server,user,pwd, engType, odsAlias)\n            smu.DeleteDataset(odsAlias, dtName)\n            bCreate = smu.CreateDatasetRaster(odsAlias,dtName,\n                    'Image', 'encDCT', pixType,nWidth,nHeight,\n                    dLeft, dTop,dRight,dBottom,256)\n            writeLog(\"log.log\",\"calcDatasetInfo \")       \n            for file in files:\n                writeLog(\"log.log\",file+\"\")   \n                smu.AppendRasterFile(odsAlias,dtName,fileType, file)\n                writeLog(\"log.log\",file+\"\\n\\n\")      \n            bBuild=smu.BuildPyramid(odsAlias,dtName)#\n            if bBuild == 1:\n                print \"\"\n            else:\n                print \"\"\n            smu.CloseDataSource(odsAlias)\n \n \n#=====================================\ndef writeLog(logPath, tmpstr):\n    time_str = time.strftime(\"%Y-%m-%d %H:%M:%S \",time.localtime())\n    logstr = str(tmpstr) + time_str +'\\n'\n    print(logstr)\n    f = open(logPath, \"a\")\n    f.write(logstr)\n    f.close()\n \n \nhelp =u\"----------------------------------------------------------\\n\\\n:udboracle\\n\\\nUDB: AppendRasterFile.py ugoPath tif c:/data\\n\\\nOracle: AppendRasterFile.py ugoPath server user pwd tif c:/data\\n\\\n----------------------------------------------------------\\n\"\n \nif __name__=='__main__':\n    if len(sys.argv)>2:\n        ugo=sys.argv[1]\n        if os.path.exists(ugo):\n            sys.path.append(ugo)\n            import smu\n        else:\n            print u'.'\n            sys.exit()\n    else:\n        print help\n        sys.exit()\n \n    if len(sys.argv) == 4:\n        engType='sceUDB'\n        fileType=sys.argv[2]\n        fileType=getType(fileType)\n        path=sys.argv[3]\n       \n        udb = path+'/test.udb'\n        udd = path+'/test.udd'\n        if os.path.exists(udb):\n            os.remove(udb)\n        if os.path.exists(udd):\n            os.remove(udd)\n \n        print 'toDB ing'\n        toDB(udb, '', '', engType, fileType, path)\n        smu.Exit()#\n    elif len(sys.argv) == 7:\n        engType='sceOraclePlus'\n        server=sys.argv[2]\n        user=sys.argv[3]\n        pwd=sys.argv[4]\n        fileType=sys.argv[5]\n        fileType=getType(fileType)\n        path=sys.argv[6]\n        toDB(server, user, pwd, engType, fileType, path)\n        smu.Exit()#\n```\n\n\n\n## WMTS\n### \nOGC WMTSxmlWMTSURL\n\n\n1. BaseURL: http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100\n1. SERVICEWMTSWMTS\n1. VERSION1.0.01.0.0\n1. REQUESTGetTile\n1. LAYERSRxml\n1. FORMATimage/pngxmlimage/pngimage/tile\n1. TILEMATRIXSETCustom_SRxml\n1. OFFLEVEL0\n\n### \n1. baseurl\nWMTSxmlhttp://localhost:8090/iserver/services/map-china400/wmts100\n2. xml\nxmlhttp://localhost:8090/iserver/services/\n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920286-906872499.png)\n3. \n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920833-1560746790.png)\n4. url\nurl = 'http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100' + '?' +\n'&SERVICE=WMTS'\n'&VERSION=1.0.0'\n'&REQUEST=GetTile'\n'&LAYER=SR'\n'&FORMAT=image/png'\n'&TILEMATRIXSET=Custom_SR'\n'&OFFLEVEL=0'\n\n\nurl=http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=SR&FORMAT=image/png&TILEMATRIXSET=Custom_SR&OFFLEVEL=0\n\n\n## Leaflet \n### \n1. png\n1. GeoJson\n1. \n\n### \n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Leaflet debug page</title>\n    <link rel=\"stylesheet\" href=\"../dist/leaflet.css\" />\n    <script src=\"../dist/leaflet.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"screen.css\" />\n    <link rel=\"stylesheet\" href=\"../dist/MarkerCluster.css\" />\n    <link rel=\"stylesheet\" href=\"../dist/MarkerCluster.Default.css\" />\n    <script src=\"../dist/leaflet.markercluster-src.js\"></script>\n    <script type=\"text/javascript\" src=\"geojson-sample.js\"></script>\n</head>\n<body>\n    <div id=\"map\"></div>\n    <span>Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds</span>\n    <script type=\"text/javascript\">\n        var geoJsonData = {\n            \"type\": \"FeatureCollection\", \n            \"features\": [\n                { \"type\": \"Feature\", \"id\":\"1\", \"properties\": { \"address\": \"2\"   }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2209316333,31.2210922667 ] } },\n                { \"type\": \"Feature\", \"id\":\"2\", \"properties\": { \"address\": \"151\" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [114.2238417833,31.20975435   ] } },\n                { \"type\": \"Feature\", \"id\":\"3\", \"properties\": { \"address\": \"21\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [112.2169955667,31.218193     ] } },\n                { \"type\": \"Feature\", \"id\":\"4\", \"properties\": { \"address\": \"14\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [112.2240856667,31.2216963    ] } },\n                { \"type\": \"Feature\", \"id\":\"5\", \"properties\": { \"address\": \"38B\" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2196982333,31.2188702167 ] } },\n                { \"type\": \"Feature\", \"id\":\"6\", \"properties\": { \"address\": \"38\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2209942   ,31.2192782833 ] } }\n            ]\n        };\n        <!-- var mymap = L.map('map').setView([31, 113], 10); -->\n        var tiles = L.tileLayer('http://localhost/roadmap/{z}/{x}/{y}.png', {\n            maxZoom: 15,\n            attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        }),latlng = L.latLng(31, 113);\n        var map = L.map('map', {center: latlng, zoom: 10, layers: [tiles]});\n        var geojson = L.geoJson(geoJsonData, {\n            style: function (feature) {\n                return {color: feature.properties.color};\n            },\n            onEachFeature: function (feature, layer) {\n                var popupText = 'geometry type: ' + feature.geometry.type;\n                if (feature.properties.address) {\n                    popupText += '<br/>address: ' + feature.properties.address;\n                }\n                layer.bindPopup(popupText);\n            }\n        });\n        geojson.addLayer(new L.Marker(new L.LatLng(31.745530718801952, 113.194091796875)));\n        var eye1 = new L.Marker(new L.LatLng(30.7250783020332547, 111.8212890625));\n        var eye2 = new L.Marker(new L.LatLng(30.7360637370492077, 113.2275390625));\n        var nose = new L.Marker(new L.LatLng(31.3292264529974207, 112.5463867187));\n        var mouth = new L.Polygon([\n            new L.LatLng(30.3841426927920029, 111.7333984375),\n            new L.LatLng(30.6037944300589726, 111.964111328125),\n            new L.LatLng(31.6806671337507222, 112.249755859375),\n            new L.LatLng(31.7355743631421197, 112.67822265625),\n            new L.LatLng(31.5928123762763,    113.0078125),\n            new L.LatLng(30.3292264529974207, 113.3154296875)\n        ]);\n        var markers = L.markerClusterGroup();\n        markers.addLayer(geojson).addLayers([eye1,eye2,nose,mouth]);\n        map.addLayer(markers);\n    </script>\n</body>\n</html>\n```\n\n## \n\n###  \n```html\n<head>   \n     <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\">\n    <title></title>\n    <!---->\n    <script src=\"./libs/SuperMap.Include.js\"></script>\n    <script type=\"text/javascript\">\n    //maplayerurl\n    function init()\n    {    \n        var map, layer;\n        map = new SuperMap.Map(\"map\",{controls: [                      \n            new SuperMap.Control.ScaleLine(),\n            new SuperMap.Control.Zoom(),\n            new SuperMap.Control.Navigation({\n                dragPanOptions: {\n                                    enableKinetic: true\n                                }\n            })]\n        });\n        // allOverlaystrue\n        map.allOverlays = true;  \n        //,matrixIds\n        // wmts,resolutionsmatrixIds\n        var scales=[2.958293554545656E8,\n                    1.479146777272828E8,\n                    7.39573388636414E7,\n                    3.69786694318207E7,\n                    1.848933471591035E7,\n                    9244667.357955175   ,\n                    4622333.678977588   ,\n                    2311166.839488794   ,\n                    1155583.419744397   ,\n                    577791.7098721985   ,\n                    288895.85493609926  ,\n                    144447.92746804963  ,\n                    72223.96373402482   ,\n                    36111.98186701241   ,\n                    18055.990933506204  ,\n                    90279.95466753103   ,\n                    4513.997733376551   ,\n                    2256.998866688275   ,\n                    1128.499433344138   ,\n                    564.2497166720688];\n        // SuperMap    wmtsTDTmatrixIDresolution        \n        var matrixIds=[],temp,resolutions=[];\n        for(var i=6;i<scales.length;i++){\n            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);\n            resolutions.push(temp);\n            matrixIds[i-6]={identifier:i};//identifier1\n        }\n        \n        //\n        layer0 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LINE/wmtsTDT\",\n              layer: \"LINE_V\",\n              style: \"default\",\n              matrixSet: \"Custom_LINE_V\",\n              format: \"image/png\",\n              resolutions:resolutions,\n              matrixIds:matrixIds,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layer1 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LAKE/wmtsTDT\",\n              layer: \"LAKE_V\",\n              style: \"default\",\n              matrixSet: \"Custom_LAKE_V\",\n              format: \"image/png\",\n              resolutions:resolutions,\n              matrixIds:matrixIds,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        \n        // resolutionmatrixID\n        matrixSetTDT = [];\n        resolutionsTDT = [];        \n        for(var i=6;i<17;i++){\n            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);\n            resolutionsTDT.push(temp);\n            matrixSetTDT[i-6]={identifier:i+1};//identifier1\n        }    \n        // \n        layer2 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",\n              layer: \"vec20140318\",\n              style: \"vec20140318\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        // \n        layerJT = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/JTL140325/wmts\",\n              layer: \"Road325\",\n              style: \"Road325\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        // \n        layerXZ = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",\n              layer: \"vec20140318\",\n              style: \"vec20140318\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layerPOI7_14 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/POI7_17/wmts\",\n              layer: \"POI7_14\",\n              style: \"POI7_14\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //      \n        layerIMGL7_L17s = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/IMGL7_L17/wmts\",\n              layer: \"IMGL7_L17s\",\n              style: \"IMGL7_L17s\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layerPoi325 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHLZJ140325/wmts\",\n              layer: \"Poi325\",\n              style: \"Poi325\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n            \n                  \n        //          \n        map.addLayers([layerXZ ,layer0 ,layer1 ,layer2 ,layerJT ,layerPoi325 ]);      \n        //\n        <!-- map.addLayers([layerIMGL7_L17s,layer0 ,layer1 ,layer2 ,layerJT, layerPOI7_14  ]);       -->\n        map.setCenter(new SuperMap.LonLat(114, 26), 0);          \n    }\n    </script>\n    \n    \n</head>\n<body onload=\"init()\">\n    <!--div-->\n    <div id=\"map\" width=\"100%\" height=\"100%\" >             \n    </div>    \n</body>  \n```\n\n![](http://images2015.cnblogs.com/blog/583396/201512/583396-20151207165038511-1521268624.png)","source":"_posts/webgis.md","raw":"---\ntitle: WebGIS\ndate: 2017-06-04 20:28:03\ntags: WebGIS\ncategories: Develop\n---\n\n\n## \nSuperMap\n1. \n2. \n3. 4R\n\nWebGIS\n<!-- more -->\n## SuperPy Tif\n### \n1. GDALgdalinfo.exeGeoTiff\n1. DOSGeoTiffGeoTiff\n1. GeoTiffType=ByteGeoTiff\n```DOS\nfor /f %i in ('dir /b /s d:\\tifdata\\*.tif ') do @(\n    e:\\gdal1.4.2\\bin\\gdalinfo.exe %i >> e:\\tifstats.log\n    )\n```\n\n### \nSuperMapPyPython2.7.3Deskpro\n\n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020151646630-204827930.gif)\n\n\n``` python\n# coding: GB2312\n \n#===================================================\n#SuperMap UDB.\n#:\n#1\n#2\n#3\n#4UDB\n#5\n#===================================================\n \nimport sys\nimport string\nimport re\nimport os\nimport time\n \ndef getType(ext):\n    if ext.lower() == 'tif':\n        return 'fileTIF'\n    elif ext.lower() == 'img':\n        return 'fileIMG'\n \n \n \n#appenddatafiles   \ndef walkPath(type, path):\n    datafiles = []\n    reMatch = '[\\d\\D]*.tif$'\n    if type=='img':\n        reMath = '[\\d\\D]*.img$'\n   \n    for root, dirs, files in os.walk(path):\n        for file in files:\n            if (re.match(reMatch,file)):\n                datafiles.append(os.path.join(root, file))\n    print len(datafiles)               \n    return datafiles\n \ndef calcDatasetInfo(type, datafiles):\n    L=[]       \n    left=[]\n    top=[]\n    right=[]\n    bottom=[]\n    ratiox=[]\n    ratioy=[]\n \n    #\n    for file in datafiles:\n        L= smu.GetImageGeoRef(type,file)\n        print L\n        l=float(L[0][0])\n        t=float(L[0][1])\n        r=float(L[0][2])\n        b=float(L[0][3])\n        w=int(L[1][0])\n        h=int(L[1][1])\n        x=(r-l)/w\n        y=(t-b)/h\n       \n        left.append(l)\n        right.append(r)\n        top.append(t)\n        bottom.append(b)\n        ratiox.append(x)\n        ratioy.append(y)\n \n        #\n        dLeft=min(left)\n        dRight=max(right)\n        dTop=max(top)\n        dBottom=min(bottom)\n       \n        #\n        dRatioX = min(ratiox)\n        dRatioY = min(ratioy)\n       \n        #\n        nWidth = int((dRight-dLeft)/dRatioX)\n        nHeight = int((dTop-dBottom)/dRatioY)\n       \n        #\n        dRight=dLeft+dRatioX*nWidth\n        dBottom=dTop-dRatioY*nHeight\n        L = [nWidth, nHeight, dLeft, dTop, dRight, dBottom]\n   \n    return L\n \ndef toDB(server, user, pwd, engType, fileType, path):\n    files=[]\n    files=walkPath(fileType, path)\n    print len(files)\n    if len(files)>0:\n        L=[]\n        L = calcDatasetInfo(fileType, files)\n        pixType = smu.GetImagePixelFormatName(fileType, files[0])\n \n        odsAlias='test'\n        if len(L)==6:\n            nWidth=L[0]\n            nHeight=L[1]\n            dLeft=L[2]\n            dTop=L[3]\n            dRight=L[4]\n            dBottom=L[5]\n            dtName='test'\n            isOpen=smu.OpenDataSource(server,user,pwd, engType, odsAlias)\n            smu.DeleteDataset(odsAlias, dtName)\n            bCreate = smu.CreateDatasetRaster(odsAlias,dtName,\n                    'Image', 'encDCT', pixType,nWidth,nHeight,\n                    dLeft, dTop,dRight,dBottom,256)\n            writeLog(\"log.log\",\"calcDatasetInfo \")       \n            for file in files:\n                writeLog(\"log.log\",file+\"\")   \n                smu.AppendRasterFile(odsAlias,dtName,fileType, file)\n                writeLog(\"log.log\",file+\"\\n\\n\")      \n            bBuild=smu.BuildPyramid(odsAlias,dtName)#\n            if bBuild == 1:\n                print \"\"\n            else:\n                print \"\"\n            smu.CloseDataSource(odsAlias)\n \n \n#=====================================\ndef writeLog(logPath, tmpstr):\n    time_str = time.strftime(\"%Y-%m-%d %H:%M:%S \",time.localtime())\n    logstr = str(tmpstr) + time_str +'\\n'\n    print(logstr)\n    f = open(logPath, \"a\")\n    f.write(logstr)\n    f.close()\n \n \nhelp =u\"----------------------------------------------------------\\n\\\n:udboracle\\n\\\nUDB: AppendRasterFile.py ugoPath tif c:/data\\n\\\nOracle: AppendRasterFile.py ugoPath server user pwd tif c:/data\\n\\\n----------------------------------------------------------\\n\"\n \nif __name__=='__main__':\n    if len(sys.argv)>2:\n        ugo=sys.argv[1]\n        if os.path.exists(ugo):\n            sys.path.append(ugo)\n            import smu\n        else:\n            print u'.'\n            sys.exit()\n    else:\n        print help\n        sys.exit()\n \n    if len(sys.argv) == 4:\n        engType='sceUDB'\n        fileType=sys.argv[2]\n        fileType=getType(fileType)\n        path=sys.argv[3]\n       \n        udb = path+'/test.udb'\n        udd = path+'/test.udd'\n        if os.path.exists(udb):\n            os.remove(udb)\n        if os.path.exists(udd):\n            os.remove(udd)\n \n        print 'toDB ing'\n        toDB(udb, '', '', engType, fileType, path)\n        smu.Exit()#\n    elif len(sys.argv) == 7:\n        engType='sceOraclePlus'\n        server=sys.argv[2]\n        user=sys.argv[3]\n        pwd=sys.argv[4]\n        fileType=sys.argv[5]\n        fileType=getType(fileType)\n        path=sys.argv[6]\n        toDB(server, user, pwd, engType, fileType, path)\n        smu.Exit()#\n```\n\n\n\n## WMTS\n### \nOGC WMTSxmlWMTSURL\n\n\n1. BaseURL: http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100\n1. SERVICEWMTSWMTS\n1. VERSION1.0.01.0.0\n1. REQUESTGetTile\n1. LAYERSRxml\n1. FORMATimage/pngxmlimage/pngimage/tile\n1. TILEMATRIXSETCustom_SRxml\n1. OFFLEVEL0\n\n### \n1. baseurl\nWMTSxmlhttp://localhost:8090/iserver/services/map-china400/wmts100\n2. xml\nxmlhttp://localhost:8090/iserver/services/\n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920286-906872499.png)\n3. \n![](http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920833-1560746790.png)\n4. url\nurl = 'http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100' + '?' +\n'&SERVICE=WMTS'\n'&VERSION=1.0.0'\n'&REQUEST=GetTile'\n'&LAYER=SR'\n'&FORMAT=image/png'\n'&TILEMATRIXSET=Custom_SR'\n'&OFFLEVEL=0'\n\n\nurl=http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=SR&FORMAT=image/png&TILEMATRIXSET=Custom_SR&OFFLEVEL=0\n\n\n## Leaflet \n### \n1. png\n1. GeoJson\n1. \n\n### \n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Leaflet debug page</title>\n    <link rel=\"stylesheet\" href=\"../dist/leaflet.css\" />\n    <script src=\"../dist/leaflet.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"screen.css\" />\n    <link rel=\"stylesheet\" href=\"../dist/MarkerCluster.css\" />\n    <link rel=\"stylesheet\" href=\"../dist/MarkerCluster.Default.css\" />\n    <script src=\"../dist/leaflet.markercluster-src.js\"></script>\n    <script type=\"text/javascript\" src=\"geojson-sample.js\"></script>\n</head>\n<body>\n    <div id=\"map\"></div>\n    <span>Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds</span>\n    <script type=\"text/javascript\">\n        var geoJsonData = {\n            \"type\": \"FeatureCollection\", \n            \"features\": [\n                { \"type\": \"Feature\", \"id\":\"1\", \"properties\": { \"address\": \"2\"   }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2209316333,31.2210922667 ] } },\n                { \"type\": \"Feature\", \"id\":\"2\", \"properties\": { \"address\": \"151\" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [114.2238417833,31.20975435   ] } },\n                { \"type\": \"Feature\", \"id\":\"3\", \"properties\": { \"address\": \"21\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [112.2169955667,31.218193     ] } },\n                { \"type\": \"Feature\", \"id\":\"4\", \"properties\": { \"address\": \"14\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [112.2240856667,31.2216963    ] } },\n                { \"type\": \"Feature\", \"id\":\"5\", \"properties\": { \"address\": \"38B\" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2196982333,31.2188702167 ] } },\n                { \"type\": \"Feature\", \"id\":\"6\", \"properties\": { \"address\": \"38\"  }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [113.2209942   ,31.2192782833 ] } }\n            ]\n        };\n        <!-- var mymap = L.map('map').setView([31, 113], 10); -->\n        var tiles = L.tileLayer('http://localhost/roadmap/{z}/{x}/{y}.png', {\n            maxZoom: 15,\n            attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        }),latlng = L.latLng(31, 113);\n        var map = L.map('map', {center: latlng, zoom: 10, layers: [tiles]});\n        var geojson = L.geoJson(geoJsonData, {\n            style: function (feature) {\n                return {color: feature.properties.color};\n            },\n            onEachFeature: function (feature, layer) {\n                var popupText = 'geometry type: ' + feature.geometry.type;\n                if (feature.properties.address) {\n                    popupText += '<br/>address: ' + feature.properties.address;\n                }\n                layer.bindPopup(popupText);\n            }\n        });\n        geojson.addLayer(new L.Marker(new L.LatLng(31.745530718801952, 113.194091796875)));\n        var eye1 = new L.Marker(new L.LatLng(30.7250783020332547, 111.8212890625));\n        var eye2 = new L.Marker(new L.LatLng(30.7360637370492077, 113.2275390625));\n        var nose = new L.Marker(new L.LatLng(31.3292264529974207, 112.5463867187));\n        var mouth = new L.Polygon([\n            new L.LatLng(30.3841426927920029, 111.7333984375),\n            new L.LatLng(30.6037944300589726, 111.964111328125),\n            new L.LatLng(31.6806671337507222, 112.249755859375),\n            new L.LatLng(31.7355743631421197, 112.67822265625),\n            new L.LatLng(31.5928123762763,    113.0078125),\n            new L.LatLng(30.3292264529974207, 113.3154296875)\n        ]);\n        var markers = L.markerClusterGroup();\n        markers.addLayer(geojson).addLayers([eye1,eye2,nose,mouth]);\n        map.addLayer(markers);\n    </script>\n</body>\n</html>\n```\n\n## \n\n###  \n```html\n<head>   \n     <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\">\n    <title></title>\n    <!---->\n    <script src=\"./libs/SuperMap.Include.js\"></script>\n    <script type=\"text/javascript\">\n    //maplayerurl\n    function init()\n    {    \n        var map, layer;\n        map = new SuperMap.Map(\"map\",{controls: [                      \n            new SuperMap.Control.ScaleLine(),\n            new SuperMap.Control.Zoom(),\n            new SuperMap.Control.Navigation({\n                dragPanOptions: {\n                                    enableKinetic: true\n                                }\n            })]\n        });\n        // allOverlaystrue\n        map.allOverlays = true;  \n        //,matrixIds\n        // wmts,resolutionsmatrixIds\n        var scales=[2.958293554545656E8,\n                    1.479146777272828E8,\n                    7.39573388636414E7,\n                    3.69786694318207E7,\n                    1.848933471591035E7,\n                    9244667.357955175   ,\n                    4622333.678977588   ,\n                    2311166.839488794   ,\n                    1155583.419744397   ,\n                    577791.7098721985   ,\n                    288895.85493609926  ,\n                    144447.92746804963  ,\n                    72223.96373402482   ,\n                    36111.98186701241   ,\n                    18055.990933506204  ,\n                    90279.95466753103   ,\n                    4513.997733376551   ,\n                    2256.998866688275   ,\n                    1128.499433344138   ,\n                    564.2497166720688];\n        // SuperMap    wmtsTDTmatrixIDresolution        \n        var matrixIds=[],temp,resolutions=[];\n        for(var i=6;i<scales.length;i++){\n            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);\n            resolutions.push(temp);\n            matrixIds[i-6]={identifier:i};//identifier1\n        }\n        \n        //\n        layer0 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LINE/wmtsTDT\",\n              layer: \"LINE_V\",\n              style: \"default\",\n              matrixSet: \"Custom_LINE_V\",\n              format: \"image/png\",\n              resolutions:resolutions,\n              matrixIds:matrixIds,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layer1 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LAKE/wmtsTDT\",\n              layer: \"LAKE_V\",\n              style: \"default\",\n              matrixSet: \"Custom_LAKE_V\",\n              format: \"image/png\",\n              resolutions:resolutions,\n              matrixIds:matrixIds,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        \n        // resolutionmatrixID\n        matrixSetTDT = [];\n        resolutionsTDT = [];        \n        for(var i=6;i<17;i++){\n            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);\n            resolutionsTDT.push(temp);\n            matrixSetTDT[i-6]={identifier:i+1};//identifier1\n        }    \n        // \n        layer2 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",\n              layer: \"vec20140318\",\n              style: \"vec20140318\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        // \n        layerJT = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/JTL140325/wmts\",\n              layer: \"Road325\",\n              style: \"Road325\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        // \n        layerXZ = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",\n              layer: \"vec20140318\",\n              style: \"vec20140318\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layerPOI7_14 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/POI7_17/wmts\",\n              layer: \"POI7_14\",\n              style: \"POI7_14\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //      \n        layerIMGL7_L17s = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/IMGL7_L17/wmts\",\n              layer: \"IMGL7_L17s\",\n              style: \"IMGL7_L17s\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n        //       \n        layerPoi325 = new SuperMap.Layer.WMTS({\n              url: \"http://10.36.5.70:9010/ZHLZJ140325/wmts\",\n              layer: \"Poi325\",\n              style: \"Poi325\",\n              matrixSet: \"Matrix_0\",\n              format: \"image/tile\",\n              resolutions:resolutionsTDT,\n              matrixIds:matrixSetTDT,\n              opacity: 1,\n              requestEncoding:\"KVP\"});\n            \n                  \n        //          \n        map.addLayers([layerXZ ,layer0 ,layer1 ,layer2 ,layerJT ,layerPoi325 ]);      \n        //\n        <!-- map.addLayers([layerIMGL7_L17s,layer0 ,layer1 ,layer2 ,layerJT, layerPOI7_14  ]);       -->\n        map.setCenter(new SuperMap.LonLat(114, 26), 0);          \n    }\n    </script>\n    \n    \n</head>\n<body onload=\"init()\">\n    <!--div-->\n    <div id=\"map\" width=\"100%\" height=\"100%\" >             \n    </div>    \n</body>  \n```\n\n![](http://images2015.cnblogs.com/blog/583396/201512/583396-20151207165038511-1521268624.png)","slug":"webgis","published":1,"updated":"2017-06-09T13:23:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58sttg000azsr4sw1patt0","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SuperMap</p>\n<ol>\n<li></li>\n<li></li>\n<li>4R</li>\n</ol>\n<p>WebGIS<br><a id=\"more\"></a></p>\n<h2 id=\"SuperPy-Tif\"><a href=\"#SuperPy-Tif\" class=\"headerlink\" title=\"SuperPy Tif\"></a>SuperPy Tif</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>GDALgdalinfo.exeGeoTiff</li>\n<li>DOSGeoTiffGeoTiff</li>\n<li>GeoTiffType=ByteGeoTiff<figure class=\"highlight dos\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> /f %i <span class=\"keyword\">in</span> ('<span class=\"built_in\">dir</span> /b /s d:\\tifdata\\*.tif ') <span class=\"keyword\">do</span> @(</span><br><span class=\"line\"><span class=\"function\">    e:\\<span class=\"title\">gdal1</span>.4.2\\<span class=\"title\">bin</span>\\<span class=\"title\">gdalinfo.exe</span> %<span class=\"title\">i</span> &gt;&gt; <span class=\"title\">e</span>:\\<span class=\"title\">tifstats.log</span></span></span><br><span class=\"line\"><span class=\"function\">    )</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SuperMapPyPython2.7.3Deskpro<br><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020151646630-204827930.gif\" alt=\"\"></p>\n<p><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding: GB2312</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#===================================================</span></span><br><span class=\"line\"><span class=\"comment\">#SuperMap UDB.</span></span><br><span class=\"line\"><span class=\"comment\">#:</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\"><span class=\"comment\">#2</span></span><br><span class=\"line\"><span class=\"comment\">#3</span></span><br><span class=\"line\"><span class=\"comment\">#4UDB</span></span><br><span class=\"line\"><span class=\"comment\">#5</span></span><br><span class=\"line\"><span class=\"comment\">#===================================================</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> string</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getType</span><span class=\"params\">(ext)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ext.lower() == <span class=\"string\">'tif'</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'fileTIF'</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> ext.lower() == <span class=\"string\">'img'</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'fileIMG'</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#appenddatafiles   </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">walkPath</span><span class=\"params\">(type, path)</span>:</span></span><br><span class=\"line\">    datafiles = []</span><br><span class=\"line\">    reMatch = <span class=\"string\">'[\\d\\D]*.tif$'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> type==<span class=\"string\">'img'</span>:</span><br><span class=\"line\">        reMath = <span class=\"string\">'[\\d\\D]*.img$'</span></span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">for</span> root, dirs, files <span class=\"keyword\">in</span> os.walk(path):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (re.match(reMatch,file)):</span><br><span class=\"line\">                datafiles.append(os.path.join(root, file))</span><br><span class=\"line\">    <span class=\"keyword\">print</span> len(datafiles)               </span><br><span class=\"line\">    <span class=\"keyword\">return</span> datafiles</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calcDatasetInfo</span><span class=\"params\">(type, datafiles)</span>:</span></span><br><span class=\"line\">    L=[]       </span><br><span class=\"line\">    left=[]</span><br><span class=\"line\">    top=[]</span><br><span class=\"line\">    right=[]</span><br><span class=\"line\">    bottom=[]</span><br><span class=\"line\">    ratiox=[]</span><br><span class=\"line\">    ratioy=[]</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> datafiles:</span><br><span class=\"line\">        L= smu.GetImageGeoRef(type,file)</span><br><span class=\"line\">        <span class=\"keyword\">print</span> L</span><br><span class=\"line\">        l=float(L[<span class=\"number\">0</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">        t=float(L[<span class=\"number\">0</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">        r=float(L[<span class=\"number\">0</span>][<span class=\"number\">2</span>])</span><br><span class=\"line\">        b=float(L[<span class=\"number\">0</span>][<span class=\"number\">3</span>])</span><br><span class=\"line\">        w=int(L[<span class=\"number\">1</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">        h=int(L[<span class=\"number\">1</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">        x=(r-l)/w</span><br><span class=\"line\">        y=(t-b)/h</span><br><span class=\"line\">       </span><br><span class=\"line\">        left.append(l)</span><br><span class=\"line\">        right.append(r)</span><br><span class=\"line\">        top.append(t)</span><br><span class=\"line\">        bottom.append(b)</span><br><span class=\"line\">        ratiox.append(x)</span><br><span class=\"line\">        ratioy.append(y)</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dLeft=min(left)</span><br><span class=\"line\">        dRight=max(right)</span><br><span class=\"line\">        dTop=max(top)</span><br><span class=\"line\">        dBottom=min(bottom)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dRatioX = min(ratiox)</span><br><span class=\"line\">        dRatioY = min(ratioy)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        nWidth = int((dRight-dLeft)/dRatioX)</span><br><span class=\"line\">        nHeight = int((dTop-dBottom)/dRatioY)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dRight=dLeft+dRatioX*nWidth</span><br><span class=\"line\">        dBottom=dTop-dRatioY*nHeight</span><br><span class=\"line\">        L = [nWidth, nHeight, dLeft, dTop, dRight, dBottom]</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">return</span> L</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">toDB</span><span class=\"params\">(server, user, pwd, engType, fileType, path)</span>:</span></span><br><span class=\"line\">    files=[]</span><br><span class=\"line\">    files=walkPath(fileType, path)</span><br><span class=\"line\">    <span class=\"keyword\">print</span> len(files)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(files)&gt;<span class=\"number\">0</span>:</span><br><span class=\"line\">        L=[]</span><br><span class=\"line\">        L = calcDatasetInfo(fileType, files)</span><br><span class=\"line\">        pixType = smu.GetImagePixelFormatName(fileType, files[<span class=\"number\">0</span>])</span><br><span class=\"line\"> </span><br><span class=\"line\">        odsAlias=<span class=\"string\">'test'</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> len(L)==<span class=\"number\">6</span>:</span><br><span class=\"line\">            nWidth=L[<span class=\"number\">0</span>]</span><br><span class=\"line\">            nHeight=L[<span class=\"number\">1</span>]</span><br><span class=\"line\">            dLeft=L[<span class=\"number\">2</span>]</span><br><span class=\"line\">            dTop=L[<span class=\"number\">3</span>]</span><br><span class=\"line\">            dRight=L[<span class=\"number\">4</span>]</span><br><span class=\"line\">            dBottom=L[<span class=\"number\">5</span>]</span><br><span class=\"line\">            dtName=<span class=\"string\">'test'</span></span><br><span class=\"line\">            isOpen=smu.OpenDataSource(server,user,pwd, engType, odsAlias)</span><br><span class=\"line\">            smu.DeleteDataset(odsAlias, dtName)</span><br><span class=\"line\">            bCreate = smu.CreateDatasetRaster(odsAlias,dtName,</span><br><span class=\"line\">                    <span class=\"string\">'Image'</span>, <span class=\"string\">'encDCT'</span>, pixType,nWidth,nHeight,</span><br><span class=\"line\">                    dLeft, dTop,dRight,dBottom,<span class=\"number\">256</span>)</span><br><span class=\"line\">            writeLog(<span class=\"string\">\"log.log\"</span>,<span class=\"string\">\"calcDatasetInfo \"</span>)       </span><br><span class=\"line\">            <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">                writeLog(<span class=\"string\">\"log.log\"</span>,file+<span class=\"string\">\"\"</span>)   </span><br><span class=\"line\">                smu.AppendRasterFile(odsAlias,dtName,fileType, file)</span><br><span class=\"line\">                writeLog(<span class=\"string\">\"log.log\"</span>,file+<span class=\"string\">\"\\n\\n\"</span>)      </span><br><span class=\"line\">            bBuild=smu.BuildPyramid(odsAlias,dtName)<span class=\"comment\">#</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> bBuild == <span class=\"number\">1</span>:</span><br><span class=\"line\">                <span class=\"keyword\">print</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"keyword\">print</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            smu.CloseDataSource(odsAlias)</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#=====================================</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">writeLog</span><span class=\"params\">(logPath, tmpstr)</span>:</span></span><br><span class=\"line\">    time_str = time.strftime(<span class=\"string\">\"%Y-%m-%d %H:%M:%S \"</span>,time.localtime())</span><br><span class=\"line\">    logstr = str(tmpstr) + time_str +<span class=\"string\">'\\n'</span></span><br><span class=\"line\">    print(logstr)</span><br><span class=\"line\">    f = open(logPath, <span class=\"string\">\"a\"</span>)</span><br><span class=\"line\">    f.write(logstr)</span><br><span class=\"line\">    f.close()</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">help =<span class=\"string\">u\"----------------------------------------------------------\\n\\</span></span><br><span class=\"line\"><span class=\"string\">:udboracle\\n\\</span></span><br><span class=\"line\"><span class=\"string\">UDB: AppendRasterFile.py ugoPath tif c:/data\\n\\</span></span><br><span class=\"line\"><span class=\"string\">Oracle: AppendRasterFile.py ugoPath server user pwd tif c:/data\\n\\</span></span><br><span class=\"line\"><span class=\"string\">----------------------------------------------------------\\n\"</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(sys.argv)&gt;<span class=\"number\">2</span>:</span><br><span class=\"line\">        ugo=sys.argv[<span class=\"number\">1</span>]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(ugo):</span><br><span class=\"line\">            sys.path.append(ugo)</span><br><span class=\"line\">            <span class=\"keyword\">import</span> smu</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">print</span> <span class=\"string\">u'.'</span></span><br><span class=\"line\">            sys.exit()</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> help</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(sys.argv) == <span class=\"number\">4</span>:</span><br><span class=\"line\">        engType=<span class=\"string\">'sceUDB'</span></span><br><span class=\"line\">        fileType=sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">        fileType=getType(fileType)</span><br><span class=\"line\">        path=sys.argv[<span class=\"number\">3</span>]</span><br><span class=\"line\">       </span><br><span class=\"line\">        udb = path+<span class=\"string\">'/test.udb'</span></span><br><span class=\"line\">        udd = path+<span class=\"string\">'/test.udd'</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(udb):</span><br><span class=\"line\">            os.remove(udb)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(udd):</span><br><span class=\"line\">            os.remove(udd)</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">'toDB ing'</span></span><br><span class=\"line\">        toDB(udb, <span class=\"string\">''</span>, <span class=\"string\">''</span>, engType, fileType, path)</span><br><span class=\"line\">        smu.Exit()<span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> len(sys.argv) == <span class=\"number\">7</span>:</span><br><span class=\"line\">        engType=<span class=\"string\">'sceOraclePlus'</span></span><br><span class=\"line\">        server=sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">        user=sys.argv[<span class=\"number\">3</span>]</span><br><span class=\"line\">        pwd=sys.argv[<span class=\"number\">4</span>]</span><br><span class=\"line\">        fileType=sys.argv[<span class=\"number\">5</span>]</span><br><span class=\"line\">        fileType=getType(fileType)</span><br><span class=\"line\">        path=sys.argv[<span class=\"number\">6</span>]</span><br><span class=\"line\">        toDB(server, user, pwd, engType, fileType, path)</span><br><span class=\"line\">        smu.Exit()<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"WMTS\"><a href=\"#WMTS\" class=\"headerlink\" title=\"WMTS\"></a>WMTS</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>OGC WMTSxmlWMTSURL<br></p>\n<ol>\n<li>BaseURL: <a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100</a></li>\n<li>SERVICEWMTSWMTS</li>\n<li>VERSION1.0.01.0.0</li>\n<li>REQUESTGetTile</li>\n<li>LAYERSRxml</li>\n<li>FORMATimage/pngxmlimage/pngimage/tile</li>\n<li>TILEMATRIXSETCustom_SRxml</li>\n<li>OFFLEVEL0</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>baseurl<br>WMTSxml<a href=\"http://localhost:8090/iserver/services/map-china400/wmts100\" target=\"_blank\" rel=\"noopener\">http://localhost:8090/iserver/services/map-china400/wmts100</a></li>\n<li>xml<br>xml<a href=\"http://localhost:8090/iserver/services/\" target=\"_blank\" rel=\"noopener\">http://localhost:8090/iserver/services/</a><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920286-906872499.png\" alt=\"\"></li>\n<li><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920833-1560746790.png\" alt=\"\"></li>\n<li>url<br>url = <a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100&#39;\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100&#39;</a> + ? +<br>&amp;SERVICE=WMTS<br>&amp;VERSION=1.0.0<br>&amp;REQUEST=GetTile<br>&amp;LAYER=SR<br>&amp;FORMAT=image/png<br>&amp;TILEMATRIXSET=Custom_SR<br>&amp;OFFLEVEL=0</li>\n</ol>\n<p><br>url=<a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&amp;SERVICE=WMTS&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;LAYER=SR&amp;FORMAT=image/png&amp;TILEMATRIXSET=Custom_SR&amp;OFFLEVEL=0\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&amp;SERVICE=WMTS&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;LAYER=SR&amp;FORMAT=image/png&amp;TILEMATRIXSET=Custom_SR&amp;OFFLEVEL=0</a></p>\n<h2 id=\"Leaflet-\"><a href=\"#Leaflet-\" class=\"headerlink\" title=\"Leaflet \"></a>Leaflet </h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>png</li>\n<li>GeoJson</li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Leaflet debug page<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/leaflet.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../dist/leaflet.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"screen.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/MarkerCluster.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/MarkerCluster.Default.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../dist/leaflet.markercluster-src.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"geojson-sample.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">        var geoJsonData = &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            \"type\": \"FeatureCollection\", </span></span><br><span class=\"line\"><span class=\"undefined\">            \"features\": [</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"1\", \"properties\": &#123; \"address\": \"2\"   &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209316333,31.2210922667 ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"2\", \"properties\": &#123; \"address\": \"151\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [114.2238417833,31.20975435   ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"3\", \"properties\": &#123; \"address\": \"21\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2169955667,31.218193     ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"4\", \"properties\": &#123; \"address\": \"14\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2240856667,31.2216963    ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"5\", \"properties\": &#123; \"address\": \"38B\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2196982333,31.2188702167 ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"6\", \"properties\": &#123; \"address\": \"38\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209942   ,31.2192782833 ] &#125; &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            ]</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"comment\">&lt;!-- var mymap = L.map('map').setView([31, 113], 10); --&gt;</span></span></span><br><span class=\"line\"><span class=\"undefined\">        var tiles = L.tileLayer('http://localhost/roadmap/&#123;z&#125;/&#123;x&#125;/&#123;y&#125;.png', &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            maxZoom: 15,</span></span><br><span class=\"line\"><span class=\"xml\">            attribution: '&amp;copy; <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://osm.org/copyright\"</span>&gt;</span>OpenStreetMap<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span> contributors'</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;),latlng = L.latLng(31, 113);</span></span><br><span class=\"line\"><span class=\"undefined\">        var map = L.map('map', &#123;center: latlng, zoom: 10, layers: [tiles]&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        var geojson = L.geoJson(geoJsonData, &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            style: function (feature) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                return &#123;color: feature.properties.color&#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">            onEachFeature: function (feature, layer) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                var popupText = 'geometry type: ' + feature.geometry.type;</span></span><br><span class=\"line\"><span class=\"undefined\">                if (feature.properties.address) &#123;</span></span><br><span class=\"line\"><span class=\"xml\">                    popupText += '<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span>address: ' + feature.properties.address;</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">                layer.bindPopup(popupText);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        geojson.addLayer(new L.Marker(new L.LatLng(31.745530718801952, 113.194091796875)));</span></span><br><span class=\"line\"><span class=\"undefined\">        var eye1 = new L.Marker(new L.LatLng(30.7250783020332547, 111.8212890625));</span></span><br><span class=\"line\"><span class=\"undefined\">        var eye2 = new L.Marker(new L.LatLng(30.7360637370492077, 113.2275390625));</span></span><br><span class=\"line\"><span class=\"undefined\">        var nose = new L.Marker(new L.LatLng(31.3292264529974207, 112.5463867187));</span></span><br><span class=\"line\"><span class=\"undefined\">        var mouth = new L.Polygon([</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.3841426927920029, 111.7333984375),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.6037944300589726, 111.964111328125),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.6806671337507222, 112.249755859375),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.7355743631421197, 112.67822265625),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.5928123762763,    113.0078125),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.3292264529974207, 113.3154296875)</span></span><br><span class=\"line\"><span class=\"undefined\">        ]);</span></span><br><span class=\"line\"><span class=\"undefined\">        var markers = L.markerClusterGroup();</span></span><br><span class=\"line\"><span class=\"undefined\">        markers.addLayer(geojson).addLayers([eye1,eye2,nose,mouth]);</span></span><br><span class=\"line\"><span class=\"undefined\">        map.addLayer(markers);</span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span>   </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"content-type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./libs/SuperMap.Include.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">    //maplayerurl</span></span><br><span class=\"line\"><span class=\"undefined\">    function init()</span></span><br><span class=\"line\"><span class=\"undefined\">    &#123;    </span></span><br><span class=\"line\"><span class=\"undefined\">        var map, layer;</span></span><br><span class=\"line\"><span class=\"undefined\">        map = new SuperMap.Map(\"map\",&#123;controls: [                      </span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.ScaleLine(),</span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.Zoom(),</span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.Navigation(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                dragPanOptions: &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                                    enableKinetic: true</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;)]</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // allOverlaystrue</span></span><br><span class=\"line\"><span class=\"undefined\">        map.allOverlays = true;  </span></span><br><span class=\"line\"><span class=\"undefined\">        //,matrixIds</span></span><br><span class=\"line\"><span class=\"undefined\">        // wmts,resolutionsmatrixIds</span></span><br><span class=\"line\"><span class=\"undefined\">        var scales=[2.958293554545656E8,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1.479146777272828E8,</span></span><br><span class=\"line\"><span class=\"undefined\">                    7.39573388636414E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    3.69786694318207E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1.848933471591035E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    9244667.357955175   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    4622333.678977588   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    2311166.839488794   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1155583.419744397   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    577791.7098721985   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    288895.85493609926  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    144447.92746804963  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    72223.96373402482   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    36111.98186701241   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    18055.990933506204  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    90279.95466753103   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    4513.997733376551   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    2256.998866688275   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1128.499433344138   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    564.2497166720688];</span></span><br><span class=\"line\"><span class=\"undefined\">        // SuperMap    wmtsTDTmatrixIDresolution        </span></span><br><span class=\"line\"><span class=\"undefined\">        var matrixIds=[],temp,resolutions=[];</span></span><br><span class=\"line\"><span class=\"undefined\">        for(var i=6;i&lt;scales.length;i++)&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);</span></span><br><span class=\"line\"><span class=\"undefined\">            resolutions.push(temp);</span></span><br><span class=\"line\"><span class=\"undefined\">            matrixIds[i-6]=&#123;identifier:i&#125;;//identifier1</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        </span></span><br><span class=\"line\"><span class=\"undefined\">        //</span></span><br><span class=\"line\"><span class=\"undefined\">        layer0 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LINE/wmtsTDT\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"LINE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"default\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Custom_LINE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/png\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutions,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixIds,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layer1 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LAKE/wmtsTDT\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"LAKE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"default\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Custom_LAKE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/png\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutions,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixIds,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        </span></span><br><span class=\"line\"><span class=\"undefined\">        // resolutionmatrixID</span></span><br><span class=\"line\"><span class=\"undefined\">        matrixSetTDT = [];</span></span><br><span class=\"line\"><span class=\"undefined\">        resolutionsTDT = [];        </span></span><br><span class=\"line\"><span class=\"undefined\">        for(var i=6;i&lt;17;i++)&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);</span></span><br><span class=\"line\"><span class=\"undefined\">            resolutionsTDT.push(temp);</span></span><br><span class=\"line\"><span class=\"undefined\">            matrixSetTDT[i-6]=&#123;identifier:i+1&#125;;//identifier1</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;    </span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layer2 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layerJT = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/JTL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"Road325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"Road325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layerXZ = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layerPOI7_14 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/POI7_17/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"POI7_14\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"POI7_14\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //      </span></span><br><span class=\"line\"><span class=\"undefined\">        layerIMGL7_L17s = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/IMGL7_L17/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"IMGL7_L17s\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"IMGL7_L17s\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layerPoi325 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHLZJ140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"Poi325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"Poi325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">            </span></span><br><span class=\"line\"><span class=\"undefined\">                  </span></span><br><span class=\"line\"><span class=\"undefined\">        //          </span></span><br><span class=\"line\"><span class=\"undefined\">        map.addLayers([layerXZ ,layer0 ,layer1 ,layer2 ,layerJT ,layerPoi325 ]);      </span></span><br><span class=\"line\"><span class=\"undefined\">        //</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"comment\">&lt;!-- map.addLayers([layerIMGL7_L17s,layer0 ,layer1 ,layer2 ,layerJT, layerPOI7_14  ]);       --&gt;</span></span></span><br><span class=\"line\"><span class=\"undefined\">        map.setCenter(new SuperMap.LonLat(114, 26), 0);          </span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">\"init()\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--div--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100%\"</span> <span class=\"attr\">height</span>=<span class=\"string\">\"100%\"</span> &gt;</span>             </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"http://images2015.cnblogs.com/blog/583396/201512/583396-20151207165038511-1521268624.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SuperMap</p>\n<ol>\n<li></li>\n<li></li>\n<li>4R</li>\n</ol>\n<p>WebGIS<br>","more":"</p>\n<h2 id=\"SuperPy-Tif\"><a href=\"#SuperPy-Tif\" class=\"headerlink\" title=\"SuperPy Tif\"></a>SuperPy Tif</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>GDALgdalinfo.exeGeoTiff</li>\n<li>DOSGeoTiffGeoTiff</li>\n<li>GeoTiffType=ByteGeoTiff<figure class=\"highlight dos\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> /f %i <span class=\"keyword\">in</span> ('<span class=\"built_in\">dir</span> /b /s d:\\tifdata\\*.tif ') <span class=\"keyword\">do</span> @(</span><br><span class=\"line\"><span class=\"function\">    e:\\<span class=\"title\">gdal1</span>.4.2\\<span class=\"title\">bin</span>\\<span class=\"title\">gdalinfo.exe</span> %<span class=\"title\">i</span> &gt;&gt; <span class=\"title\">e</span>:\\<span class=\"title\">tifstats.log</span></span></span><br><span class=\"line\"><span class=\"function\">    )</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SuperMapPyPython2.7.3Deskpro<br><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020151646630-204827930.gif\" alt=\"\"></p>\n<p><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding: GB2312</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#===================================================</span></span><br><span class=\"line\"><span class=\"comment\">#SuperMap UDB.</span></span><br><span class=\"line\"><span class=\"comment\">#:</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\"><span class=\"comment\">#2</span></span><br><span class=\"line\"><span class=\"comment\">#3</span></span><br><span class=\"line\"><span class=\"comment\">#4UDB</span></span><br><span class=\"line\"><span class=\"comment\">#5</span></span><br><span class=\"line\"><span class=\"comment\">#===================================================</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> string</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getType</span><span class=\"params\">(ext)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ext.lower() == <span class=\"string\">'tif'</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'fileTIF'</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> ext.lower() == <span class=\"string\">'img'</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'fileIMG'</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#appenddatafiles   </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">walkPath</span><span class=\"params\">(type, path)</span>:</span></span><br><span class=\"line\">    datafiles = []</span><br><span class=\"line\">    reMatch = <span class=\"string\">'[\\d\\D]*.tif$'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> type==<span class=\"string\">'img'</span>:</span><br><span class=\"line\">        reMath = <span class=\"string\">'[\\d\\D]*.img$'</span></span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">for</span> root, dirs, files <span class=\"keyword\">in</span> os.walk(path):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (re.match(reMatch,file)):</span><br><span class=\"line\">                datafiles.append(os.path.join(root, file))</span><br><span class=\"line\">    <span class=\"keyword\">print</span> len(datafiles)               </span><br><span class=\"line\">    <span class=\"keyword\">return</span> datafiles</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calcDatasetInfo</span><span class=\"params\">(type, datafiles)</span>:</span></span><br><span class=\"line\">    L=[]       </span><br><span class=\"line\">    left=[]</span><br><span class=\"line\">    top=[]</span><br><span class=\"line\">    right=[]</span><br><span class=\"line\">    bottom=[]</span><br><span class=\"line\">    ratiox=[]</span><br><span class=\"line\">    ratioy=[]</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> datafiles:</span><br><span class=\"line\">        L= smu.GetImageGeoRef(type,file)</span><br><span class=\"line\">        <span class=\"keyword\">print</span> L</span><br><span class=\"line\">        l=float(L[<span class=\"number\">0</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">        t=float(L[<span class=\"number\">0</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">        r=float(L[<span class=\"number\">0</span>][<span class=\"number\">2</span>])</span><br><span class=\"line\">        b=float(L[<span class=\"number\">0</span>][<span class=\"number\">3</span>])</span><br><span class=\"line\">        w=int(L[<span class=\"number\">1</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">        h=int(L[<span class=\"number\">1</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">        x=(r-l)/w</span><br><span class=\"line\">        y=(t-b)/h</span><br><span class=\"line\">       </span><br><span class=\"line\">        left.append(l)</span><br><span class=\"line\">        right.append(r)</span><br><span class=\"line\">        top.append(t)</span><br><span class=\"line\">        bottom.append(b)</span><br><span class=\"line\">        ratiox.append(x)</span><br><span class=\"line\">        ratioy.append(y)</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dLeft=min(left)</span><br><span class=\"line\">        dRight=max(right)</span><br><span class=\"line\">        dTop=max(top)</span><br><span class=\"line\">        dBottom=min(bottom)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dRatioX = min(ratiox)</span><br><span class=\"line\">        dRatioY = min(ratioy)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        nWidth = int((dRight-dLeft)/dRatioX)</span><br><span class=\"line\">        nHeight = int((dTop-dBottom)/dRatioY)</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"comment\">#</span></span><br><span class=\"line\">        dRight=dLeft+dRatioX*nWidth</span><br><span class=\"line\">        dBottom=dTop-dRatioY*nHeight</span><br><span class=\"line\">        L = [nWidth, nHeight, dLeft, dTop, dRight, dBottom]</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">return</span> L</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">toDB</span><span class=\"params\">(server, user, pwd, engType, fileType, path)</span>:</span></span><br><span class=\"line\">    files=[]</span><br><span class=\"line\">    files=walkPath(fileType, path)</span><br><span class=\"line\">    <span class=\"keyword\">print</span> len(files)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(files)&gt;<span class=\"number\">0</span>:</span><br><span class=\"line\">        L=[]</span><br><span class=\"line\">        L = calcDatasetInfo(fileType, files)</span><br><span class=\"line\">        pixType = smu.GetImagePixelFormatName(fileType, files[<span class=\"number\">0</span>])</span><br><span class=\"line\"> </span><br><span class=\"line\">        odsAlias=<span class=\"string\">'test'</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> len(L)==<span class=\"number\">6</span>:</span><br><span class=\"line\">            nWidth=L[<span class=\"number\">0</span>]</span><br><span class=\"line\">            nHeight=L[<span class=\"number\">1</span>]</span><br><span class=\"line\">            dLeft=L[<span class=\"number\">2</span>]</span><br><span class=\"line\">            dTop=L[<span class=\"number\">3</span>]</span><br><span class=\"line\">            dRight=L[<span class=\"number\">4</span>]</span><br><span class=\"line\">            dBottom=L[<span class=\"number\">5</span>]</span><br><span class=\"line\">            dtName=<span class=\"string\">'test'</span></span><br><span class=\"line\">            isOpen=smu.OpenDataSource(server,user,pwd, engType, odsAlias)</span><br><span class=\"line\">            smu.DeleteDataset(odsAlias, dtName)</span><br><span class=\"line\">            bCreate = smu.CreateDatasetRaster(odsAlias,dtName,</span><br><span class=\"line\">                    <span class=\"string\">'Image'</span>, <span class=\"string\">'encDCT'</span>, pixType,nWidth,nHeight,</span><br><span class=\"line\">                    dLeft, dTop,dRight,dBottom,<span class=\"number\">256</span>)</span><br><span class=\"line\">            writeLog(<span class=\"string\">\"log.log\"</span>,<span class=\"string\">\"calcDatasetInfo \"</span>)       </span><br><span class=\"line\">            <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">                writeLog(<span class=\"string\">\"log.log\"</span>,file+<span class=\"string\">\"\"</span>)   </span><br><span class=\"line\">                smu.AppendRasterFile(odsAlias,dtName,fileType, file)</span><br><span class=\"line\">                writeLog(<span class=\"string\">\"log.log\"</span>,file+<span class=\"string\">\"\\n\\n\"</span>)      </span><br><span class=\"line\">            bBuild=smu.BuildPyramid(odsAlias,dtName)<span class=\"comment\">#</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> bBuild == <span class=\"number\">1</span>:</span><br><span class=\"line\">                <span class=\"keyword\">print</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"keyword\">print</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            smu.CloseDataSource(odsAlias)</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#=====================================</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">writeLog</span><span class=\"params\">(logPath, tmpstr)</span>:</span></span><br><span class=\"line\">    time_str = time.strftime(<span class=\"string\">\"%Y-%m-%d %H:%M:%S \"</span>,time.localtime())</span><br><span class=\"line\">    logstr = str(tmpstr) + time_str +<span class=\"string\">'\\n'</span></span><br><span class=\"line\">    print(logstr)</span><br><span class=\"line\">    f = open(logPath, <span class=\"string\">\"a\"</span>)</span><br><span class=\"line\">    f.write(logstr)</span><br><span class=\"line\">    f.close()</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">help =<span class=\"string\">u\"----------------------------------------------------------\\n\\</span></span><br><span class=\"line\"><span class=\"string\">:udboracle\\n\\</span></span><br><span class=\"line\"><span class=\"string\">UDB: AppendRasterFile.py ugoPath tif c:/data\\n\\</span></span><br><span class=\"line\"><span class=\"string\">Oracle: AppendRasterFile.py ugoPath server user pwd tif c:/data\\n\\</span></span><br><span class=\"line\"><span class=\"string\">----------------------------------------------------------\\n\"</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(sys.argv)&gt;<span class=\"number\">2</span>:</span><br><span class=\"line\">        ugo=sys.argv[<span class=\"number\">1</span>]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(ugo):</span><br><span class=\"line\">            sys.path.append(ugo)</span><br><span class=\"line\">            <span class=\"keyword\">import</span> smu</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">print</span> <span class=\"string\">u'.'</span></span><br><span class=\"line\">            sys.exit()</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> help</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(sys.argv) == <span class=\"number\">4</span>:</span><br><span class=\"line\">        engType=<span class=\"string\">'sceUDB'</span></span><br><span class=\"line\">        fileType=sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">        fileType=getType(fileType)</span><br><span class=\"line\">        path=sys.argv[<span class=\"number\">3</span>]</span><br><span class=\"line\">       </span><br><span class=\"line\">        udb = path+<span class=\"string\">'/test.udb'</span></span><br><span class=\"line\">        udd = path+<span class=\"string\">'/test.udd'</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(udb):</span><br><span class=\"line\">            os.remove(udb)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.path.exists(udd):</span><br><span class=\"line\">            os.remove(udd)</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">'toDB ing'</span></span><br><span class=\"line\">        toDB(udb, <span class=\"string\">''</span>, <span class=\"string\">''</span>, engType, fileType, path)</span><br><span class=\"line\">        smu.Exit()<span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> len(sys.argv) == <span class=\"number\">7</span>:</span><br><span class=\"line\">        engType=<span class=\"string\">'sceOraclePlus'</span></span><br><span class=\"line\">        server=sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">        user=sys.argv[<span class=\"number\">3</span>]</span><br><span class=\"line\">        pwd=sys.argv[<span class=\"number\">4</span>]</span><br><span class=\"line\">        fileType=sys.argv[<span class=\"number\">5</span>]</span><br><span class=\"line\">        fileType=getType(fileType)</span><br><span class=\"line\">        path=sys.argv[<span class=\"number\">6</span>]</span><br><span class=\"line\">        toDB(server, user, pwd, engType, fileType, path)</span><br><span class=\"line\">        smu.Exit()<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"WMTS\"><a href=\"#WMTS\" class=\"headerlink\" title=\"WMTS\"></a>WMTS</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>OGC WMTSxmlWMTSURL<br></p>\n<ol>\n<li>BaseURL: <a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100</a></li>\n<li>SERVICEWMTSWMTS</li>\n<li>VERSION1.0.01.0.0</li>\n<li>REQUESTGetTile</li>\n<li>LAYERSRxml</li>\n<li>FORMATimage/pngxmlimage/pngimage/tile</li>\n<li>TILEMATRIXSETCustom_SRxml</li>\n<li>OFFLEVEL0</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>baseurl<br>WMTSxml<a href=\"http://localhost:8090/iserver/services/map-china400/wmts100\" target=\"_blank\" rel=\"noopener\">http://localhost:8090/iserver/services/map-china400/wmts100</a></li>\n<li>xml<br>xml<a href=\"http://localhost:8090/iserver/services/\" target=\"_blank\" rel=\"noopener\">http://localhost:8090/iserver/services/</a><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920286-906872499.png\" alt=\"\"></li>\n<li><br><img src=\"http://images2015.cnblogs.com/blog/583396/201510/583396-20151020092920833-1560746790.png\" alt=\"\"></li>\n<li>url<br>url = <a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100&#39;\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100&#39;</a> + ? +<br>&amp;SERVICE=WMTS<br>&amp;VERSION=1.0.0<br>&amp;REQUEST=GetTile<br>&amp;LAYER=SR<br>&amp;FORMAT=image/png<br>&amp;TILEMATRIXSET=Custom_SR<br>&amp;OFFLEVEL=0</li>\n</ol>\n<p><br>url=<a href=\"http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&amp;SERVICE=WMTS&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;LAYER=SR&amp;FORMAT=image/png&amp;TILEMATRIXSET=Custom_SR&amp;OFFLEVEL=0\" target=\"_blank\" rel=\"noopener\">http://10.36.5.46:8080/iserver/services/map-JXDJS/wmts100?&amp;SERVICE=WMTS&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;LAYER=SR&amp;FORMAT=image/png&amp;TILEMATRIXSET=Custom_SR&amp;OFFLEVEL=0</a></p>\n<h2 id=\"Leaflet-\"><a href=\"#Leaflet-\" class=\"headerlink\" title=\"Leaflet \"></a>Leaflet </h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>png</li>\n<li>GeoJson</li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Leaflet debug page<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/leaflet.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../dist/leaflet.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"screen.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/MarkerCluster.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"../dist/MarkerCluster.Default.css\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../dist/leaflet.markercluster-src.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"geojson-sample.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">        var geoJsonData = &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            \"type\": \"FeatureCollection\", </span></span><br><span class=\"line\"><span class=\"undefined\">            \"features\": [</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"1\", \"properties\": &#123; \"address\": \"2\"   &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209316333,31.2210922667 ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"2\", \"properties\": &#123; \"address\": \"151\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [114.2238417833,31.20975435   ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"3\", \"properties\": &#123; \"address\": \"21\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2169955667,31.218193     ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"4\", \"properties\": &#123; \"address\": \"14\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [112.2240856667,31.2216963    ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"5\", \"properties\": &#123; \"address\": \"38B\" &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2196982333,31.2188702167 ] &#125; &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">                &#123; \"type\": \"Feature\", \"id\":\"6\", \"properties\": &#123; \"address\": \"38\"  &#125;, \"geometry\": &#123; \"type\": \"Point\", \"coordinates\": [113.2209942   ,31.2192782833 ] &#125; &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            ]</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"comment\">&lt;!-- var mymap = L.map('map').setView([31, 113], 10); --&gt;</span></span></span><br><span class=\"line\"><span class=\"undefined\">        var tiles = L.tileLayer('http://localhost/roadmap/&#123;z&#125;/&#123;x&#125;/&#123;y&#125;.png', &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            maxZoom: 15,</span></span><br><span class=\"line\"><span class=\"xml\">            attribution: '&amp;copy; <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://osm.org/copyright\"</span>&gt;</span>OpenStreetMap<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span> contributors'</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;),latlng = L.latLng(31, 113);</span></span><br><span class=\"line\"><span class=\"undefined\">        var map = L.map('map', &#123;center: latlng, zoom: 10, layers: [tiles]&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        var geojson = L.geoJson(geoJsonData, &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            style: function (feature) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                return &#123;color: feature.properties.color&#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;,</span></span><br><span class=\"line\"><span class=\"undefined\">            onEachFeature: function (feature, layer) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                var popupText = 'geometry type: ' + feature.geometry.type;</span></span><br><span class=\"line\"><span class=\"undefined\">                if (feature.properties.address) &#123;</span></span><br><span class=\"line\"><span class=\"xml\">                    popupText += '<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span>address: ' + feature.properties.address;</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">                layer.bindPopup(popupText);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        geojson.addLayer(new L.Marker(new L.LatLng(31.745530718801952, 113.194091796875)));</span></span><br><span class=\"line\"><span class=\"undefined\">        var eye1 = new L.Marker(new L.LatLng(30.7250783020332547, 111.8212890625));</span></span><br><span class=\"line\"><span class=\"undefined\">        var eye2 = new L.Marker(new L.LatLng(30.7360637370492077, 113.2275390625));</span></span><br><span class=\"line\"><span class=\"undefined\">        var nose = new L.Marker(new L.LatLng(31.3292264529974207, 112.5463867187));</span></span><br><span class=\"line\"><span class=\"undefined\">        var mouth = new L.Polygon([</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.3841426927920029, 111.7333984375),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.6037944300589726, 111.964111328125),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.6806671337507222, 112.249755859375),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.7355743631421197, 112.67822265625),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(31.5928123762763,    113.0078125),</span></span><br><span class=\"line\"><span class=\"undefined\">            new L.LatLng(30.3292264529974207, 113.3154296875)</span></span><br><span class=\"line\"><span class=\"undefined\">        ]);</span></span><br><span class=\"line\"><span class=\"undefined\">        var markers = L.markerClusterGroup();</span></span><br><span class=\"line\"><span class=\"undefined\">        markers.addLayer(geojson).addLayers([eye1,eye2,nose,mouth]);</span></span><br><span class=\"line\"><span class=\"undefined\">        map.addLayer(markers);</span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span>   </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"content-type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./libs/SuperMap.Include.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">    //maplayerurl</span></span><br><span class=\"line\"><span class=\"undefined\">    function init()</span></span><br><span class=\"line\"><span class=\"undefined\">    &#123;    </span></span><br><span class=\"line\"><span class=\"undefined\">        var map, layer;</span></span><br><span class=\"line\"><span class=\"undefined\">        map = new SuperMap.Map(\"map\",&#123;controls: [                      </span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.ScaleLine(),</span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.Zoom(),</span></span><br><span class=\"line\"><span class=\"undefined\">            new SuperMap.Control.Navigation(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                dragPanOptions: &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                                    enableKinetic: true</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;)]</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // allOverlaystrue</span></span><br><span class=\"line\"><span class=\"undefined\">        map.allOverlays = true;  </span></span><br><span class=\"line\"><span class=\"undefined\">        //,matrixIds</span></span><br><span class=\"line\"><span class=\"undefined\">        // wmts,resolutionsmatrixIds</span></span><br><span class=\"line\"><span class=\"undefined\">        var scales=[2.958293554545656E8,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1.479146777272828E8,</span></span><br><span class=\"line\"><span class=\"undefined\">                    7.39573388636414E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    3.69786694318207E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1.848933471591035E7,</span></span><br><span class=\"line\"><span class=\"undefined\">                    9244667.357955175   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    4622333.678977588   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    2311166.839488794   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1155583.419744397   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    577791.7098721985   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    288895.85493609926  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    144447.92746804963  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    72223.96373402482   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    36111.98186701241   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    18055.990933506204  ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    90279.95466753103   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    4513.997733376551   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    2256.998866688275   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    1128.499433344138   ,</span></span><br><span class=\"line\"><span class=\"undefined\">                    564.2497166720688];</span></span><br><span class=\"line\"><span class=\"undefined\">        // SuperMap    wmtsTDTmatrixIDresolution        </span></span><br><span class=\"line\"><span class=\"undefined\">        var matrixIds=[],temp,resolutions=[];</span></span><br><span class=\"line\"><span class=\"undefined\">        for(var i=6;i&lt;scales.length;i++)&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);</span></span><br><span class=\"line\"><span class=\"undefined\">            resolutions.push(temp);</span></span><br><span class=\"line\"><span class=\"undefined\">            matrixIds[i-6]=&#123;identifier:i&#125;;//identifier1</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        </span></span><br><span class=\"line\"><span class=\"undefined\">        //</span></span><br><span class=\"line\"><span class=\"undefined\">        layer0 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LINE/wmtsTDT\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"LINE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"default\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Custom_LINE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/png\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutions,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixIds,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layer1 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.46:8080/iserver/services/map-JX_LAKE/wmtsTDT\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"LAKE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"default\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Custom_LAKE_V\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/png\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutions,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixIds,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        </span></span><br><span class=\"line\"><span class=\"undefined\">        // resolutionmatrixID</span></span><br><span class=\"line\"><span class=\"undefined\">        matrixSetTDT = [];</span></span><br><span class=\"line\"><span class=\"undefined\">        resolutionsTDT = [];        </span></span><br><span class=\"line\"><span class=\"undefined\">        for(var i=6;i&lt;17;i++)&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            temp=SuperMap.Util.getResolutionFromScaleDpi(scales[i],96,\"degree\",6378137);</span></span><br><span class=\"line\"><span class=\"undefined\">            resolutionsTDT.push(temp);</span></span><br><span class=\"line\"><span class=\"undefined\">            matrixSetTDT[i-6]=&#123;identifier:i+1&#125;;//identifier1</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;    </span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layer2 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layerJT = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/JTL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"Road325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"Road325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        // </span></span><br><span class=\"line\"><span class=\"undefined\">        layerXZ = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHL140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"vec20140318\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layerPOI7_14 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/POI7_17/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"POI7_14\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"POI7_14\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //      </span></span><br><span class=\"line\"><span class=\"undefined\">        layerIMGL7_L17s = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/IMGL7_L17/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"IMGL7_L17s\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"IMGL7_L17s\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">        //       </span></span><br><span class=\"line\"><span class=\"undefined\">        layerPoi325 = new SuperMap.Layer.WMTS(&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">              url: \"http://10.36.5.70:9010/ZHLZJ140325/wmts\",</span></span><br><span class=\"line\"><span class=\"undefined\">              layer: \"Poi325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              style: \"Poi325\",</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixSet: \"Matrix_0\",</span></span><br><span class=\"line\"><span class=\"undefined\">              format: \"image/tile\",</span></span><br><span class=\"line\"><span class=\"undefined\">              resolutions:resolutionsTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              matrixIds:matrixSetTDT,</span></span><br><span class=\"line\"><span class=\"undefined\">              opacity: 1,</span></span><br><span class=\"line\"><span class=\"undefined\">              requestEncoding:\"KVP\"&#125;);</span></span><br><span class=\"line\"><span class=\"undefined\">            </span></span><br><span class=\"line\"><span class=\"undefined\">                  </span></span><br><span class=\"line\"><span class=\"undefined\">        //          </span></span><br><span class=\"line\"><span class=\"undefined\">        map.addLayers([layerXZ ,layer0 ,layer1 ,layer2 ,layerJT ,layerPoi325 ]);      </span></span><br><span class=\"line\"><span class=\"undefined\">        //</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"comment\">&lt;!-- map.addLayers([layerIMGL7_L17s,layer0 ,layer1 ,layer2 ,layerJT, layerPOI7_14  ]);       --&gt;</span></span></span><br><span class=\"line\"><span class=\"undefined\">        map.setCenter(new SuperMap.LonLat(114, 26), 0);          </span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">\"init()\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--div--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100%\"</span> <span class=\"attr\">height</span>=<span class=\"string\">\"100%\"</span> &gt;</span>             </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"http://images2015.cnblogs.com/blog/583396/201512/583396-20151207165038511-1521268624.png\" alt=\"\"></p>"},{"title":"Office VBA","date":"2017-04-25T05:13:06.000Z","_content":"\n## Word\n### \ndoc\n\n<!--more-->\n### \n``` vb\n\n' -------------------------------------------------------------------------\n' doc\n' wishmo@tom.com\n' 2017425\n\nFunction docReplace(fullpath, searchStr, replaceStr)\n    Application.ScreenUpdating = False\n    Dim myDoc As Document\n    Set myDoc = Documents.Open(FileName:=(fullpath))\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = searchStr\n        .Replacement.Text = replaceStr\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchByte = True\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n    myDoc.Save\n    myDoc.Close\n    Set myDoc = Nothing\n    Application.ScreenUpdating = True\nEnd Function\n\n' ------------------------------------------------------------------------\nFunction getDir()\n    Dim myPath As String\n    ' \n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"\"\n        If .Show = -1 Then\n            myPath = .SelectedItems(1)\n        Else\n            Exit Function\n        End If\n    End With\n    getDir = myPath\nEnd Function\n' ---------------------------------------------------------------------------\n' doc\n' --------------------------------------------------------------------\nSub MultiDocReplace()\n    Application.ScreenUpdating = True\n    Dim fpath As String, myPath As String\n    myPath = getDir()\n    docFile = Dir(myPath & \"\\*.doc*\", vbDirectory)    \n    Do While docFile <> \"\"   ' \n        fpath = myPath & \"\\\" & docFile\n        Call docReplace(fpath, \"\", \"\")\n        docFile = Dir\n    Loop\n    Application.ScreenUpdating = True\nEnd Sub\n```\n\n## GTD\n### \n4\n### \n```vb\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\n' Sheet1\n'                                             \n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction connect()\n    Dim conn As Object, PathStr As String, strConn As String, strSQL As String\n    Set conn = CreateObject(\"ADODB.Connection\")\n    PathStr = ThisWorkbook.FullName   '\n    Select Case Application.Version * 1    ',\n    Case Is <= 11\n        strConn = \"Provider=Microsoft.Jet.Oledb.4.0;Extended Properties=excel 8.0;Data source=\" & PathStr\n    Case Is >= 12\n        strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" & PathStr & \";Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\"\"\n    End Select\n    conn.Open strConn\n    Set connect = conn\nEnd Function\n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction renewSheet(shtname)\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Set sht = Sheets(shtname)\n    If Not IsNull(sht) Then\n        sht.Delete\n    End If\n    Set sht = Sheets.Add()\n    sht.Name = shtname\n    Set renewSheet = sht\n    Application.DisplayAlerts = True\nEnd Function\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nSub divide(conn, targetShtName)\n    'On Error Resume Next\n    Dim firstrow As Integer, rst As Object\n    Dim title(5) As String, cindex(5) As Integer, mode As Integer, i As Integer\n    Dim SQL(5) As String, pre As String\n    pre = \"select ,,,,,,,, from [Sheet1$A1:M100] where  is  not null and  is null and \"\n    SQL(0) = pre + \" len() > 0 and len() >0\"\n    SQL(1) = pre + \" len() > 0  and  is null\"\n    SQL(2) = pre + \"  is null and len() > 0 \"\n    SQL(3) = pre + \"  is null and  is null \"\n    SQL(4) = \"select ,,,,,,,, from [Sheet1$A1:M100] where  is not null\"\n    \n    cindex(0) = 3\n    cindex(1) = 5\n    cindex(2) = 6\n    cindex(3) = 8\n    cindex(4) = 10\n    \n    title(0) = \"\"\n    title(1) = \"\"\n    title(2) = \"\"\n    title(3) = \"\"\n    title(4) = \"\"\n    \n    \n    Debug.Print targetShtName\n    Set rst = CreateObject(\"ADODB.Recordset\")\n    Set sht = Sheets(targetShtName)\n    firstrow = 1\n    \n    With sht\n        rst.CursorLocation = 3\n        For mode = 0 To 4 Step 1\n            rst.Open SQL(mode), conn, adOpenKeyset\n            \n            If rst.Fields.Count > 1 Then\n                Range(Cells(firstrow + 1, 1), Cells(firstrow + 1, rst.Fields.Count)).Merge\n                .Cells(firstrow + 1, 1).Value = title(mode)\n                .Cells(firstrow + 1, 1).RowHeight = 35\n                .Cells(firstrow + 1, 1).HorizontalAlignment = xlCenter    ' \n                .Cells(firstrow + 1, 1).Interior.ColorIndex = cindex(mode)\n                .Cells(2 + firstrow, i + 1).ColumnWidth = 10\n                For i = 0 To rst.Fields.Count - 1    '\n                    fdname = rst.Fields(i).Name\n                    .Cells(2 + firstrow, i + 1).ColumnWidth = getWidth(fdname)\n                    .Cells(2 + firstrow, i + 1).EntireRow.AutoFit\n                    .Cells(2 + firstrow, i + 1) = fdname\n                Next i\n            End If\n            \n            ' \n            Range(\"A\" & (firstrow + 3)).CopyFromRecordset rst\n            \n            firstrow = firstrow + rst.RecordCount + 4\n            \n            rst.Close\n        Next mode\n        ' .Cells.EntireColumn.AutoFit  '\n        .Cells.WrapText = True\n        \n        Set rst = Nothing\n    End With\nEnd Sub\n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction  getWidth(fdname)\n    dim wid as Integer\n    wid = 10\n    Select Case fdname\n        Case \"\"\n            wid = 20\n        Case \"\"\n            wid = 20\n        Case \"\"\n            wid = 30\n        Case \"\"\n            wid = 15\n        Case Else\n            wid = 10\n    End Select\n    getWidth = wid\nEnd Function\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nSub GTD()\n    Dim conn As Object, rst As Object\n    \n    Set conn = connect()\n    Set sht = renewSheet(\"4\")\n    Call divide(conn, \"4\")\n    conn.Close\n    Set conn = Nothing\n    \nEnd Sub\n```\n\n## \n### \n1\n### \n```vb\nSub MergeCellsWithSameValue()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    \n    Dim r As Integer\n    Dim c As Integer\n    \n    Sheets(\"Sheet1\").Activate\n    \n    \n    For r = Sheet1.UsedRange.Rows.Count To 1 Step -1\n        For c = Sheet1.UsedRange.Columns.Count To 1 Step -1\n            If Not IsEmpty(Cells(r, c)) Then\n                If Not IsNumeric(Left(Cells(r, c).Value, 1)) Then\n                    If r > 1 Then\n                        If Not IsEmpty(Cells(r - 1, c).Value) Then\n                            If Cells(r, c) = Cells(r - 1, c) Then\n                                Range(Cells(r, c), Cells(r - 1, c)).Merge\n                                GoTo NEXTLOOP\n                            End If\n                        End If\n                    End If\n                    If c > 1 Then\n                        If Not IsEmpty(Cells(r, c - 1).Value) Then\n                            If Cells(r, c) = Cells(r, c - 1) Then\n                                Range(Cells(r, c), Cells(r, c - 1)).Merge\n                                GoTo NEXTLOOP\n                            End If\n                        End If\n                    End If\n                End If\n            End If\nNEXTLOOP:\n        Next\n    Next\n    \n    Sheet1.UsedRange.EntireRow.AutoFit\n    Sheet1.UsedRange.EntireColumn.AutoFit\n    Sheet1.UsedRange.HorizontalAlignment = xlCenter\n    Sheet1.UsedRange.VerticalAlignment = xlCenter\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    \nEnd Sub\n```","source":"_posts/wordrep.md","raw":"---\ntitle: Office VBA\ndate: 2017-04-25 13:13:06\ntags: [word,vba]\ncategories: Develop\n---\n\n## Word\n### \ndoc\n\n<!--more-->\n### \n``` vb\n\n' -------------------------------------------------------------------------\n' doc\n' wishmo@tom.com\n' 2017425\n\nFunction docReplace(fullpath, searchStr, replaceStr)\n    Application.ScreenUpdating = False\n    Dim myDoc As Document\n    Set myDoc = Documents.Open(FileName:=(fullpath))\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = searchStr\n        .Replacement.Text = replaceStr\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchByte = True\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n    myDoc.Save\n    myDoc.Close\n    Set myDoc = Nothing\n    Application.ScreenUpdating = True\nEnd Function\n\n' ------------------------------------------------------------------------\nFunction getDir()\n    Dim myPath As String\n    ' \n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"\"\n        If .Show = -1 Then\n            myPath = .SelectedItems(1)\n        Else\n            Exit Function\n        End If\n    End With\n    getDir = myPath\nEnd Function\n' ---------------------------------------------------------------------------\n' doc\n' --------------------------------------------------------------------\nSub MultiDocReplace()\n    Application.ScreenUpdating = True\n    Dim fpath As String, myPath As String\n    myPath = getDir()\n    docFile = Dir(myPath & \"\\*.doc*\", vbDirectory)    \n    Do While docFile <> \"\"   ' \n        fpath = myPath & \"\\\" & docFile\n        Call docReplace(fpath, \"\", \"\")\n        docFile = Dir\n    Loop\n    Application.ScreenUpdating = True\nEnd Sub\n```\n\n## GTD\n### \n4\n### \n```vb\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\n' Sheet1\n'                                             \n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction connect()\n    Dim conn As Object, PathStr As String, strConn As String, strSQL As String\n    Set conn = CreateObject(\"ADODB.Connection\")\n    PathStr = ThisWorkbook.FullName   '\n    Select Case Application.Version * 1    ',\n    Case Is <= 11\n        strConn = \"Provider=Microsoft.Jet.Oledb.4.0;Extended Properties=excel 8.0;Data source=\" & PathStr\n    Case Is >= 12\n        strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" & PathStr & \";Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\"\"\n    End Select\n    conn.Open strConn\n    Set connect = conn\nEnd Function\n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction renewSheet(shtname)\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Set sht = Sheets(shtname)\n    If Not IsNull(sht) Then\n        sht.Delete\n    End If\n    Set sht = Sheets.Add()\n    sht.Name = shtname\n    Set renewSheet = sht\n    Application.DisplayAlerts = True\nEnd Function\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nSub divide(conn, targetShtName)\n    'On Error Resume Next\n    Dim firstrow As Integer, rst As Object\n    Dim title(5) As String, cindex(5) As Integer, mode As Integer, i As Integer\n    Dim SQL(5) As String, pre As String\n    pre = \"select ,,,,,,,, from [Sheet1$A1:M100] where  is  not null and  is null and \"\n    SQL(0) = pre + \" len() > 0 and len() >0\"\n    SQL(1) = pre + \" len() > 0  and  is null\"\n    SQL(2) = pre + \"  is null and len() > 0 \"\n    SQL(3) = pre + \"  is null and  is null \"\n    SQL(4) = \"select ,,,,,,,, from [Sheet1$A1:M100] where  is not null\"\n    \n    cindex(0) = 3\n    cindex(1) = 5\n    cindex(2) = 6\n    cindex(3) = 8\n    cindex(4) = 10\n    \n    title(0) = \"\"\n    title(1) = \"\"\n    title(2) = \"\"\n    title(3) = \"\"\n    title(4) = \"\"\n    \n    \n    Debug.Print targetShtName\n    Set rst = CreateObject(\"ADODB.Recordset\")\n    Set sht = Sheets(targetShtName)\n    firstrow = 1\n    \n    With sht\n        rst.CursorLocation = 3\n        For mode = 0 To 4 Step 1\n            rst.Open SQL(mode), conn, adOpenKeyset\n            \n            If rst.Fields.Count > 1 Then\n                Range(Cells(firstrow + 1, 1), Cells(firstrow + 1, rst.Fields.Count)).Merge\n                .Cells(firstrow + 1, 1).Value = title(mode)\n                .Cells(firstrow + 1, 1).RowHeight = 35\n                .Cells(firstrow + 1, 1).HorizontalAlignment = xlCenter    ' \n                .Cells(firstrow + 1, 1).Interior.ColorIndex = cindex(mode)\n                .Cells(2 + firstrow, i + 1).ColumnWidth = 10\n                For i = 0 To rst.Fields.Count - 1    '\n                    fdname = rst.Fields(i).Name\n                    .Cells(2 + firstrow, i + 1).ColumnWidth = getWidth(fdname)\n                    .Cells(2 + firstrow, i + 1).EntireRow.AutoFit\n                    .Cells(2 + firstrow, i + 1) = fdname\n                Next i\n            End If\n            \n            ' \n            Range(\"A\" & (firstrow + 3)).CopyFromRecordset rst\n            \n            firstrow = firstrow + rst.RecordCount + 4\n            \n            rst.Close\n        Next mode\n        ' .Cells.EntireColumn.AutoFit  '\n        .Cells.WrapText = True\n        \n        Set rst = Nothing\n    End With\nEnd Sub\n' --------------------------------------------------------------------------------\n' \n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nFunction  getWidth(fdname)\n    dim wid as Integer\n    wid = 10\n    Select Case fdname\n        Case \"\"\n            wid = 20\n        Case \"\"\n            wid = 20\n        Case \"\"\n            wid = 30\n        Case \"\"\n            wid = 15\n        Case Else\n            wid = 10\n    End Select\n    getWidth = wid\nEnd Function\n' --------------------------------------------------------------------------------\n' 4\n' wishmo@tom.com\n' 2017425\n' --------------------------------------------------------------------------------\nSub GTD()\n    Dim conn As Object, rst As Object\n    \n    Set conn = connect()\n    Set sht = renewSheet(\"4\")\n    Call divide(conn, \"4\")\n    conn.Close\n    Set conn = Nothing\n    \nEnd Sub\n```\n\n## \n### \n1\n### \n```vb\nSub MergeCellsWithSameValue()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    \n    Dim r As Integer\n    Dim c As Integer\n    \n    Sheets(\"Sheet1\").Activate\n    \n    \n    For r = Sheet1.UsedRange.Rows.Count To 1 Step -1\n        For c = Sheet1.UsedRange.Columns.Count To 1 Step -1\n            If Not IsEmpty(Cells(r, c)) Then\n                If Not IsNumeric(Left(Cells(r, c).Value, 1)) Then\n                    If r > 1 Then\n                        If Not IsEmpty(Cells(r - 1, c).Value) Then\n                            If Cells(r, c) = Cells(r - 1, c) Then\n                                Range(Cells(r, c), Cells(r - 1, c)).Merge\n                                GoTo NEXTLOOP\n                            End If\n                        End If\n                    End If\n                    If c > 1 Then\n                        If Not IsEmpty(Cells(r, c - 1).Value) Then\n                            If Cells(r, c) = Cells(r, c - 1) Then\n                                Range(Cells(r, c), Cells(r, c - 1)).Merge\n                                GoTo NEXTLOOP\n                            End If\n                        End If\n                    End If\n                End If\n            End If\nNEXTLOOP:\n        Next\n    Next\n    \n    Sheet1.UsedRange.EntireRow.AutoFit\n    Sheet1.UsedRange.EntireColumn.AutoFit\n    Sheet1.UsedRange.HorizontalAlignment = xlCenter\n    Sheet1.UsedRange.VerticalAlignment = xlCenter\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    \nEnd Sub\n```","slug":"wordrep","published":1,"updated":"2017-06-09T12:44:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cji58sttj000dzsr44zuxxlbo","content":"<h2 id=\"Word\"><a href=\"#Word\" class=\"headerlink\" title=\"Word\"></a>Word</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>doc</p>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">' -------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' doc</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Function</span> docReplace(fullpath, searchStr, replaceStr)</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> myDoc <span class=\"keyword\">As</span> Document</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> myDoc = Documents.Open(FileName:=(fullpath))</span><br><span class=\"line\">    Selection.Find.ClearFormatting</span><br><span class=\"line\">    Selection.Find.Replacement.ClearFormatting</span><br><span class=\"line\">    <span class=\"keyword\">With</span> Selection.Find</span><br><span class=\"line\">        .<span class=\"keyword\">Text</span> = searchStr</span><br><span class=\"line\">        .Replacement.<span class=\"keyword\">Text</span> = replaceStr</span><br><span class=\"line\">        .Forward = <span class=\"literal\">True</span></span><br><span class=\"line\">        .Wrap = wdFindAsk</span><br><span class=\"line\">        .Format = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchCase = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchWholeWord = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchByte = <span class=\"literal\">True</span></span><br><span class=\"line\">        .MatchWildcards = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchSoundsLike = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchAllWordForms = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\">    Selection.Find.Execute Replace:=wdReplaceAll</span><br><span class=\"line\">    myDoc.Save</span><br><span class=\"line\">    myDoc.Close</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> myDoc = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">' ------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> getDir()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> myPath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    <span class=\"comment\">' </span></span><br><span class=\"line\">    <span class=\"keyword\">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class=\"line\">        .Title = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">If</span> .Show = <span class=\"number\">-1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">            myPath = .SelectedItems(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">Else</span></span><br><span class=\"line\">            <span class=\"keyword\">Exit</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\">        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\">    getDir = myPath</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' ---------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' doc</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> MultiDocReplace()</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> fpath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, myPath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    myPath = getDir()</span><br><span class=\"line\">    docFile = Dir(myPath &amp; <span class=\"string\">\"\\*.doc*\"</span>, vbDirectory)    </span><br><span class=\"line\">    <span class=\"keyword\">Do</span> <span class=\"keyword\">While</span> docFile &lt;&gt; <span class=\"string\">\"\"</span>   <span class=\"comment\">' </span></span><br><span class=\"line\">        fpath = myPath &amp; <span class=\"string\">\"\\\"</span> &amp; docFile</span><br><span class=\"line\">        <span class=\"keyword\">Call</span> docReplace(fpath, <span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>)</span><br><span class=\"line\">        docFile = Dir</span><br><span class=\"line\">    <span class=\"keyword\">Loop</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"GTD\"><a href=\"#GTD\" class=\"headerlink\" title=\"GTD\"></a>GTD</h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>4</p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' Sheet1</span></span><br><span class=\"line\"><span class=\"comment\">'                                             </span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> connect()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> conn <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span>, PathStr <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, strConn <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, strSQL <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = CreateObject(<span class=\"string\">\"ADODB.Connection\"</span>)</span><br><span class=\"line\">    PathStr = ThisWorkbook.FullName   <span class=\"comment\">'</span></span><br><span class=\"line\">    <span class=\"keyword\">Select</span> <span class=\"keyword\">Case</span> Application.Version * <span class=\"number\">1</span>    <span class=\"comment\">',</span></span><br><span class=\"line\">    <span class=\"keyword\">Case</span> <span class=\"keyword\">Is</span> &lt;= <span class=\"number\">11</span></span><br><span class=\"line\">        strConn = <span class=\"string\">\"Provider=Microsoft.Jet.Oledb.4.0;Extended Properties=excel 8.0;Data source=\"</span> &amp; PathStr</span><br><span class=\"line\">    <span class=\"keyword\">Case</span> <span class=\"keyword\">Is</span> &gt;= <span class=\"number\">12</span></span><br><span class=\"line\">        strConn = <span class=\"string\">\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"</span> &amp; PathStr &amp; <span class=\"string\">\";Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">Select</span></span><br><span class=\"line\">    conn.Open strConn</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> connect = conn</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> renewSheet(shtname)</span><br><span class=\"line\">    <span class=\"keyword\">On</span> <span class=\"keyword\">Error</span> <span class=\"keyword\">Resume</span> <span class=\"keyword\">Next</span></span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets(shtname)</span><br><span class=\"line\">    <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsNull(sht) <span class=\"keyword\">Then</span></span><br><span class=\"line\">        sht.Delete</span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets.Add()</span><br><span class=\"line\">    sht.Name = shtname</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> renewSheet = sht</span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> divide(conn, targetShtName)</span><br><span class=\"line\">    <span class=\"comment\">'On Error Resume Next</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> firstrow <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, rst <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> title(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, cindex(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, mode <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, i <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> SQL(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, pre <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    pre = <span class=\"string\">\"select ,,,,,,,, from [Sheet1$A1:M100] where  is  not null and  is null and \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">0</span>) = pre + <span class=\"string\">\" len() &gt; 0 and len() &gt;0\"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">1</span>) = pre + <span class=\"string\">\" len() &gt; 0  and  is null\"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">2</span>) = pre + <span class=\"string\">\"  is null and len() &gt; 0 \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">3</span>) = pre + <span class=\"string\">\"  is null and  is null \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">4</span>) = <span class=\"string\">\"select ,,,,,,,, from [Sheet1$A1:M100] where  is not null\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    cindex(<span class=\"number\">0</span>) = <span class=\"number\">3</span></span><br><span class=\"line\">    cindex(<span class=\"number\">1</span>) = <span class=\"number\">5</span></span><br><span class=\"line\">    cindex(<span class=\"number\">2</span>) = <span class=\"number\">6</span></span><br><span class=\"line\">    cindex(<span class=\"number\">3</span>) = <span class=\"number\">8</span></span><br><span class=\"line\">    cindex(<span class=\"number\">4</span>) = <span class=\"number\">10</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    title(<span class=\"number\">0</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">1</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">2</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">3</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">4</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    Debug.Print targetShtName</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> rst = CreateObject(<span class=\"string\">\"ADODB.Recordset\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets(targetShtName)</span><br><span class=\"line\">    firstrow = <span class=\"number\">1</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">With</span> sht</span><br><span class=\"line\">        rst.CursorLocation = <span class=\"number\">3</span></span><br><span class=\"line\">        <span class=\"keyword\">For</span> mode = <span class=\"number\">0</span> <span class=\"keyword\">To</span> <span class=\"number\">4</span> <span class=\"keyword\">Step</span> <span class=\"number\">1</span></span><br><span class=\"line\">            rst.Open SQL(mode), conn, adOpenKeyset</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">If</span> rst.Fields.Count &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                Range(Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>), Cells(firstrow + <span class=\"number\">1</span>, rst.Fields.Count)).Merge</span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).Value = title(mode)</span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).RowHeight = <span class=\"number\">35</span></span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).HorizontalAlignment = xlCenter    <span class=\"comment\">' </span></span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).Interior.ColorIndex = cindex(mode)</span><br><span class=\"line\">                .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).ColumnWidth = <span class=\"number\">10</span></span><br><span class=\"line\">                <span class=\"keyword\">For</span> i = <span class=\"number\">0</span> <span class=\"keyword\">To</span> rst.Fields.Count - <span class=\"number\">1</span>    <span class=\"comment\">'</span></span><br><span class=\"line\">                    fdname = rst.Fields(i).Name</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).ColumnWidth = getWidth(fdname)</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).EntireRow.AutoFit</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>) = fdname</span><br><span class=\"line\">                <span class=\"keyword\">Next</span> i</span><br><span class=\"line\">            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">' </span></span><br><span class=\"line\">            Range(<span class=\"string\">\"A\"</span> &amp; (firstrow + <span class=\"number\">3</span>)).CopyFromRecordset rst</span><br><span class=\"line\">            </span><br><span class=\"line\">            firstrow = firstrow + rst.RecordCount + <span class=\"number\">4</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            rst.Close</span><br><span class=\"line\">        <span class=\"keyword\">Next</span> mode</span><br><span class=\"line\">        <span class=\"comment\">' .Cells.EntireColumn.AutoFit  '</span></span><br><span class=\"line\">        .Cells.WrapText = <span class=\"literal\">True</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">Set</span> rst = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span>  getWidth(fdname)</span><br><span class=\"line\">    <span class=\"keyword\">dim</span> wid <span class=\"keyword\">as</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    wid = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"keyword\">Select</span> <span class=\"keyword\">Case</span> fdname</span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">30</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">15</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"keyword\">Else</span></span><br><span class=\"line\">            wid = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">Select</span></span><br><span class=\"line\">    getWidth = wid</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> GTD()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> conn <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span>, rst <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = connect()</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = renewSheet(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">Call</span> divide(conn, <span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    conn.Close</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><p>1</p>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Sub</span> MergeCellsWithSameValue()</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">False</span></span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">False</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> r <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> c <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    Sheets(<span class=\"string\">\"Sheet1\"</span>).Activate</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">For</span> r = Sheet1.UsedRange.Rows.Count <span class=\"keyword\">To</span> <span class=\"number\">1</span> <span class=\"keyword\">Step</span> <span class=\"number\">-1</span></span><br><span class=\"line\">        <span class=\"keyword\">For</span> c = Sheet1.UsedRange.Columns.Count <span class=\"keyword\">To</span> <span class=\"number\">1</span> <span class=\"keyword\">Step</span> <span class=\"number\">-1</span></span><br><span class=\"line\">            <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r, c)) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsNumeric(Left(Cells(r, c).Value, <span class=\"number\">1</span>)) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                    <span class=\"keyword\">If</span> r &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                        <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r - <span class=\"number\">1</span>, c).Value) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                            <span class=\"keyword\">If</span> Cells(r, c) = Cells(r - <span class=\"number\">1</span>, c) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                                Range(Cells(r, c), Cells(r - <span class=\"number\">1</span>, c)).Merge</span><br><span class=\"line\">                                <span class=\"keyword\">GoTo</span> NEXTLOOP</span><br><span class=\"line\">                            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">If</span> c &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                        <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r, c - <span class=\"number\">1</span>).Value) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                            <span class=\"keyword\">If</span> Cells(r, c) = Cells(r, c - <span class=\"number\">1</span>) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                                Range(Cells(r, c), Cells(r, c - <span class=\"number\">1</span>)).Merge</span><br><span class=\"line\">                                <span class=\"keyword\">GoTo</span> NEXTLOOP</span><br><span class=\"line\">                            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">NEXTLOOP:</span><br><span class=\"line\">        <span class=\"keyword\">Next</span></span><br><span class=\"line\">    <span class=\"keyword\">Next</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    Sheet1.UsedRange.EntireRow.AutoFit</span><br><span class=\"line\">    Sheet1.UsedRange.EntireColumn.AutoFit</span><br><span class=\"line\">    Sheet1.UsedRange.HorizontalAlignment = xlCenter</span><br><span class=\"line\">    Sheet1.UsedRange.VerticalAlignment = xlCenter</span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">True</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h2 id=\"Word\"><a href=\"#Word\" class=\"headerlink\" title=\"Word\"></a>Word</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>doc</p>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">' -------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' doc</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Function</span> docReplace(fullpath, searchStr, replaceStr)</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> myDoc <span class=\"keyword\">As</span> Document</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> myDoc = Documents.Open(FileName:=(fullpath))</span><br><span class=\"line\">    Selection.Find.ClearFormatting</span><br><span class=\"line\">    Selection.Find.Replacement.ClearFormatting</span><br><span class=\"line\">    <span class=\"keyword\">With</span> Selection.Find</span><br><span class=\"line\">        .<span class=\"keyword\">Text</span> = searchStr</span><br><span class=\"line\">        .Replacement.<span class=\"keyword\">Text</span> = replaceStr</span><br><span class=\"line\">        .Forward = <span class=\"literal\">True</span></span><br><span class=\"line\">        .Wrap = wdFindAsk</span><br><span class=\"line\">        .Format = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchCase = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchWholeWord = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchByte = <span class=\"literal\">True</span></span><br><span class=\"line\">        .MatchWildcards = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchSoundsLike = <span class=\"literal\">False</span></span><br><span class=\"line\">        .MatchAllWordForms = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\">    Selection.Find.Execute Replace:=wdReplaceAll</span><br><span class=\"line\">    myDoc.Save</span><br><span class=\"line\">    myDoc.Close</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> myDoc = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">' ------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> getDir()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> myPath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    <span class=\"comment\">' </span></span><br><span class=\"line\">    <span class=\"keyword\">With</span> Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class=\"line\">        .Title = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">If</span> .Show = <span class=\"number\">-1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">            myPath = .SelectedItems(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">Else</span></span><br><span class=\"line\">            <span class=\"keyword\">Exit</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\">        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\">    getDir = myPath</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' ---------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' doc</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> MultiDocReplace()</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> fpath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, myPath <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    myPath = getDir()</span><br><span class=\"line\">    docFile = Dir(myPath &amp; <span class=\"string\">\"\\*.doc*\"</span>, vbDirectory)    </span><br><span class=\"line\">    <span class=\"keyword\">Do</span> <span class=\"keyword\">While</span> docFile &lt;&gt; <span class=\"string\">\"\"</span>   <span class=\"comment\">' </span></span><br><span class=\"line\">        fpath = myPath &amp; <span class=\"string\">\"\\\"</span> &amp; docFile</span><br><span class=\"line\">        <span class=\"keyword\">Call</span> docReplace(fpath, <span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>)</span><br><span class=\"line\">        docFile = Dir</span><br><span class=\"line\">    <span class=\"keyword\">Loop</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"GTD\"><a href=\"#GTD\" class=\"headerlink\" title=\"GTD\"></a>GTD</h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>4</p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' Sheet1</span></span><br><span class=\"line\"><span class=\"comment\">'                                             </span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> connect()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> conn <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span>, PathStr <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, strConn <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, strSQL <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = CreateObject(<span class=\"string\">\"ADODB.Connection\"</span>)</span><br><span class=\"line\">    PathStr = ThisWorkbook.FullName   <span class=\"comment\">'</span></span><br><span class=\"line\">    <span class=\"keyword\">Select</span> <span class=\"keyword\">Case</span> Application.Version * <span class=\"number\">1</span>    <span class=\"comment\">',</span></span><br><span class=\"line\">    <span class=\"keyword\">Case</span> <span class=\"keyword\">Is</span> &lt;= <span class=\"number\">11</span></span><br><span class=\"line\">        strConn = <span class=\"string\">\"Provider=Microsoft.Jet.Oledb.4.0;Extended Properties=excel 8.0;Data source=\"</span> &amp; PathStr</span><br><span class=\"line\">    <span class=\"keyword\">Case</span> <span class=\"keyword\">Is</span> &gt;= <span class=\"number\">12</span></span><br><span class=\"line\">        strConn = <span class=\"string\">\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"</span> &amp; PathStr &amp; <span class=\"string\">\";Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">Select</span></span><br><span class=\"line\">    conn.Open strConn</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> connect = conn</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span> renewSheet(shtname)</span><br><span class=\"line\">    <span class=\"keyword\">On</span> <span class=\"keyword\">Error</span> <span class=\"keyword\">Resume</span> <span class=\"keyword\">Next</span></span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets(shtname)</span><br><span class=\"line\">    <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsNull(sht) <span class=\"keyword\">Then</span></span><br><span class=\"line\">        sht.Delete</span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets.Add()</span><br><span class=\"line\">    sht.Name = shtname</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> renewSheet = sht</span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> divide(conn, targetShtName)</span><br><span class=\"line\">    <span class=\"comment\">'On Error Resume Next</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> firstrow <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, rst <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> title(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, cindex(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, mode <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span>, i <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> SQL(<span class=\"number\">5</span>) <span class=\"keyword\">As</span> <span class=\"built_in\">String</span>, pre <span class=\"keyword\">As</span> <span class=\"built_in\">String</span></span><br><span class=\"line\">    pre = <span class=\"string\">\"select ,,,,,,,, from [Sheet1$A1:M100] where  is  not null and  is null and \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">0</span>) = pre + <span class=\"string\">\" len() &gt; 0 and len() &gt;0\"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">1</span>) = pre + <span class=\"string\">\" len() &gt; 0  and  is null\"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">2</span>) = pre + <span class=\"string\">\"  is null and len() &gt; 0 \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">3</span>) = pre + <span class=\"string\">\"  is null and  is null \"</span></span><br><span class=\"line\">    SQL(<span class=\"number\">4</span>) = <span class=\"string\">\"select ,,,,,,,, from [Sheet1$A1:M100] where  is not null\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    cindex(<span class=\"number\">0</span>) = <span class=\"number\">3</span></span><br><span class=\"line\">    cindex(<span class=\"number\">1</span>) = <span class=\"number\">5</span></span><br><span class=\"line\">    cindex(<span class=\"number\">2</span>) = <span class=\"number\">6</span></span><br><span class=\"line\">    cindex(<span class=\"number\">3</span>) = <span class=\"number\">8</span></span><br><span class=\"line\">    cindex(<span class=\"number\">4</span>) = <span class=\"number\">10</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    title(<span class=\"number\">0</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">1</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">2</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">3</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    title(<span class=\"number\">4</span>) = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    Debug.Print targetShtName</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> rst = CreateObject(<span class=\"string\">\"ADODB.Recordset\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = Sheets(targetShtName)</span><br><span class=\"line\">    firstrow = <span class=\"number\">1</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">With</span> sht</span><br><span class=\"line\">        rst.CursorLocation = <span class=\"number\">3</span></span><br><span class=\"line\">        <span class=\"keyword\">For</span> mode = <span class=\"number\">0</span> <span class=\"keyword\">To</span> <span class=\"number\">4</span> <span class=\"keyword\">Step</span> <span class=\"number\">1</span></span><br><span class=\"line\">            rst.Open SQL(mode), conn, adOpenKeyset</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">If</span> rst.Fields.Count &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                Range(Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>), Cells(firstrow + <span class=\"number\">1</span>, rst.Fields.Count)).Merge</span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).Value = title(mode)</span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).RowHeight = <span class=\"number\">35</span></span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).HorizontalAlignment = xlCenter    <span class=\"comment\">' </span></span><br><span class=\"line\">                .Cells(firstrow + <span class=\"number\">1</span>, <span class=\"number\">1</span>).Interior.ColorIndex = cindex(mode)</span><br><span class=\"line\">                .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).ColumnWidth = <span class=\"number\">10</span></span><br><span class=\"line\">                <span class=\"keyword\">For</span> i = <span class=\"number\">0</span> <span class=\"keyword\">To</span> rst.Fields.Count - <span class=\"number\">1</span>    <span class=\"comment\">'</span></span><br><span class=\"line\">                    fdname = rst.Fields(i).Name</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).ColumnWidth = getWidth(fdname)</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>).EntireRow.AutoFit</span><br><span class=\"line\">                    .Cells(<span class=\"number\">2</span> + firstrow, i + <span class=\"number\">1</span>) = fdname</span><br><span class=\"line\">                <span class=\"keyword\">Next</span> i</span><br><span class=\"line\">            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">' </span></span><br><span class=\"line\">            Range(<span class=\"string\">\"A\"</span> &amp; (firstrow + <span class=\"number\">3</span>)).CopyFromRecordset rst</span><br><span class=\"line\">            </span><br><span class=\"line\">            firstrow = firstrow + rst.RecordCount + <span class=\"number\">4</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            rst.Close</span><br><span class=\"line\">        <span class=\"keyword\">Next</span> mode</span><br><span class=\"line\">        <span class=\"comment\">' .Cells.EntireColumn.AutoFit  '</span></span><br><span class=\"line\">        .Cells.WrapText = <span class=\"literal\">True</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">Set</span> rst = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' </span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Function</span>  getWidth(fdname)</span><br><span class=\"line\">    <span class=\"keyword\">dim</span> wid <span class=\"keyword\">as</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    wid = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"keyword\">Select</span> <span class=\"keyword\">Case</span> fdname</span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">30</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">            wid = <span class=\"number\">15</span></span><br><span class=\"line\">        <span class=\"keyword\">Case</span> <span class=\"keyword\">Else</span></span><br><span class=\"line\">            wid = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"keyword\">End</span> <span class=\"keyword\">Select</span></span><br><span class=\"line\">    getWidth = wid</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Function</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">' 4</span></span><br><span class=\"line\"><span class=\"comment\">' wishmo@tom.com</span></span><br><span class=\"line\"><span class=\"comment\">' 2017425</span></span><br><span class=\"line\"><span class=\"comment\">' --------------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"keyword\">Sub</span> GTD()</span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> conn <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span>, rst <span class=\"keyword\">As</span> <span class=\"built_in\">Object</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = connect()</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> sht = renewSheet(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">Call</span> divide(conn, <span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    conn.Close</span><br><span class=\"line\">    <span class=\"keyword\">Set</span> conn = <span class=\"literal\">Nothing</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><p>1</p>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Sub</span> MergeCellsWithSameValue()</span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">False</span></span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">False</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> r <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    <span class=\"keyword\">Dim</span> c <span class=\"keyword\">As</span> <span class=\"built_in\">Integer</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    Sheets(<span class=\"string\">\"Sheet1\"</span>).Activate</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">For</span> r = Sheet1.UsedRange.Rows.Count <span class=\"keyword\">To</span> <span class=\"number\">1</span> <span class=\"keyword\">Step</span> <span class=\"number\">-1</span></span><br><span class=\"line\">        <span class=\"keyword\">For</span> c = Sheet1.UsedRange.Columns.Count <span class=\"keyword\">To</span> <span class=\"number\">1</span> <span class=\"keyword\">Step</span> <span class=\"number\">-1</span></span><br><span class=\"line\">            <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r, c)) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsNumeric(Left(Cells(r, c).Value, <span class=\"number\">1</span>)) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                    <span class=\"keyword\">If</span> r &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                        <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r - <span class=\"number\">1</span>, c).Value) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                            <span class=\"keyword\">If</span> Cells(r, c) = Cells(r - <span class=\"number\">1</span>, c) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                                Range(Cells(r, c), Cells(r - <span class=\"number\">1</span>, c)).Merge</span><br><span class=\"line\">                                <span class=\"keyword\">GoTo</span> NEXTLOOP</span><br><span class=\"line\">                            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">If</span> c &gt; <span class=\"number\">1</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">                        <span class=\"keyword\">If</span> <span class=\"keyword\">Not</span> IsEmpty(Cells(r, c - <span class=\"number\">1</span>).Value) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                            <span class=\"keyword\">If</span> Cells(r, c) = Cells(r, c - <span class=\"number\">1</span>) <span class=\"keyword\">Then</span></span><br><span class=\"line\">                                Range(Cells(r, c), Cells(r, c - <span class=\"number\">1</span>)).Merge</span><br><span class=\"line\">                                <span class=\"keyword\">GoTo</span> NEXTLOOP</span><br><span class=\"line\">                            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                        <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                    <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">                <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">            <span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">NEXTLOOP:</span><br><span class=\"line\">        <span class=\"keyword\">Next</span></span><br><span class=\"line\">    <span class=\"keyword\">Next</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    Sheet1.UsedRange.EntireRow.AutoFit</span><br><span class=\"line\">    Sheet1.UsedRange.EntireColumn.AutoFit</span><br><span class=\"line\">    Sheet1.UsedRange.HorizontalAlignment = xlCenter</span><br><span class=\"line\">    Sheet1.UsedRange.VerticalAlignment = xlCenter</span><br><span class=\"line\">    Application.DisplayAlerts = <span class=\"literal\">True</span></span><br><span class=\"line\">    Application.ScreenUpdating = <span class=\"literal\">True</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">Sub</span></span><br></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[{"post_id":"cji58stt10001zsr4nxowwvbm","category_id":"cji58stt90005zsr4ucp6r0qk","_id":"cji58sttl000ezsr4g24h1sau"},{"post_id":"cji58sttj000dzsr44zuxxlbo","category_id":"cji58stti000bzsr42k2odlqh","_id":"cji58stto000izsr4vo0ja1mc"},{"post_id":"cji58stt60003zsr4akkzk1ug","category_id":"cji58stti000bzsr42k2odlqh","_id":"cji58sttp000mzsr40g06t4hh"},{"post_id":"cji58sttc0007zsr4yog34ag4","category_id":"cji58sttm000fzsr482gmp8wk","_id":"cji58sttq000nzsr4yygywc3g"},{"post_id":"cji58sttf0009zsr4ohaepc8h","category_id":"cji58sttp000kzsr4xfiq433i","_id":"cji58stts000szsr48dpuzeag"},{"post_id":"cji58sttg000azsr4sw1patt0","category_id":"cji58stti000bzsr42k2odlqh","_id":"cji58sttt000vzsr40h74b2uk"}],"PostTag":[{"post_id":"cji58stt10001zsr4nxowwvbm","tag_id":"cji58sttb0006zsr4kcnxr9lj","_id":"cji58stto000hzsr45660urv6"},{"post_id":"cji58stt10001zsr4nxowwvbm","tag_id":"cji58sttj000czsr412iqiqv8","_id":"cji58stto000jzsr4ktc07eb0"},{"post_id":"cji58stt60003zsr4akkzk1ug","tag_id":"cji58sttm000gzsr47vr33lhc","_id":"cji58stts000qzsr4xbikade3"},{"post_id":"cji58stt60003zsr4akkzk1ug","tag_id":"cji58sttp000lzsr4k51laa4f","_id":"cji58stts000rzsr44pg8grx1"},{"post_id":"cji58sttc0007zsr4yog34ag4","tag_id":"cji58sttq000pzsr42icib778","_id":"cji58sttt000uzsr4hiykyi1r"},{"post_id":"cji58sttf0009zsr4ohaepc8h","tag_id":"cji58stts000tzsr46fvn1edo","_id":"cji58sttu000zzsr41da7ylyp"},{"post_id":"cji58sttf0009zsr4ohaepc8h","tag_id":"cji58sttt000wzsr44a6lmo3a","_id":"cji58sttv0010zsr46j88axcl"},{"post_id":"cji58sttf0009zsr4ohaepc8h","tag_id":"cji58sttu000xzsr4utudas6o","_id":"cji58sttw0012zsr49txwju3j"},{"post_id":"cji58sttg000azsr4sw1patt0","tag_id":"cji58sttu000yzsr4mt7zrtge","_id":"cji58sttw0013zsr42d5112i5"},{"post_id":"cji58sttj000dzsr44zuxxlbo","tag_id":"cji58sttv0011zsr4hs3cn629","_id":"cji58sttx0015zsr4elgg064f"},{"post_id":"cji58sttj000dzsr44zuxxlbo","tag_id":"cji58sttw0014zsr4qgyrdm4c","_id":"cji58sttx0016zsr48lsjxg6i"}],"Tag":[{"name":"hexo","_id":"cji58sttb0006zsr4kcnxr9lj"},{"name":"","_id":"cji58sttj000czsr412iqiqv8"},{"name":"IDL","_id":"cji58sttm000gzsr47vr33lhc"},{"name":"Remote Sensing","_id":"cji58sttp000lzsr4k51laa4f"},{"name":"","_id":"cji58sttq000pzsr42icib778"},{"name":"","_id":"cji58stts000tzsr46fvn1edo"},{"name":"","_id":"cji58sttt000wzsr44a6lmo3a"},{"name":"","_id":"cji58sttu000xzsr4utudas6o"},{"name":"WebGIS","_id":"cji58sttu000yzsr4mt7zrtge"},{"name":"word","_id":"cji58sttv0011zsr4hs3cn629"},{"name":"vba","_id":"cji58sttw0014zsr4qgyrdm4c"}]}}